BEGIN HEADER
   CharacterSet "CP1252"
   ExportingTool "IBM InfoSphere DataStage Export"
   ToolVersion "8"
   ServerName "ONPDTSPRD:31538"
   ToolInstanceID "MAESTRO_EMPLEADOR_DESA"
   MDISVersion "1.0"
   Date "2025-07-07"
   Time "19.30.32"
   ServerVersion "11.5"
END HEADER
BEGIN DSJOB
   Identifier "J001_TRN_EMPL_AUX_SEDE_PRI_0001"
   DateModified "2025-04-29"
   TimeModified "16.24.33"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "CJobDefn"
      Readonly "0"
      Name "J001_TRN_EMPL_AUX_SEDE_PRI_0001"
      NextID "4"
      Container "V0"
      JobVersion "56.0.0"
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Prompt "PRM_ORA_CONE_MAE_EMPL parameters"
         Default "(As pre-defined)"
         HelpTxt "Parámetro que contiene parametros de conexion para NETI"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "IdentList"
         Value "ora_EQVSYS_TMP_EMPL_PADRUC_SEDE|ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "ClientCodePage"
         Value "1252"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceMode"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSeq"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceRecords"
         Value "100"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSkip"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TracePeriod"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RecordJobPerformanceData"
         Value "0"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      OrchestrateCode =+=+=+=
#################################################################
#### STAGE: ora_EQVSYS_TMP_EMPL_PADRUC_SEDE
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>1</Context><Variant type=\\'string\\'>11g</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type=\\'int\\'><![CDATA[0]]></ReadMode><GenerateSQL type=\\'bool\\'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement modified=\\'1\\' type=\\'string\\'><![CDATA[select 
  t4.ID_PERS
, t1.NUM_RUC
, NVL(ag.id_area_geog,0) ID_AREA_GEOG
, t1.COD_UBIGEO
, \\'\\' COD_UBIGEO_RENIEC --cod_ubigeo_reniec
, ag.DE_AREA_GEOG --de_area_geog
, NVL(tem_tz.ID_DEST_TIPZON,0) ID_TIPO_ZONA
, t1.COD_TIPZON
, UPPER(TRIM(t1.DES_NOMZON))  DES_NOMZON
, NVL(tem_tv.ID_DEST_TIPVIA,0) ID_TIPO_VIA
, t1.COD_TIPVIA
, UPPER(TRIM(t1.DES_NOMVIA)) DES_NOMVIA
, t1.NUM_DIRCON
, t1.NUM_MANDIR
, t1.NUM_LOTDIR
, t1.NUM_INTDIR
, t1.NUM_DEPDIR
, t1.NUM_KILDIR
, t1.DES_REFUBI
, \\'\\' DES_LICENC  --agregar esto a padruc
, t1.FEC_ACTREG_SUNA
-- SELECT t1.*
from EQVSYS.TMP_PADRUC t1   --37404  Filas  (indexar tmp_padruc)
inner join bdisys.rel_pers_docu t2 on t2.CO_DOCU = t1.NUM_RUC and t2.IN_ACTI = 1
inner join bdisys.cat_tipo_docu_iden t3 on t3.ID_TIPO_DOCU_IDEN = t2.ID_TIPO_DOCU 
                                        and t3.in_acti = 1 
                                        and t3.CO_TIPO_DOCU_IDEN = \\'DOCU_IDEN_RUC_11\\'
inner join bdisys.mae_pers t4 on t4.id_pers = t2.id_pers and t4.IN_ACTI = 1
inner join bdisys.mae_empl t5 on t5.id_empl = t4.id_pers and t5.IN_ACTI = 1   --37404  Filas  37394  Filas  37394  Filas
LEFT JOIN (
          select p2.DE_PARM DE_PARM_TIPVIA
        , p2.ID_ORIG ID_ORIG_TIPVIA
        , p2.CO_ORIG CO_ORIG_TIPVIA
        --, p2.ID_DEST ID_DEST_TIPVIA
        , p1.ID_TIPO_VIA ID_DEST_TIPVIA --ID_TIPO_VIA
        , p2.CO_DEST CO_DEST_TIPVIA
        from bdisys.cat_tipo_via P1 
        inner join eqvsys.tmp_eqv_parm P2 ON P1.CO_TIPO_VIA = P2.CO_DEST
                                       -- AND P1.IN_ACTI= 1
                                        AND P2.DE_TABL_ORIG = \\'P2025TIPVIA\\' 
                                        AND P2.DE_ESQU_ORIG = \\'STGNETISYS\\' 
                                        AND P2.DE_ESQU_DEST = \\'BDISYS\\') tem_tv ON tem_tv.CO_ORIG_TIPVIA = t1.COD_TIPVIA
LEFT JOIN ( select P4.DE_PARM DE_PARM_TIPZON
            , P4.ID_ORIG ID_ORIG_TIPZON
            , P4.CO_ORIG CO_ORIG_TIPZON
            , P3.ID_TIPO_ZONA ID_DEST_TIPZON --ID_TIPO_ZONA
            , P4.CO_DEST CO_DEST_TIPZON
            from bdisys.cat_tipo_zona P3 
            INNER JOIN eqvsys.tmp_eqv_parm P4 ON P3.CO_TIPO_ZONA = P4.CO_DEST
                                 -- AND P4.IN_ACTI= 1
                                AND P4.DE_TABL_ORIG = \\'P2029TIPZON\\' 
                                AND P4.DE_ESQU_ORIG = \\'STGNETISYS\\' 
                                AND P4.DE_ESQU_DEST = \\'BDISYS\\' ) tem_tz ON tem_tz.CO_ORIG_TIPZON = t1.COD_TIPZON
LEFT JOIN bdisys.aux_area_geog ag on ag.CO_AREA_GEOG_INEI = t1.COD_UBIGEO]]><ReadFromFileSelect type=\\'bool\\'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed=\\'1\\'></Tables><Parameters collapsed=\\'1\\'></Parameters><Columns collapsed=\\'1\\'></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount><EndOfWave type=\\'int\\'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><PrefetchRowCount type=\\'int\\'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type=\\'int\\'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type=\\'bool\\'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type=\\'bool\\'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]><BeforeSQL modified=\\'1\\' type=\\'string\\'><![CDATA[DECLARE
  C_CUENTA NUMBER :=  0;
BEGIN 
--------------------------------------------------------------------------------------------------------------
--1--CREAR LA TABLA TMP TMP_EMPL_AUX_SEDE_PRI1 CONTIENE DATA DE PADRUC PARA CONSTRUIR LAS SEDES PRINCIPALES --
--------------------------------------------------------------------------------------------------------------
SELECT NVL(COUNT(1),0) INTO C_CUENTA FROM ALL_TABLES 
WHERE OWNER = \\'EQVSYS\\' AND TABLE_NAME = \\'TMP_EMPL_AUX_SEDE_PRI1\\';
IF C_CUENTA > 0 THEN
    EXECUTE IMMEDIATE \\'DROP TABLE EQVSYS.TMP_EMPL_AUX_SEDE_PRI1 PURGE\\';
END IF;
EXECUTE IMMEDIATE  \\'CREATE TABLE EQVSYS.TMP_EMPL_AUX_SEDE_PRI1 
                  (   
                    id_pers             NUMBER(38,0) not null,
                    num_ruc           CHAR(11) not null,  
                    id_area_geog    NUMBER(38,0),
                    cod_ubigeo        VARCHAR2(6 BYTE),
                    cod_ubigeo_reniec VARCHAR2(6 BYTE),
                    de_area_geog      VARCHAR2(200 BYTE),
                    id_tipo_zona      NUMBER(38,0),
                    cod_tipzon        VARCHAR2(2 BYTE),
                    des_nomzon        VARCHAR2(200 BYTE), --des_zonest        
                    id_tipo_via       NUMBER(38,0),
                    cod_tipvia        VARCHAR2(2 BYTE),  
                    des_nomvia        VARCHAR2(200 BYTE),  --des_viaest
                    num_dircon        VARCHAR2(20 BYTE),   --num_direst
                    num_mandir        VARCHAR2(20 BYTE),   --num_manest
                    num_lotdir        VARCHAR2(20 BYTE),   --num_lotest
                    num_intdir        VARCHAR2(20 BYTE),   --num_intest
                    num_depdir        VARCHAR2(20 BYTE),   --num_depest
                    num_kildir        VARCHAR2(20 BYTE),   --num_kilest
                    des_refubi        VARCHAR2(200 BYTE),  --des_refest
                    des_numlic        VARCHAR2(20 BYTE),   --des_numlic
                    fec_actreg_suna   DATE            --fec_actreg 
                  )\\';

 END;
 
]]><ReadFromFileBeforeSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileBeforeSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LimitRows></Usage></Properties >'
-connector '{
   variant=\\'11g\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:"11g":ccora11g;12:"12c":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-source 0 '{
      DSSQLType={ID_PERS=2, NUM_RUC=1, ID_AREA_GEOG=2, COD_UBIGEO=12, COD_UBIGEO_RENIEC=12, DE_AREA_GEOG=12, ID_TIPO_ZONA=2, COD_TIPZON=12, DES_NOMZON=12, ID_TIPO_VIA=2, COD_TIPVIA=12, DES_NOMVIA=12, NUM_DIRCON=12, NUM_MANDIR=12, NUM_LOTDIR=12, NUM_INTDIR=12, NUM_DEPDIR=12, NUM_KILDIR=12, DES_REFUBI=12, DES_NUMLIC=12, FEC_ACTREG_SUNA=9}, 
      DSSQLPrecision={ID_PERS=38, NUM_RUC=11, ID_AREA_GEOG=38, COD_UBIGEO=6, COD_UBIGEO_RENIEC=6, DE_AREA_GEOG=200, ID_TIPO_ZONA=38, COD_TIPZON=2, DES_NOMZON=200, ID_TIPO_VIA=38, COD_TIPVIA=2, DES_NOMVIA=200, NUM_DIRCON=20, NUM_MANDIR=20, NUM_LOTDIR=20, NUM_INTDIR=20, NUM_DEPDIR=20, NUM_KILDIR=20, DES_REFUBI=200, DES_NUMLIC=20}, 
      DSSchema=\\'record
         (
           ID_PERS\\:nullable decimal\\[38\\,0\\]\\;
           NUM_RUC\\:nullable string\\[11\\]\\;
           ID_AREA_GEOG\\:decimal\\[38\\,0\\]\\;
           COD_UBIGEO\\:nullable string\\[max\\=6\\]\\;
           COD_UBIGEO_RENIEC\\:nullable string\\[max\\=6\\]\\;
           DE_AREA_GEOG\\:nullable string\\[max\\=200\\]\\;
           ID_TIPO_ZONA\\:nullable decimal\\[38\\,0\\]\\;
           COD_TIPZON\\:nullable string\\[max\\=2\\]\\;
           DES_NOMZON\\:nullable string\\[max\\=200\\]\\;
           ID_TIPO_VIA\\:nullable decimal\\[38\\,0\\]\\;
           COD_TIPVIA\\:nullable string\\[max\\=2\\]\\;
           DES_NOMVIA\\:nullable string\\[max\\=200\\]\\;
           NUM_DIRCON\\:nullable string\\[max\\=20\\]\\;
           NUM_MANDIR\\:nullable string\\[max\\=20\\]\\;
           NUM_LOTDIR\\:nullable string\\[max\\=20\\]\\;
           NUM_INTDIR\\:nullable string\\[max\\=20\\]\\;
           NUM_DEPDIR\\:nullable string\\[max\\=20\\]\\;
           NUM_KILDIR\\:nullable string\\[max\\=20\\]\\;
           DES_REFUBI\\:nullable string\\[max\\=200\\]\\;
           DES_NUMLIC\\:nullable string\\[max\\=20\\]\\;
           FEC_ACTREG_SUNA\\:nullable date\\;
         )\\'
}'
   

## General options
[ident('ora_EQVSYS_TMP_EMPL_PADRUC_SEDE'); jobmon_ident('ora_EQVSYS_TMP_EMPL_PADRUC_SEDE')]
## Outputs
0> [modify (
  ID_PERS:nullable decimal[38,0]=ID_PERS;
  NUM_RUC:nullable string[11]=NUM_RUC;
  ID_AREA_GEOG:not_nullable decimal[38,0]=ID_AREA_GEOG;
  COD_UBIGEO:nullable string[max=6]=COD_UBIGEO;
  COD_UBIGEO_RENIEC:nullable string[max=6]=COD_UBIGEO_RENIEC;
  DE_AREA_GEOG:nullable string[max=200]=DE_AREA_GEOG;
  ID_TIPO_ZONA:nullable decimal[38,0]=ID_TIPO_ZONA;
  COD_TIPZON:nullable string[max=2]=COD_TIPZON;
  DES_NOMZON:nullable string[max=200]=DES_NOMZON;
  ID_TIPO_VIA:nullable decimal[38,0]=ID_TIPO_VIA;
  COD_TIPVIA:nullable string[max=2]=COD_TIPVIA;
  DES_NOMVIA:nullable string[max=200]=DES_NOMVIA;
  NUM_DIRCON:nullable string[max=20]=NUM_DIRCON;
  NUM_MANDIR:nullable string[max=20]=NUM_MANDIR;
  NUM_LOTDIR:nullable string[max=20]=NUM_LOTDIR;
  NUM_INTDIR:nullable string[max=20]=NUM_INTDIR;
  NUM_DEPDIR:nullable string[max=20]=NUM_DEPDIR;
  NUM_KILDIR:nullable string[max=20]=NUM_KILDIR;
  DES_REFUBI:nullable string[max=200]=DES_REFUBI;
  DES_NUMLIC:nullable string[max=20]=DES_NUMLIC;
  FEC_ACTREG_SUNA:nullable date=FEC_ACTREG_SUNA;
keep
  ID_PERS,NUM_RUC,ID_AREA_GEOG,COD_UBIGEO,
  COD_UBIGEO_RENIEC,DE_AREA_GEOG,ID_TIPO_ZONA,COD_TIPZON,
  DES_NOMZON,ID_TIPO_VIA,COD_TIPVIA,DES_NOMVIA,
  NUM_DIRCON,NUM_MANDIR,NUM_LOTDIR,NUM_INTDIR,
  NUM_DEPDIR,NUM_KILDIR,DES_REFUBI,DES_NUMLIC,
  FEC_ACTREG_SUNA;
)] 'ora_EQVSYS_TMP_EMPL_PADRUC_SEDE:DSLink_padruc.v'
;

#################################################################
#### STAGE: ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_1
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>2</Context><Variant type=\\'string\\'>11</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><WriteMode type=\\'int\\'><![CDATA[0]]></WriteMode><GenerateSQL modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]></GenerateSQL><TableName modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_ES"].TMP_EMPL_AUX_SEDE_PRI1]]><TableScope type=\\'int\\'><![CDATA[0]]></TableScope></TableName><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL></SQL><TableAction modified=\\'1\\' type=\\'int\\'><![CDATA[3]]><GenerateTruncateStatement type=\\'bool\\'><![CDATA[1]]><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></GenerateTruncateStatement><TableActionFirst type=\\'bool\\'><![CDATA[1]]></TableActionFirst></TableAction><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><DropUnmatchedFields type=\\'bool\\'><![CDATA[0]]></DropUnmatchedFields><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><PreserveTrailingBlanks type=\\'bool\\'><![CDATA[1]]></PreserveTrailingBlanks><FailOnRowErrorPX type=\\'bool\\'><![CDATA[1]]></FailOnRowErrorPX></Session><Logging><LogColumnValues collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LogColumnValues></Logging><BeforeAfter collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><Reconnect collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></Reconnect><Disconnect collapsed=\\'1\\' type=\\'int\\'><![CDATA[0]]></Disconnect></Usage></Properties >'
-connector '{
   variant=\\'11\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:"11g":ccora11g;12:"12c":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-target 0 '{
      DSSQLType={ID_PERS=2, NUM_RUC=1, ID_AREA_GEOG=2, COD_UBIGEO=12, COD_UBIGEO_RENIEC=12, DE_AREA_GEOG=12, ID_TIPO_ZONA=2, COD_TIPZON=12, DES_NOMZON=12, ID_TIPO_VIA=2, COD_TIPVIA=12, DES_NOMVIA=12, NUM_DIRCON=12, NUM_MANDIR=12, NUM_LOTDIR=12, NUM_INTDIR=12, NUM_DEPDIR=12, NUM_KILDIR=12, DES_REFUBI=12, DES_NUMLIC=12, FEC_ACTREG_SUNA=9}, 
      DSSQLPrecision={ID_PERS=38, NUM_RUC=11, ID_AREA_GEOG=38, COD_UBIGEO=6, COD_UBIGEO_RENIEC=6, DE_AREA_GEOG=200, ID_TIPO_ZONA=38, COD_TIPZON=2, DES_NOMZON=200, ID_TIPO_VIA=38, COD_TIPVIA=2, DES_NOMVIA=200, NUM_DIRCON=20, NUM_MANDIR=20, NUM_LOTDIR=20, NUM_INTDIR=20, NUM_DEPDIR=20, NUM_KILDIR=20, DES_REFUBI=200, DES_NUMLIC=20}, 
      DSSchema=\\'record
         (
           ID_PERS\\:nullable decimal\\[38\\,0\\]\\;
           NUM_RUC\\:nullable string\\[11\\]\\;
           ID_AREA_GEOG\\:decimal\\[38\\,0\\]\\;
           COD_UBIGEO\\:nullable string\\[max\\=6\\]\\;
           COD_UBIGEO_RENIEC\\:nullable string\\[max\\=6\\]\\;
           DE_AREA_GEOG\\:nullable string\\[max\\=200\\]\\;
           ID_TIPO_ZONA\\:nullable decimal\\[38\\,0\\]\\;
           COD_TIPZON\\:nullable string\\[max\\=2\\]\\;
           DES_NOMZON\\:nullable string\\[max\\=200\\]\\;
           ID_TIPO_VIA\\:nullable decimal\\[38\\,0\\]\\;
           COD_TIPVIA\\:nullable string\\[max\\=2\\]\\;
           DES_NOMVIA\\:nullable string\\[max\\=200\\]\\;
           NUM_DIRCON\\:nullable string\\[max\\=20\\]\\;
           NUM_MANDIR\\:nullable string\\[max\\=20\\]\\;
           NUM_LOTDIR\\:nullable string\\[max\\=20\\]\\;
           NUM_INTDIR\\:nullable string\\[max\\=20\\]\\;
           NUM_DEPDIR\\:nullable string\\[max\\=20\\]\\;
           NUM_KILDIR\\:nullable string\\[max\\=20\\]\\;
           DES_REFUBI\\:nullable string\\[max\\=200\\]\\;
           DES_NUMLIC\\:nullable string\\[max\\=20\\]\\;
           FEC_ACTREG_SUNA\\:nullable date\\;
         )\\'
}'
   

## General options
[ident('ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_1'); jobmon_ident('ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_1')]
## Inputs
0< [] 'ora_EQVSYS_TMP_EMPL_PADRUC_SEDE:DSLink_padruc.v'
;


=+=+=+=
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "3"
      Category "\\Jobs\\FUENTES_EXTERNAS\\MIGRACION_NETI_EMPL\\AUXILIAR\\AUX_SEDE_PRINCIPAL"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V2S0|V3S0|V0A0"
      StageXPos "168|624|130"
      StageYPos "120|120|15"
      StageTypes "CCustomStage.CC_GUI|CCustomStage.CC_GUI|ID_PALETTEANNOTATION"
      NextStageID "2"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "100"
      StageXSize "48|48|557"
      StageYSize "48|48|77"
      ContainerViewSizing "0026 0026 0663 0320 0000 0001 0021 0091"
      StageNames "ora_EQVSYS_TMP_EMPL_PADRUC_SEDE|ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_1| "
      StageTypeIDs "OracleConnectorPX|OracleConnectorPX| "
      LinkNames "DSLink_padruc| | "
      LinkHasMetaDatas "True| | "
      LinkTypes "1| | "
      LinkNamePositionXs "370| | "
      LinkNamePositionYs "147| | "
      TargetStageIDs "V3S0| | "
      SourceStageEffectiveExecutionModes "2| | "
      SourceStageRuntimeExecutionModes "2| | "
      TargetStageEffectiveExecutionModes "2| | "
      TargetStageRuntimeExecutionModes "2| | "
      LinkIsSingleOperatorLookup "False| | "
      LinkIsSortSequential "False| | "
      LinkSortMode "0| | "
      LinkPartColMode "1| | "
      LinkSourcePinIDs "V2S0P1| | "
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0A0"
      OLEType "CAnnotation"
      Readonly "0"
      Name "V0A0"
      NextID "0"
      AnnotationType "0"
      AnnotationText =+=+=+=
OBTIENE LOS DATOS PARA MIGRAR SEDE.
Cruza tmp_padruc con empleador y catalogos de la BDI para obtener lod ID.
Para poder obtener los ID de catalogos hace el crusce con equivalencias.
Resultado es la tabla: eqvsys.TMP_EMPL_AUX_SEDE_PRI1
=+=+=+=
      TextFont "MS Shell Dlg\\10\\0\\0\\0\\400\\0"
      TextHorizontalJustification "1"
      TextVerticalJustification "1"
      TextColor "0"
      BackgroundColor "12713983"
      BackgroundTransparent "0"
      BorderVisible "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V2S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_EQVSYS_TMP_EMPL_PADRUC_SEDE"
      NextID "4"
      OutputPins "V2S0P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11g</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement modified='1' type='string'><![CDATA[select 
  t4.ID_PERS
, t1.NUM_RUC
, NVL(ag.id_area_geog,0) ID_AREA_GEOG
, t1.COD_UBIGEO
, '' COD_UBIGEO_RENIEC --cod_ubigeo_reniec
, ag.DE_AREA_GEOG --de_area_geog
, NVL(tem_tz.ID_DEST_TIPZON,0) ID_TIPO_ZONA
, t1.COD_TIPZON
, UPPER(TRIM(t1.DES_NOMZON))  DES_NOMZON
, NVL(tem_tv.ID_DEST_TIPVIA,0) ID_TIPO_VIA
, t1.COD_TIPVIA
, UPPER(TRIM(t1.DES_NOMVIA)) DES_NOMVIA
, t1.NUM_DIRCON
, t1.NUM_MANDIR
, t1.NUM_LOTDIR
, t1.NUM_INTDIR
, t1.NUM_DEPDIR
, t1.NUM_KILDIR
, t1.DES_REFUBI
, '' DES_LICENC  --agregar esto a padruc
, t1.FEC_ACTREG_SUNA
-- SELECT t1.*
from EQVSYS.TMP_PADRUC t1   --37404  Filas  (indexar tmp_padruc)
inner join bdisys.rel_pers_docu t2 on t2.CO_DOCU = t1.NUM_RUC and t2.IN_ACTI = 1
inner join bdisys.cat_tipo_docu_iden t3 on t3.ID_TIPO_DOCU_IDEN = t2.ID_TIPO_DOCU 
                                        and t3.in_acti = 1 
                                        and t3.CO_TIPO_DOCU_IDEN = 'DOCU_IDEN_RUC_11'
inner join bdisys.mae_pers t4 on t4.id_pers = t2.id_pers and t4.IN_ACTI = 1
inner join bdisys.mae_empl t5 on t5.id_empl = t4.id_pers and t5.IN_ACTI = 1   --37404  Filas  37394  Filas  37394  Filas
LEFT JOIN (
          select p2.DE_PARM DE_PARM_TIPVIA
        , p2.ID_ORIG ID_ORIG_TIPVIA
        , p2.CO_ORIG CO_ORIG_TIPVIA
        --, p2.ID_DEST ID_DEST_TIPVIA
        , p1.ID_TIPO_VIA ID_DEST_TIPVIA --ID_TIPO_VIA
        , p2.CO_DEST CO_DEST_TIPVIA
        from bdisys.cat_tipo_via P1 
        inner join eqvsys.tmp_eqv_parm P2 ON P1.CO_TIPO_VIA = P2.CO_DEST
                                       -- AND P1.IN_ACTI= 1
                                        AND P2.DE_TABL_ORIG = 'P2025TIPVIA' 
                                        AND P2.DE_ESQU_ORIG = 'STGNETISYS' 
                                        AND P2.DE_ESQU_DEST = 'BDISYS') tem_tv ON tem_tv.CO_ORIG_TIPVIA = t1.COD_TIPVIA
LEFT JOIN ( select P4.DE_PARM DE_PARM_TIPZON
            , P4.ID_ORIG ID_ORIG_TIPZON
            , P4.CO_ORIG CO_ORIG_TIPZON
            , P3.ID_TIPO_ZONA ID_DEST_TIPZON --ID_TIPO_ZONA
            , P4.CO_DEST CO_DEST_TIPZON
            from bdisys.cat_tipo_zona P3 
            INNER JOIN eqvsys.tmp_eqv_parm P4 ON P3.CO_TIPO_ZONA = P4.CO_DEST
                                 -- AND P4.IN_ACTI= 1
                                AND P4.DE_TABL_ORIG = 'P2029TIPZON' 
                                AND P4.DE_ESQU_ORIG = 'STGNETISYS' 
                                AND P4.DE_ESQU_DEST = 'BDISYS' ) tem_tz ON tem_tz.CO_ORIG_TIPZON = t1.COD_TIPZON
LEFT JOIN bdisys.aux_area_geog ag on ag.CO_AREA_GEOG_INEI = t1.COD_UBIGEO]]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified='1' type='bool'><![CDATA[1]]><BeforeSQL modified='1' type='string'><![CDATA[DECLARE
  C_CUENTA NUMBER :=  0;
BEGIN 
--------------------------------------------------------------------------------------------------------------
--1--CREAR LA TABLA TMP TMP_EMPL_AUX_SEDE_PRI1 CONTIENE DATA DE PADRUC PARA CONSTRUIR LAS SEDES PRINCIPALES --
--------------------------------------------------------------------------------------------------------------
SELECT NVL(COUNT(1),0) INTO C_CUENTA FROM ALL_TABLES 
WHERE OWNER = 'EQVSYS' AND TABLE_NAME = 'TMP_EMPL_AUX_SEDE_PRI1';
IF C_CUENTA > 0 THEN
    EXECUTE IMMEDIATE 'DROP TABLE EQVSYS.TMP_EMPL_AUX_SEDE_PRI1 PURGE';
END IF;
EXECUTE IMMEDIATE  'CREATE TABLE EQVSYS.TMP_EMPL_AUX_SEDE_PRI1 
                  (   
                    id_pers             NUMBER(38,0) not null,
                    num_ruc           CHAR(11) not null,  
                    id_area_geog    NUMBER(38,0),
                    cod_ubigeo        VARCHAR2(6 BYTE),
                    cod_ubigeo_reniec VARCHAR2(6 BYTE),
                    de_area_geog      VARCHAR2(200 BYTE),
                    id_tipo_zona      NUMBER(38,0),
                    cod_tipzon        VARCHAR2(2 BYTE),
                    des_nomzon        VARCHAR2(200 BYTE), --des_zonest        
                    id_tipo_via       NUMBER(38,0),
                    cod_tipvia        VARCHAR2(2 BYTE),  
                    des_nomvia        VARCHAR2(200 BYTE),  --des_viaest
                    num_dircon        VARCHAR2(20 BYTE),   --num_direst
                    num_mandir        VARCHAR2(20 BYTE),   --num_manest
                    num_lotdir        VARCHAR2(20 BYTE),   --num_lotest
                    num_intdir        VARCHAR2(20 BYTE),   --num_intest
                    num_depdir        VARCHAR2(20 BYTE),   --num_depest
                    num_kildir        VARCHAR2(20 BYTE),   --num_kilest
                    des_refubi        VARCHAR2(200 BYTE),  --des_refest
                    des_numlic        VARCHAR2(20 BYTE),   --des_numlic
                    fec_actreg_suna   DATE            --fec_actreg 
                  )';

 END;
 
]]><ReadFromFileBeforeSQL type='bool'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type='string'><![CDATA[]]><ReadFromFileAfterSQL type='bool'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type='string'><![CDATA[]]><ReadFromFileBeforeSQLNode type='bool'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type='string'><![CDATA[]]><ReadFromFileAfterSQLNode type='bool'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V2S0P1"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "DSLink_padruc"
      Partner "V3S0|V3S0P2"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "ID_PERS"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NUM_RUC"
         SqlType "1"
         Precision "11"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_AREA_GEOG"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "0"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "COD_UBIGEO"
         SqlType "12"
         Precision "6"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "COD_UBIGEO_RENIEC"
         SqlType "12"
         Precision "6"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DE_AREA_GEOG"
         SqlType "12"
         Precision "200"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_TIPO_ZONA"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "COD_TIPZON"
         SqlType "12"
         Precision "2"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DES_NOMZON"
         SqlType "12"
         Precision "200"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_TIPO_VIA"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "COD_TIPVIA"
         SqlType "12"
         Precision "2"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DES_NOMVIA"
         SqlType "12"
         Precision "200"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NUM_DIRCON"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NUM_MANDIR"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NUM_LOTDIR"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NUM_INTDIR"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NUM_DEPDIR"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NUM_KILDIR"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DES_REFUBI"
         SqlType "12"
         Precision "200"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DES_NUMLIC"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "FEC_ACTREG_SUNA"
         SqlType "9"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      LeftTextPos "370"
      TopTextPos "147"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V3S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_1"
      NextID "3"
      InputPins "V3S0P2"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "target"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value "<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>2</Context><Variant type='string'>11</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><WriteMode type='int'><![CDATA[0]]></WriteMode><GenerateSQL modified='1' type='bool'><![CDATA[1]]></GenerateSQL><TableName modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_ES#.TMP_EMPL_AUX_SEDE_PRI1]]><TableScope type='int'><![CDATA[0]]></TableScope></TableName><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL></SQL><TableAction modified='1' type='int'><![CDATA[3]]><GenerateTruncateStatement type='bool'><![CDATA[1]]><FailOnError type='bool'><![CDATA[1]]></FailOnError></GenerateTruncateStatement><TableActionFirst type='bool'><![CDATA[1]]></TableActionFirst></TableAction><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><DropUnmatchedFields type='bool'><![CDATA[0]]></DropUnmatchedFields><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><PreserveTrailingBlanks type='bool'><![CDATA[1]]></PreserveTrailingBlanks><FailOnRowErrorPX type='bool'><![CDATA[1]]></FailOnRowErrorPX></Session><Logging><LogColumnValues collapsed='1' type='bool'><![CDATA[0]]></LogColumnValues></Logging><BeforeAfter collapsed='1' type='bool'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><Reconnect collapsed='1' type='bool'><![CDATA[0]]></Reconnect><Disconnect collapsed='1' type='int'><![CDATA[0]]></Disconnect></Usage></Properties >"
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V3S0P2"
      OLEType "CCustomInput"
      Readonly "0"
      Name "DSLink_padruc"
      Partner "V2S0|V2S0P1"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
END DSJOB
BEGIN DSJOB
   Identifier "J002_INS_EMPL_AUX_SEDE_PRI_0001"
   DateModified "2025-04-29"
   TimeModified "16.24.37"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "CJobDefn"
      Readonly "0"
      Name "J002_INS_EMPL_AUX_SEDE_PRI_0001"
      NextID "2"
      Container "V0"
      JobVersion "56.0.0"
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Prompt "PRM_ORA_CONE_MAE_EMPL parameters"
         Default "(As pre-defined)"
         HelpTxt "Parámetro que contiene parametros de conexion para NETI"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceMode"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSeq"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceRecords"
         Value "100"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSkip"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TracePeriod"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RecordJobPerformanceData"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "IdentList"
         Value "Peek_1|ora_BDISYS_INS_AUX_SEDE_PRI"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "ClientCodePage"
         Value "1252"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      OrchestrateCode =+=+=+=
#################################################################
#### STAGE: Peek_1
## Operator
peek
## Operator options
-nrecs 10
-name

## General options
[ident('Peek_1'); jobmon_ident('Peek_1')]
## Inputs
0< [] 'ora_BDISYS_INS_AUX_SEDE_PRI:lnk_ora_bdisys_aux_sede.v'
;

#################################################################
#### STAGE: ora_BDISYS_INS_AUX_SEDE_PRI
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>1</Context><Variant type=\\'string\\'>11</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD\"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US\"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW\"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type=\\'int\\'><![CDATA[0]]></ReadMode><GenerateSQL modified=\\'1\\' type=\\'bool\\'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed=\\'1\\' modified=\\'1\\' type=\\'string\\'><![CDATA[select 1 from dual]]><ReadFromFileSelect type=\\'bool\\'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed=\\'1\\'><Table type=\\'string\\'><![CDATA[dual]]></Table></Tables><Parameters collapsed=\\'1\\'></Parameters><Columns collapsed=\\'1\\'><Column type=\\'string\\'><![CDATA[defaulted_alias1,(null),dual]]></Column></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount><EndOfWave type=\\'int\\'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><PrefetchRowCount type=\\'int\\'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type=\\'int\\'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type=\\'bool\\'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type=\\'bool\\'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]><BeforeSQL modified=\\'1\\' type=\\'string\\'><![CDATA[--J002_INS_EMPL_AUX_SEDE_PRI_0001
DECLARE
    -- Definición de variables
    v_id_sede BDISYS.AUX_SEDE.ID_SEDE%TYPE; 
    v_id_pers_stg bdisys.AUX_SEDE.ID_EMPL%TYPE;
    v_num_ruc EQVSYS.TMP_EMPL_AUX_SEDE_PRI1.num_ruc%TYPE;
    v_id_aux_log_erro_aler NUMBER;
    PROJ_KEY_MAX     NUMBER := 0;
    PROJ_KEY_CURRVAL NUMBER := 0;
    PROJ_KEY_MAX_SEQ NUMBER := 0;
    C_ID_USUA_CREA  bdisys.aux_sede.id_usua_crea%TYPE := \\'INI-2842\\';
    C_DE_TERM_CREA  bdisys.aux_sede.de_term_crea%TYPE := \\'1.1.1.1\\';
    v_id_crg         NUMBER(38,0);
    v_id_det         NUMBER(38,0);
    v_de_proc        VARCHAR2(300) := \\'Carga Sedes Principales.\\';
    v_de_evto        VARCHAR2(300); 
    v_ca_totl_match   INT := 0; 
    v_ca_totl_nomatch INT := 0;
    v_ca_totl_migr    INT := 0;
    v_un_totl_actu    INT := 0;
    v_un_totl_ingr    INT := 0;
    v_un_totl_elim    INT := 0;
    v_un_totl_obse    INT := 0;
    v_un_totl_ning    INT := 0;
    v_in_tipo_detalle   CHAR(1) := \\'1\\'; -- Estado de proceso del detalle de carga 0: Terminado con incidencias 1: Terminado exitoso 2: Pendiente 3: En proceso
    v_in_esta_proc_deta CHAR(1) := \\'1\\'; -- Indicador de tipo de detalle. 1: incremental/rango/o inicial. 2: reproceso inmediato.
    v_st_veri           CHAR(1) := \\'1\\'; -- Estado de verificación del detalle de carga (0: sin verificar, 1: verificado, 2: pendiente).
    v_tab_ori           VARCHAR2(30);
    v_tab_des           VARCHAR2(30);
    v_tot_tab_des       INT := 0;
    v_tot_tab_ori       INT := 0;
    v_tot_incr          INT;
    v_fe_min            DATE; 
    v_fe_max            DATE;
    v_return            CHAR(1);
    v_ca_totl_tabl_inte INT :=0;
    v_ca_totl_tbdi_inte INT :=0;
    v_ca_totl_no_migr   INT :=0; 
    v_ca_totl_repr      INT :=0; 
    v_de_obs            VARCHAR2(500) := \\'Sin Observaciones\\';
    v_cant_ejec         NUMBER(38,0);
    v_retorno           CHAR(1) := \\'1\\';
    v_id_deta_carg_regi NUMBER;
    v_resul             VARCHAR2(500);
    -- Cursor 3
    CURSOR cursor_3 IS
        select 
        t1.ID_PERS, t1.num_ruc         
        from eqvsys.TMP_EMPL_AUX_SEDE_PRI1 t1    
        where not exists (select t2.id_empl from bdisys.aux_sede t2 where t1.id_pers = id_empl and t2.CO_SEDE_SUNA = \\'P\\');
BEGIN        
    -- Sincronización y obtención de la secuencia para ID_SEDE AL INICIO
    SELECT BDISYS.SQ_AUX_SEDE_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_SEDE), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_SEDE;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_AUX_SEDE_1 INCREMENT BY \\' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_SEDE_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_AUX_SEDE_1 INCREMENT BY 1\\';
    --Control de Carga
    --1. Setear tabla origen y destino.
    v_tab_ori := \\'T3726PADRUC\\';
    v_tab_des := \\'AUX_SEDE\\';
    --2. Obtener el id de control de carga
    SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA
      INTO v_id_crg, v_id_det
    FROM (
        SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_CNFG_PROC_CARG,
               ROW_NUMBER() OVER (ORDER BY ID_CTRL_PROC_CARG_DETA DESC) AS rn
        FROM EQVSYS.TMP_AUX_CTRL_PROC_CARG_DETA
        WHERE ID_CNFG_PROC_CARG =
              (SELECT ID_CNFG_PROC_CARG
                 FROM REPBDISYS.AUX_CONF_PROC_CARG@DBL_BDQA19G7_REPBDISYS
                WHERE ID_TABLA_ORIGEN =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_ori
                          AND IN_ACTI = \\'1\\')
                  AND ID_TABLA_DESTINO =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_des
                          AND IN_ACTI = \\'1\\'))
    )
    WHERE rn = 1;    
    --3. Actualizar el estado de detalle de control de carga en estado 3 (en proceso)
    UPDATE REPBDISYS.AUX_CTRL_PROC_CARG_DETA@DBL_BDQA19G7_REPBDISYS
       SET IN_ESTA_PROC_DETA = \\'3\\',
           ID_USUA_MODI = C_ID_USUA_CREA,
           FE_USUA_MODI = SYSDATE,
           DE_TERM_MODI = C_DE_TERM_CREA
     WHERE ID_CTRL_PROC_CARG_DETA = v_id_det;    
    --4. Total Incremental
    SELECT COUNT(1) INTO v_tot_incr FROM EQVSYS.TMP_PADRUC; 
    --5. Total de tabla destino.
    SELECT COUNT(1) INTO v_tot_tab_des FROM BDISYS.AUX_SEDE WHERE IN_ACTI=\\'1\\'; 
    --6. Total tabla origen
    SELECT COUNT(1) INTO v_tot_tab_ori FROM STGNETISYS.T3726PADRUC@DBL_BDQA11G2_STGNETISYS;
    --7. Registrar en eventos el inicio del proceso
    v_de_evto := \\'Inicia carga Sedes Principales\\'; 
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA); 
    COMMIT;             
    --8. Obtenemos cantidad total de registros en la tabla intermedia de trabajo.
    SELECT COUNT(1) INTO v_ca_totl_tabl_inte FROM EQVSYS.TMP_PADRUC_3;
    --9. Obtenemos cantidad total de empleadores con RUC 11 en la tabla intermedia de BDI.
    v_ca_totl_tbdi_inte := 0;   
    --10. Obtener contador de registros que se actualizaron.
    v_un_totl_actu := 0;  
    -- Procesar Cursor 3    
    OPEN cursor_3;
    LOOP
        FETCH cursor_3 INTO v_id_pers_stg, v_num_ruc;
        EXIT WHEN cursor_3%NOTFOUND;
        
        SELECT BDISYS.SQ_AUX_SEDE_1.NEXTVAL INTO v_id_sede FROM DUAL;
        -- Insertar registros en AUX_SEDE y REL_SEDE_DIRE_ADIC utilizando las variables
        BEGIN

            INSERT INTO bdisys.aux_sede (id_empl, id_sede, co_sede_suna, id_tipo_estb, in_acti, id_usua_crea, fe_usua_crea, de_term_crea)
            VALUES (v_id_pers_stg, v_id_sede, \\'P\\', 7, \\'1\\', \\'INI-2842\\', SYSDATE, \\'1.1.1.1\\');

            DBMS_OUTPUT.PUT_LINE(\\'v_id_sede: \\' || v_id_sede);
            --Registrar las sedes principales para el control de carga
            REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_DETA_CARG_POR_REGI@DBL_BDQA19G7_REPBDISYS(v_id_det, \\'Id Pers: \\'||v_id_pers_stg, \\'RUC: \\'||v_num_ruc, \\'INS\\',C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_deta_carg_regi, v_resul); 
            --11. Obtener contador de registros que se insertaron.
            v_un_totl_ingr := v_un_totl_ingr + 1;
        EXCEPTION
            WHEN OTHERS THEN
                DBMS_OUTPUT.PUT_LINE(\\'Error: \\' || SQLERRM);
                --12. Contador de registros que se observaron.
                v_un_totl_obse := v_un_totl_obse + 1;
                v_de_obs := \\'Error: \\' || SQLERRM;
                REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_LOG_ERRO_ALER@DBL_BDQA19G7_REPBDISYS(v_id_det,  \\'Id Pers: \\'||v_id_pers_stg, \\'RUC: \\'||v_num_ruc, v_de_obs, C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_aux_log_erro_aler, v_resul);
        END;
    END LOOP;
    CLOSE cursor_3;
    --13. Obtener contador de registros que se eliminaron.
    v_un_totl_elim := 0;
    --14. Contador de registros que no se aplicó ninguna acción.
    v_un_totl_ning := 0;
    --15. Calcular la cantidad migrados
    v_ca_totl_migr := v_un_totl_actu + v_un_totl_ingr + v_un_totl_elim + v_un_totl_obse;  
    --16. Obtengo el total de match
    v_ca_totl_match   := v_un_totl_actu;
    --17. Obtengo el total de no match
    v_ca_totl_nomatch := v_un_totl_ingr;
    --18. Actualizar los totales en el detalle de control de carga.
    IF v_un_totl_obse > 0 THEN 
      v_de_obs := \\'Con Observaciones\\'; 
      v_in_esta_proc_deta := \\'0\\';
      -- Estado de proceso del detalle de carga 
      --0: Terminado con incidencias 
      --1: Terminado exitoso 
      --2: Pendiente 
      --3: En proceso
    END IF;    
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_ACT_PRC_CRG_DETA@DBL_BDQA19G7_REPBDISYS(v_id_crg,v_tab_ori,v_tab_des,v_ca_totl_migr,v_un_totl_actu,v_un_totl_ingr,v_un_totl_elim,v_un_totl_obse, v_un_totl_ning, v_in_esta_proc_deta,v_st_veri,v_ca_totl_no_migr,v_ca_totl_repr,v_in_tipo_detalle,v_ca_totl_tabl_inte,v_ca_totl_tbdi_inte,v_ca_totl_match,v_ca_totl_nomatch,v_de_obs,C_ID_USUA_CREA,C_DE_TERM_CREA,v_cant_ejec, v_retorno); 
    --20. Detalle finalizado
    v_de_evto := \\'Finaliza carga Sedes Principales.\\'; 
    v_de_evto :=  v_de_evto || \\': \\' || v_cant_ejec;
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA);      
    COMMIT;
    -- Sincronización y obtención de la secuencia para ID_SEDE AL FINAL
    SELECT BDISYS.SQ_AUX_SEDE_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_SEDE), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_SEDE;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_AUX_SEDE_1 INCREMENT BY \\' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_SEDE_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_AUX_SEDE_1 INCREMENT BY 1\\';
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE(\\'Error: \\' || SQLERRM);
        ROLLBACK;
END;]]><ReadFromFileBeforeSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileBeforeSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LimitRows></Usage></Properties >'
-connector '{
   variant=\\'11\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-source 0 '{
      DSSQLType={IN_PARM=4}, 
      DSSchema=\\'record
         (
           IN_PARM\\:int32\\;
         )\\'
}'
   

## General options
[ident('ora_BDISYS_INS_AUX_SEDE_PRI'); jobmon_ident('ora_BDISYS_INS_AUX_SEDE_PRI')]
## Outputs
0> [modify (
  IN_PARM:not_nullable int32=IN_PARM;
keep
  IN_PARM;
)] 'ora_BDISYS_INS_AUX_SEDE_PRI:lnk_ora_bdisys_aux_sede.v'
;


=+=+=+=
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "3"
      Category "\\Jobs\\FUENTES_EXTERNAS\\MIGRACION_NETI_EMPL\\AUXILIAR\\AUX_SEDE_PRINCIPAL"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V1S0|V1S1|V0A0"
      StageXPos "504|120|62"
      StageYPos "96|96|6"
      StageTypes "CCustomStage|CCustomStage.CC_GUI|ID_PALETTEANNOTATION"
      NextStageID "1"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "100"
      StageXSize "48|48|548"
      StageYSize "48|48|72"
      ContainerViewSizing "0052 0052 0753 0342 0000 0001 0000 0000"
      StageNames "Peek_1|ora_BDISYS_INS_AUX_SEDE_PRI| "
      StageTypeIDs "PxPeek|OracleConnectorPX| "
      LinkNames " |lnk_ora_bdisys_aux_sede| "
      LinkHasMetaDatas " |True| "
      LinkTypes " |1| "
      LinkNamePositionXs " |292| "
      LinkNamePositionYs " |121| "
      TargetStageIDs " |V1S0| "
      SourceStageEffectiveExecutionModes " |2| "
      SourceStageRuntimeExecutionModes " |2| "
      TargetStageEffectiveExecutionModes " |2| "
      TargetStageRuntimeExecutionModes " |2| "
      LinkIsSingleOperatorLookup " |False| "
      LinkIsSortSequential " |False| "
      LinkSortMode " |0| "
      LinkPartColMode " |1| "
      LinkSourcePinIDs " |V1S1P1| "
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0A0"
      OLEType "CAnnotation"
      Readonly "0"
      Name "V0A0"
      NextID "0"
      AnnotationType "0"
      AnnotationText =+=+=+=
INSERTA LAS SEDES PRINCIPALES DE AQUELLOS EMPLEADORES QUE NO TIENEN UNA.
Basados en el cruce de la tabla: eqvsys.TMP_EMPL_AUX_SEDE_PRI1 con SEDE en BDI

=+=+=+=
      TextFont "MS Shell Dlg\\10\\0\\0\\0\\400\\0"
      TextHorizontalJustification "1"
      TextVerticalJustification "1"
      TextColor "0"
      BackgroundColor "12713983"
      BackgroundTransparent "0"
      BorderVisible "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V1S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "Peek_1"
      NextID "2"
      InputPins "V1S0P1"
      StageType "PxPeek"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "all"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "nrecs"
         Value "10"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "dataset"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "name"
         Value "name"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "columns"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "selection"
         Value " "
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V1S0P1"
      OLEType "CCustomInput"
      Readonly "0"
      Name "lnk_ora_bdisys_aux_sede"
      Partner "V1S1|V1S1P1"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V1S1"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_BDISYS_INS_AUX_SEDE_PRI"
      NextID "2"
      OutputPins "V1S1P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL modified='1' type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed='1' modified='1' type='string'><![CDATA[select 1 from dual]]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'><Table type='string'><![CDATA[dual]]></Table></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'><Column type='string'><![CDATA[defaulted_alias1,(null),dual]]></Column></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified='1' type='bool'><![CDATA[1]]><BeforeSQL modified='1' type='string'><![CDATA[--J002_INS_EMPL_AUX_SEDE_PRI_0001
DECLARE
    -- Definición de variables
    v_id_sede BDISYS.AUX_SEDE.ID_SEDE%TYPE; 
    v_id_pers_stg bdisys.AUX_SEDE.ID_EMPL%TYPE;
    v_num_ruc EQVSYS.TMP_EMPL_AUX_SEDE_PRI1.num_ruc%TYPE;
    v_id_aux_log_erro_aler NUMBER;
    PROJ_KEY_MAX     NUMBER := 0;
    PROJ_KEY_CURRVAL NUMBER := 0;
    PROJ_KEY_MAX_SEQ NUMBER := 0;
    C_ID_USUA_CREA  bdisys.aux_sede.id_usua_crea%TYPE := 'INI-2842';
    C_DE_TERM_CREA  bdisys.aux_sede.de_term_crea%TYPE := '1.1.1.1';
    v_id_crg         NUMBER(38,0);
    v_id_det         NUMBER(38,0);
    v_de_proc        VARCHAR2(300) := 'Carga Sedes Principales.';
    v_de_evto        VARCHAR2(300); 
    v_ca_totl_match   INT := 0; 
    v_ca_totl_nomatch INT := 0;
    v_ca_totl_migr    INT := 0;
    v_un_totl_actu    INT := 0;
    v_un_totl_ingr    INT := 0;
    v_un_totl_elim    INT := 0;
    v_un_totl_obse    INT := 0;
    v_un_totl_ning    INT := 0;
    v_in_tipo_detalle   CHAR(1) := '1'; -- Estado de proceso del detalle de carga 0: Terminado con incidencias 1: Terminado exitoso 2: Pendiente 3: En proceso
    v_in_esta_proc_deta CHAR(1) := '1'; -- Indicador de tipo de detalle. 1: incremental/rango/o inicial. 2: reproceso inmediato.
    v_st_veri           CHAR(1) := '1'; -- Estado de verificación del detalle de carga (0: sin verificar, 1: verificado, 2: pendiente).
    v_tab_ori           VARCHAR2(30);
    v_tab_des           VARCHAR2(30);
    v_tot_tab_des       INT := 0;
    v_tot_tab_ori       INT := 0;
    v_tot_incr          INT;
    v_fe_min            DATE; 
    v_fe_max            DATE;
    v_return            CHAR(1);
    v_ca_totl_tabl_inte INT :=0;
    v_ca_totl_tbdi_inte INT :=0;
    v_ca_totl_no_migr   INT :=0; 
    v_ca_totl_repr      INT :=0; 
    v_de_obs            VARCHAR2(500) := 'Sin Observaciones';
    v_cant_ejec         NUMBER(38,0);
    v_retorno           CHAR(1) := '1';
    v_id_deta_carg_regi NUMBER;
    v_resul             VARCHAR2(500);
    -- Cursor 3
    CURSOR cursor_3 IS
        select 
        t1.ID_PERS, t1.num_ruc         
        from eqvsys.TMP_EMPL_AUX_SEDE_PRI1 t1    
        where not exists (select t2.id_empl from bdisys.aux_sede t2 where t1.id_pers = id_empl and t2.CO_SEDE_SUNA = 'P');
BEGIN        
    -- Sincronización y obtención de la secuencia para ID_SEDE AL INICIO
    SELECT BDISYS.SQ_AUX_SEDE_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_SEDE), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_SEDE;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_AUX_SEDE_1 INCREMENT BY ' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_SEDE_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_AUX_SEDE_1 INCREMENT BY 1';
    --Control de Carga
    --1. Setear tabla origen y destino.
    v_tab_ori := 'T3726PADRUC';
    v_tab_des := 'AUX_SEDE';
    --2. Obtener el id de control de carga
    SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA
      INTO v_id_crg, v_id_det
    FROM (
        SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_CNFG_PROC_CARG,
               ROW_NUMBER() OVER (ORDER BY ID_CTRL_PROC_CARG_DETA DESC) AS rn
        FROM EQVSYS.TMP_AUX_CTRL_PROC_CARG_DETA
        WHERE ID_CNFG_PROC_CARG =
              (SELECT ID_CNFG_PROC_CARG
                 FROM REPBDISYS.AUX_CONF_PROC_CARG@DBL_BDQA19G7_REPBDISYS
                WHERE ID_TABLA_ORIGEN =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_ori
                          AND IN_ACTI = '1')
                  AND ID_TABLA_DESTINO =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_des
                          AND IN_ACTI = '1'))
    )
    WHERE rn = 1;    
    --3. Actualizar el estado de detalle de control de carga en estado 3 (en proceso)
    UPDATE REPBDISYS.AUX_CTRL_PROC_CARG_DETA@DBL_BDQA19G7_REPBDISYS
       SET IN_ESTA_PROC_DETA = '3',
           ID_USUA_MODI = C_ID_USUA_CREA,
           FE_USUA_MODI = SYSDATE,
           DE_TERM_MODI = C_DE_TERM_CREA
     WHERE ID_CTRL_PROC_CARG_DETA = v_id_det;    
    --4. Total Incremental
    SELECT COUNT(1) INTO v_tot_incr FROM EQVSYS.TMP_PADRUC; 
    --5. Total de tabla destino.
    SELECT COUNT(1) INTO v_tot_tab_des FROM BDISYS.AUX_SEDE WHERE IN_ACTI='1'; 
    --6. Total tabla origen
    SELECT COUNT(1) INTO v_tot_tab_ori FROM STGNETISYS.T3726PADRUC@DBL_BDQA11G2_STGNETISYS;
    --7. Registrar en eventos el inicio del proceso
    v_de_evto := 'Inicia carga Sedes Principales'; 
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA); 
    COMMIT;             
    --8. Obtenemos cantidad total de registros en la tabla intermedia de trabajo.
    SELECT COUNT(1) INTO v_ca_totl_tabl_inte FROM EQVSYS.TMP_PADRUC_3;
    --9. Obtenemos cantidad total de empleadores con RUC 11 en la tabla intermedia de BDI.
    v_ca_totl_tbdi_inte := 0;   
    --10. Obtener contador de registros que se actualizaron.
    v_un_totl_actu := 0;  
    -- Procesar Cursor 3    
    OPEN cursor_3;
    LOOP
        FETCH cursor_3 INTO v_id_pers_stg, v_num_ruc;
        EXIT WHEN cursor_3%NOTFOUND;
        
        SELECT BDISYS.SQ_AUX_SEDE_1.NEXTVAL INTO v_id_sede FROM DUAL;
        -- Insertar registros en AUX_SEDE y REL_SEDE_DIRE_ADIC utilizando las variables
        BEGIN

            INSERT INTO bdisys.aux_sede (id_empl, id_sede, co_sede_suna, id_tipo_estb, in_acti, id_usua_crea, fe_usua_crea, de_term_crea)
            VALUES (v_id_pers_stg, v_id_sede, 'P', 7, '1', 'INI-2842', SYSDATE, '1.1.1.1');

            DBMS_OUTPUT.PUT_LINE('v_id_sede: ' || v_id_sede);
            --Registrar las sedes principales para el control de carga
            REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_DETA_CARG_POR_REGI@DBL_BDQA19G7_REPBDISYS(v_id_det, 'Id Pers: '||v_id_pers_stg, 'RUC: '||v_num_ruc, 'INS',C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_deta_carg_regi, v_resul); 
            --11. Obtener contador de registros que se insertaron.
            v_un_totl_ingr := v_un_totl_ingr + 1;
        EXCEPTION
            WHEN OTHERS THEN
                DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
                --12. Contador de registros que se observaron.
                v_un_totl_obse := v_un_totl_obse + 1;
                v_de_obs := 'Error: ' || SQLERRM;
                REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_LOG_ERRO_ALER@DBL_BDQA19G7_REPBDISYS(v_id_det,  'Id Pers: '||v_id_pers_stg, 'RUC: '||v_num_ruc, v_de_obs, C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_aux_log_erro_aler, v_resul);
        END;
    END LOOP;
    CLOSE cursor_3;
    --13. Obtener contador de registros que se eliminaron.
    v_un_totl_elim := 0;
    --14. Contador de registros que no se aplicó ninguna acción.
    v_un_totl_ning := 0;
    --15. Calcular la cantidad migrados
    v_ca_totl_migr := v_un_totl_actu + v_un_totl_ingr + v_un_totl_elim + v_un_totl_obse;  
    --16. Obtengo el total de match
    v_ca_totl_match   := v_un_totl_actu;
    --17. Obtengo el total de no match
    v_ca_totl_nomatch := v_un_totl_ingr;
    --18. Actualizar los totales en el detalle de control de carga.
    IF v_un_totl_obse > 0 THEN 
      v_de_obs := 'Con Observaciones'; 
      v_in_esta_proc_deta := '0';
      -- Estado de proceso del detalle de carga 
      --0: Terminado con incidencias 
      --1: Terminado exitoso 
      --2: Pendiente 
      --3: En proceso
    END IF;    
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_ACT_PRC_CRG_DETA@DBL_BDQA19G7_REPBDISYS(v_id_crg,v_tab_ori,v_tab_des,v_ca_totl_migr,v_un_totl_actu,v_un_totl_ingr,v_un_totl_elim,v_un_totl_obse, v_un_totl_ning, v_in_esta_proc_deta,v_st_veri,v_ca_totl_no_migr,v_ca_totl_repr,v_in_tipo_detalle,v_ca_totl_tabl_inte,v_ca_totl_tbdi_inte,v_ca_totl_match,v_ca_totl_nomatch,v_de_obs,C_ID_USUA_CREA,C_DE_TERM_CREA,v_cant_ejec, v_retorno); 
    --20. Detalle finalizado
    v_de_evto := 'Finaliza carga Sedes Principales.'; 
    v_de_evto :=  v_de_evto || ': ' || v_cant_ejec;
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA);      
    COMMIT;
    -- Sincronización y obtención de la secuencia para ID_SEDE AL FINAL
    SELECT BDISYS.SQ_AUX_SEDE_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_SEDE), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_SEDE;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_AUX_SEDE_1 INCREMENT BY ' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_SEDE_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_AUX_SEDE_1 INCREMENT BY 1';
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
        ROLLBACK;
END;]]><ReadFromFileBeforeSQL type='bool'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type='string'><![CDATA[]]><ReadFromFileAfterSQL type='bool'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type='string'><![CDATA[]]><ReadFromFileBeforeSQLNode type='bool'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type='string'><![CDATA[]]><ReadFromFileAfterSQLNode type='bool'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V1S1P1"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "lnk_ora_bdisys_aux_sede"
      Partner "V1S0|V1S0P1"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "IN_PARM"
         SqlType "4"
         Precision "0"
         Scale "0"
         Nullable "0"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      LeftTextPos "292"
      TopTextPos "121"
      LinkMinimised "0"
   END DSRECORD
END DSJOB
BEGIN DSJOB
   Identifier "J003_TRN_EMPL_AUX_SEDE_PRI_0002"
   DateModified "2025-04-29"
   TimeModified "16.24.41"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "CJobDefn"
      Readonly "0"
      Name "J003_TRN_EMPL_AUX_SEDE_PRI_0002"
      NextID "5"
      Container "V0"
      JobVersion "56.0.0"
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Prompt "PRM_ORA_CONE_MAE_EMPL parameters"
         Default "(As pre-defined)"
         HelpTxt "Parámetro que contiene parametros de conexion para NETI"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceMode"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSeq"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceRecords"
         Value "100"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSkip"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TracePeriod"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RecordJobPerformanceData"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "IdentList"
         Value "ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_2|ora_EQVSYS02_TMP_EMPL_AUX_SEDE_PRI_1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "ClientCodePage"
         Value "1252"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      OrchestrateCode =+=+=+=
#################################################################
#### STAGE: ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_2
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>2</Context><Variant type=\\'string\\'>11</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD\"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US\"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW\"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><WriteMode type=\\'int\\'><![CDATA[0]]></WriteMode><GenerateSQL modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]></GenerateSQL><TableName modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_ES\"].TMP_EMPL_AUX_SEDE_PRI2]]><TableScope type=\\'int\\'><![CDATA[0]]></TableScope></TableName><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL></SQL><TableAction modified=\\'1\\' type=\\'int\\'><![CDATA[3]]><GenerateTruncateStatement type=\\'bool\\'><![CDATA[1]]><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></GenerateTruncateStatement><TableActionFirst type=\\'bool\\'><![CDATA[1]]></TableActionFirst></TableAction><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><DropUnmatchedFields type=\\'bool\\'><![CDATA[0]]></DropUnmatchedFields><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><PreserveTrailingBlanks type=\\'bool\\'><![CDATA[1]]></PreserveTrailingBlanks><FailOnRowErrorPX type=\\'bool\\'><![CDATA[1]]></FailOnRowErrorPX></Session><Logging><LogColumnValues collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LogColumnValues></Logging><BeforeAfter collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><Reconnect collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></Reconnect><Disconnect collapsed=\\'1\\' type=\\'int\\'><![CDATA[0]]></Disconnect></Usage></Properties >'
-connector '{
   variant=\\'11\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-target 0 '{
      DSSQLType={reg_sede_part=4, ID_PERS=2, NUM_RUC=1, ID_SEDE=2, CO_SEDE_SUNA=12, FE_USUA_MODI=9, FE_USUA_CREA=9, FECHA_MODI_CREA=9, FEC_ACTREG_SUNA=9}, 
      DSSQLPrecision={ID_PERS=38, NUM_RUC=11, ID_SEDE=38, CO_SEDE_SUNA=20}, 
      DSSchema=\\'record
         (
           reg_sede_part\\:int32\\;
           ID_PERS\\:nullable decimal\\[38\\,0\\]\\;
           NUM_RUC\\:nullable string\\[11\\]\\;
           ID_SEDE\\:nullable decimal\\[38\\,0\\]\\;
           CO_SEDE_SUNA\\:nullable string\\[max\\=20\\]\\;
           FE_USUA_MODI\\:nullable date\\;
           FE_USUA_CREA\\:nullable date\\;
           FECHA_MODI_CREA\\:nullable date\\;
           FEC_ACTREG_SUNA\\:nullable date\\;
         )\\'
}'
   

## General options
[ident('ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_2'); jobmon_ident('ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_2')]
## Inputs
0< [] 'ora_EQVSYS02_TMP_EMPL_AUX_SEDE_PRI_1:DSLink_padruc.v'
;

#################################################################
#### STAGE: ora_EQVSYS02_TMP_EMPL_AUX_SEDE_PRI_1
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>1</Context><Variant type=\\'string\\'>11g</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD\"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US\"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW\"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type=\\'int\\'><![CDATA[0]]></ReadMode><GenerateSQL type=\\'bool\\'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement modified=\\'1\\' type=\\'string\\'><![CDATA[SELECT 
        ROW_NUMBER() over (Partition By s.ID_EMPL, s.CO_SEDE_SUNA ORDER BY NVL (s.FE_USUA_MODI, s.FE_USUA_CREA) DESC) reg_sede_part
        , tmp_s.ID_PERS
        , tmp_s.NUM_RUC
        , s.ID_SEDE
        , s.CO_SEDE_SUNA
        , s.FE_USUA_MODI
        , s.FE_USUA_CREA
        , NVL (s.FE_USUA_MODI, s.FE_USUA_CREA) FECHA_MODI_CREA    
        , tmp_s.FEC_ACTREG_SUNA
    FROM (select DISTINCT ts.ID_PERS, ts.NUM_RUC, ts.FEC_ACTREG_SUNA from eqvsys.TMP_EMPL_AUX_SEDE_PRI1 ts) tmp_s  
    INNER JOIN bdisys.aux_sede s on tmp_s.ID_PERS = ID_EMPL and s.CO_SEDE_SUNA = \\'P\\' and s.IN_ACTI = 1]]><ReadFromFileSelect type=\\'bool\\'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed=\\'1\\'></Tables><Parameters collapsed=\\'1\\'></Parameters><Columns collapsed=\\'1\\'></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount><EndOfWave type=\\'int\\'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><PrefetchRowCount type=\\'int\\'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type=\\'int\\'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type=\\'bool\\'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type=\\'bool\\'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]><BeforeSQL modified=\\'1\\' type=\\'string\\'><![CDATA[DECLARE
  C_CUENTA NUMBER :=  0;
BEGIN 
-----------------------------------------------------------------------------------------------------------------------------------
--1--CREAR LA TABLA TMP TMP_EMPL_AUX_SEDE_PRI2 CONTIENE LAS SEDES PRINCIPALES (EN LA BDI) DE CADA EMPLEADOR DEL RANGO DE MIGRACIÓN--
-----------------------------------------------------------------------------------------------------------------------------------
SELECT NVL(COUNT(1),0) INTO C_CUENTA FROM ALL_TABLES 
WHERE OWNER = \\'EQVSYS\\' AND TABLE_NAME = \\'TMP_EMPL_AUX_SEDE_PRI2\\';
IF C_CUENTA > 0 THEN
    EXECUTE IMMEDIATE \\'DROP TABLE EQVSYS.TMP_EMPL_AUX_SEDE_PRI2 PURGE\\';
END IF;
EXECUTE IMMEDIATE  \\'CREATE TABLE EQVSYS.TMP_EMPL_AUX_SEDE_PRI2
                  (   
                    reg_sede_part     INTEGER,
                    id_pers           NUMBER(38,0) not null,
                    num_ruc           CHAR(11) not null,  
                    ID_SEDE           NUMBER(38,0) ,
                    CO_SEDE_SUNA      VARCHAR2(20 BYTE),
                    FE_USUA_MODI      DATE,
                    FE_USUA_CREA      DATE,
                    FECHA_MODI_CREA   DATE,
                    FEC_ACTREG_SUNA  DATE                   
                  )\\';
 END;]]><ReadFromFileBeforeSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileBeforeSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LimitRows></Usage></Properties >'
-connector '{
   variant=\\'11g\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-source 0 '{
      DSSQLType={reg_sede_part=4, ID_PERS=2, NUM_RUC=1, ID_SEDE=2, CO_SEDE_SUNA=12, FE_USUA_MODI=9, FE_USUA_CREA=9, FECHA_MODI_CREA=9, FEC_ACTREG_SUNA=9}, 
      DSSQLPrecision={ID_PERS=38, NUM_RUC=11, ID_SEDE=38, CO_SEDE_SUNA=20}, 
      DSSchema=\\'record
         (
           reg_sede_part\\:int32\\;
           ID_PERS\\:nullable decimal\\[38\\,0\\]\\;
           NUM_RUC\\:nullable string\\[11\\]\\;
           ID_SEDE\\:nullable decimal\\[38\\,0\\]\\;
           CO_SEDE_SUNA\\:nullable string\\[max\\=20\\]\\;
           FE_USUA_MODI\\:nullable date\\;
           FE_USUA_CREA\\:nullable date\\;
           FECHA_MODI_CREA\\:nullable date\\;
           FEC_ACTREG_SUNA\\:nullable date\\;
         )\\'
}'
   

## General options
[ident('ora_EQVSYS02_TMP_EMPL_AUX_SEDE_PRI_1'); jobmon_ident('ora_EQVSYS02_TMP_EMPL_AUX_SEDE_PRI_1')]
## Outputs
0> [modify (
  reg_sede_part:not_nullable int32=reg_sede_part;
  ID_PERS:nullable decimal[38,0]=ID_PERS;
  NUM_RUC:nullable string[11]=NUM_RUC;
  ID_SEDE:nullable decimal[38,0]=ID_SEDE;
  CO_SEDE_SUNA:nullable string[max=20]=CO_SEDE_SUNA;
  FE_USUA_MODI:nullable date=FE_USUA_MODI;
  FE_USUA_CREA:nullable date=FE_USUA_CREA;
  FECHA_MODI_CREA:nullable date=FECHA_MODI_CREA;
  FEC_ACTREG_SUNA:nullable date=FEC_ACTREG_SUNA;
keep
  reg_sede_part,ID_PERS,NUM_RUC,ID_SEDE,
  CO_SEDE_SUNA,FE_USUA_MODI,FE_USUA_CREA,FECHA_MODI_CREA,
  FEC_ACTREG_SUNA;
)] 'ora_EQVSYS02_TMP_EMPL_AUX_SEDE_PRI_1:DSLink_padruc.v'
;


=+=+=+=
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "3"
      Category "\\Jobs\\FUENTES_EXTERNAS\\MIGRACION_NETI_EMPL\\AUXILIAR\\AUX_SEDE_PRINCIPAL"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V0A0|V4S0|V4S1"
      StageXPos "68|576|120"
      StageYPos "23|168|168"
      StageTypes "ID_PALETTEANNOTATION|CCustomStage.CC_GUI|CCustomStage.CC_GUI"
      NextStageID "1"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "100"
      StageXSize "610|48|48"
      StageYSize "99|48|48"
      ContainerViewSizing "0026 0026 0705 0254 0000 0001 0000 0000"
      StageNames " |ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_2|ora_EQVSYS02_TMP_EMPL_AUX_SEDE_PRI_1"
      StageTypeIDs " |OracleConnectorPX|OracleConnectorPX"
      LinkNames " | |DSLink_padruc"
      LinkHasMetaDatas " | |True"
      LinkTypes " | |1"
      LinkNamePositionXs " | |338"
      LinkNamePositionYs " | |194"
      TargetStageIDs " | |V4S0"
      SourceStageEffectiveExecutionModes " | |2"
      SourceStageRuntimeExecutionModes " | |2"
      TargetStageEffectiveExecutionModes " | |2"
      TargetStageRuntimeExecutionModes " | |2"
      LinkIsSingleOperatorLookup " | |False"
      LinkIsSortSequential " | |False"
      LinkSortMode " | |0"
      LinkPartColMode " | |1"
      LinkSourcePinIDs " | |V4S1P1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0A0"
      OLEType "CAnnotation"
      Readonly "0"
      Name "V0A0"
      NextID "0"
      AnnotationType "0"
      AnnotationText =+=+=+=
OBTIENE SEDES PRINCIPALES EXISTENTES EN LA BDI PARA CADA EMPLEADOR 

Basados en la tabla eqvsys.TMP_EMPL_AUX_SEDE_PRI1.

El resultado es la TMP_EMPL_AUX_SEDE_PRI2.
En el caso de que existan mas de una sede principal para un empleador, los registros con el indicado de reistro (IN_REG) 1 son las sedes principales con la fecha de creación o modificación mas reciente.
=+=+=+=
      TextFont "MS Shell Dlg\\10\\0\\0\\0\\400\\0"
      TextHorizontalJustification "1"
      TextVerticalJustification "1"
      TextColor "0"
      BackgroundColor "12713983"
      BackgroundTransparent "0"
      BorderVisible "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V4S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_EQVSYS_TMP_EMPL_AUX_SEDE_PRI_2"
      NextID "2"
      InputPins "V4S0P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "target"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value "<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>2</Context><Variant type='string'>11</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><WriteMode type='int'><![CDATA[0]]></WriteMode><GenerateSQL modified='1' type='bool'><![CDATA[1]]></GenerateSQL><TableName modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_ES#.TMP_EMPL_AUX_SEDE_PRI2]]><TableScope type='int'><![CDATA[0]]></TableScope></TableName><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL></SQL><TableAction modified='1' type='int'><![CDATA[3]]><GenerateTruncateStatement type='bool'><![CDATA[1]]><FailOnError type='bool'><![CDATA[1]]></FailOnError></GenerateTruncateStatement><TableActionFirst type='bool'><![CDATA[1]]></TableActionFirst></TableAction><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><DropUnmatchedFields type='bool'><![CDATA[0]]></DropUnmatchedFields><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><PreserveTrailingBlanks type='bool'><![CDATA[1]]></PreserveTrailingBlanks><FailOnRowErrorPX type='bool'><![CDATA[1]]></FailOnRowErrorPX></Session><Logging><LogColumnValues collapsed='1' type='bool'><![CDATA[0]]></LogColumnValues></Logging><BeforeAfter collapsed='1' type='bool'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><Reconnect collapsed='1' type='bool'><![CDATA[0]]></Reconnect><Disconnect collapsed='1' type='int'><![CDATA[0]]></Disconnect></Usage></Properties >"
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V4S0P1"
      OLEType "CCustomInput"
      Readonly "0"
      Name "DSLink_padruc"
      Partner "V4S1|V4S1P1"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V4S1"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_EQVSYS02_TMP_EMPL_AUX_SEDE_PRI_1"
      NextID "2"
      OutputPins "V4S1P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11g</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement modified='1' type='string'><![CDATA[SELECT 
        ROW_NUMBER() over (Partition By s.ID_EMPL, s.CO_SEDE_SUNA ORDER BY NVL (s.FE_USUA_MODI, s.FE_USUA_CREA) DESC) reg_sede_part
        , tmp_s.ID_PERS
        , tmp_s.NUM_RUC
        , s.ID_SEDE
        , s.CO_SEDE_SUNA
        , s.FE_USUA_MODI
        , s.FE_USUA_CREA
        , NVL (s.FE_USUA_MODI, s.FE_USUA_CREA) FECHA_MODI_CREA    
        , tmp_s.FEC_ACTREG_SUNA
    FROM (select DISTINCT ts.ID_PERS, ts.NUM_RUC, ts.FEC_ACTREG_SUNA from eqvsys.TMP_EMPL_AUX_SEDE_PRI1 ts) tmp_s  
    INNER JOIN bdisys.aux_sede s on tmp_s.ID_PERS = ID_EMPL and s.CO_SEDE_SUNA = 'P' and s.IN_ACTI = 1]]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified='1' type='bool'><![CDATA[1]]><BeforeSQL modified='1' type='string'><![CDATA[DECLARE
  C_CUENTA NUMBER :=  0;
BEGIN 
-----------------------------------------------------------------------------------------------------------------------------------
--1--CREAR LA TABLA TMP TMP_EMPL_AUX_SEDE_PRI2 CONTIENE LAS SEDES PRINCIPALES (EN LA BDI) DE CADA EMPLEADOR DEL RANGO DE MIGRACIÓN--
-----------------------------------------------------------------------------------------------------------------------------------
SELECT NVL(COUNT(1),0) INTO C_CUENTA FROM ALL_TABLES 
WHERE OWNER = 'EQVSYS' AND TABLE_NAME = 'TMP_EMPL_AUX_SEDE_PRI2';
IF C_CUENTA > 0 THEN
    EXECUTE IMMEDIATE 'DROP TABLE EQVSYS.TMP_EMPL_AUX_SEDE_PRI2 PURGE';
END IF;
EXECUTE IMMEDIATE  'CREATE TABLE EQVSYS.TMP_EMPL_AUX_SEDE_PRI2
                  (   
                    reg_sede_part     INTEGER,
                    id_pers           NUMBER(38,0) not null,
                    num_ruc           CHAR(11) not null,  
                    ID_SEDE           NUMBER(38,0) ,
                    CO_SEDE_SUNA      VARCHAR2(20 BYTE),
                    FE_USUA_MODI      DATE,
                    FE_USUA_CREA      DATE,
                    FECHA_MODI_CREA   DATE,
                    FEC_ACTREG_SUNA  DATE                   
                  )';
 END;]]><ReadFromFileBeforeSQL type='bool'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type='string'><![CDATA[]]><ReadFromFileAfterSQL type='bool'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type='string'><![CDATA[]]><ReadFromFileBeforeSQLNode type='bool'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type='string'><![CDATA[]]><ReadFromFileAfterSQLNode type='bool'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V4S1P1"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "DSLink_padruc"
      Partner "V4S0|V4S0P1"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "reg_sede_part"
         SqlType "4"
         Precision "0"
         Scale "0"
         Nullable "0"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_PERS"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NUM_RUC"
         SqlType "1"
         Precision "11"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_SEDE"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "CO_SEDE_SUNA"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "FE_USUA_MODI"
         SqlType "9"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "FE_USUA_CREA"
         SqlType "9"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "FECHA_MODI_CREA"
         SqlType "9"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "FEC_ACTREG_SUNA"
         SqlType "9"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      LeftTextPos "338"
      TopTextPos "194"
      LinkMinimised "0"
   END DSRECORD
END DSJOB
BEGIN DSJOB
   Identifier "J004_INS_EMPL_AUX_VIA_0001"
   DateModified "2025-04-29"
   TimeModified "16.24.43"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "CJobDefn"
      Readonly "0"
      Name "J004_INS_EMPL_AUX_VIA_0001"
      NextID "8"
      Container "V0"
      JobVersion "56.0.0"
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Prompt "PRM_ORA_CONE_MAE_EMPL parameters"
         Default "(As pre-defined)"
         HelpTxt "Parámetro que contiene parametros de conexion para NETI"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceMode"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSeq"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceRecords"
         Value "100"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSkip"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TracePeriod"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RecordJobPerformanceData"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "IdentList"
         Value "ora_BDISYS_INS_AUX_VIA_PRI|Peek_VIA"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "ClientCodePage"
         Value "1252"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      OrchestrateCode =+=+=+=
#################################################################
#### STAGE: ora_BDISYS_INS_AUX_VIA_PRI
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>1</Context><Variant type=\\'string\\'>11</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD\"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US\"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW\"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type=\\'int\\'><![CDATA[0]]></ReadMode><GenerateSQL modified=\\'1\\' type=\\'bool\\'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed=\\'1\\' modified=\\'1\\' type=\\'string\\'><![CDATA[select 1 from dual]]><ReadFromFileSelect type=\\'bool\\'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed=\\'1\\'><Table type=\\'string\\'><![CDATA[dual]]></Table></Tables><Parameters collapsed=\\'1\\'></Parameters><Columns collapsed=\\'1\\'><Column type=\\'string\\'><![CDATA[defaulted_alias1,(null),dual]]></Column></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount><EndOfWave type=\\'int\\'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><PrefetchRowCount type=\\'int\\'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type=\\'int\\'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type=\\'bool\\'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type=\\'bool\\'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]><BeforeSQL modified=\\'1\\' type=\\'string\\'><![CDATA[--J004_INS_EMPL_AUX_VIA_0001
DECLARE
    -- Definición de variables
    v_id_via BDISYS.aux_via.id_via%TYPE;    
    v_de_via BDISYS.aux_via.de_via%TYPE; 
    v_id_tipo_via BDISYS.aux_via.ID_TIPO_VIA%TYPE;
    v_id_aux_log_erro_aler NUMBER;
    C_ID_USUA_CREA  bdisys.aux_sede.id_usua_crea%TYPE := \\'INI-2842\\';
    C_DE_TERM_CREA  bdisys.aux_sede.de_term_crea%TYPE := \\'1.1.1.1\\';
    v_id_crg         NUMBER(38,0);
    v_id_det         NUMBER(38,0);
    v_de_proc        VARCHAR2(300) := \\'Carga Auxiliar Via.\\';
    v_de_evto        VARCHAR2(300); 
    v_ca_totl_match   INT := 0; 
    v_ca_totl_nomatch INT := 0;
    v_ca_totl_migr    INT := 0;
    v_un_totl_actu    INT := 0;
    v_un_totl_ingr    INT := 0;
    v_un_totl_elim    INT := 0;
    v_un_totl_obse    INT := 0;
    v_un_totl_ning    INT := 0;
    v_in_tipo_detalle   CHAR(1) := \\'1\\'; -- Estado de proceso del detalle de carga 0: Terminado con incidencias 1: Terminado exitoso 2: Pendiente 3: En proceso
    v_in_esta_proc_deta CHAR(1) := \\'1\\'; -- Indicador de tipo de detalle. 1: incremental/rango/o inicial. 2: reproceso inmediato.
    v_st_veri           CHAR(1) := \\'1\\'; -- Estado de verificación del detalle de carga (0: sin verificar, 1: verificado, 2: pendiente).
    v_tab_ori           VARCHAR2(30);
    v_tab_des           VARCHAR2(30);
    v_tot_tab_des       INT := 0;
    v_tot_tab_ori       INT := 0;
    v_tot_incr          INT;
    v_fe_min            DATE; 
    v_fe_max            DATE;
    v_return            CHAR(1);
    v_ca_totl_tabl_inte INT :=0;
    v_ca_totl_tbdi_inte INT :=0;
    v_ca_totl_no_migr   INT :=0; 
    v_ca_totl_repr      INT :=0; 
    v_de_obs            VARCHAR2(500) := \\'Sin Observaciones\\';
    v_cant_ejec         NUMBER(38,0);
    v_retorno           CHAR(1) := \\'1\\';
    v_id_deta_carg_regi NUMBER;   
    v_resul             VARCHAR2(500);
    
    PROJ_KEY_MAX NUMBER := 0;
    PROJ_KEY_CURRVAL NUMBER := 0;
    PROJ_KEY_MAX_SEQ NUMBER := 0;
    
    -- Cursor 1
    CURSOR cursor_1 IS        
        SELECT v.DES_NOMVIA, v.ID_TIPO_VIA FROM --,\\'---\\', av.* FROM
            ( select  distinct 
                --case when (s.ID_TIPO_VIA = 0 and NVL(s.DES_NOMVIA,\\'0\\') = \\'0\\') then \\'SIN VIA DEFINIDA\\' else s.DES_NOMVIA end DES_NOMVIA
               --,s.ID_TIPO_VIA
               case when (NVL(s.DES_NOMVIA,\\'0\\') = \\'0\\') then \\'SIN VIA DEFINIDA\\' else s.DES_NOMVIA end DES_NOMVIA,
               case when (NVL(s.DES_NOMVIA,\\'0\\') = \\'0\\') then 0 else s.ID_TIPO_VIA end ID_TIPO_VIA
                from eqvsys.TMP_EMPL_AUX_SEDE_PRI1  s  
            )v
        LEFT JOIN  bdisys.aux_via av ON v.DES_NOMVIA = av.de_via 
                                      AND v.ID_TIPO_VIA =av.ID_TIPO_VIA 
                                      AND av.IN_ACTI = 1
        WHERE av.ID_TIPO_VIA IS NULL;
    BEGIN        
    -- Sincronización y obtención de la secuencia para ID_SEDE AL INICIO
    SELECT BDISYS.SQ_AUX_VIA_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_VIA), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_VIA;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_AUX_VIA_1 INCREMENT BY \\' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_VIA_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_AUX_VIA_1 INCREMENT BY 1\\';
    --Control de Carga
    --1. Setear tabla origen y destino.
    v_tab_ori := \\'T3726PADRUC\\';
    v_tab_des := \\'AUX_VIA\\';
    --2. Obtener el id de control de carga
    SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA
      INTO v_id_crg, v_id_det
    FROM (
        SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_CNFG_PROC_CARG,
               ROW_NUMBER() OVER (ORDER BY ID_CTRL_PROC_CARG_DETA DESC) AS rn
        FROM EQVSYS.TMP_AUX_CTRL_PROC_CARG_DETA
        WHERE ID_CNFG_PROC_CARG =
              (SELECT ID_CNFG_PROC_CARG
                 FROM REPBDISYS.AUX_CONF_PROC_CARG@DBL_BDQA19G7_REPBDISYS
                WHERE ID_TABLA_ORIGEN =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_ori
                          AND IN_ACTI = \\'1\\')
                  AND ID_TABLA_DESTINO =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_des
                          AND IN_ACTI = \\'1\\'))
    )
    WHERE rn = 1;
    --3. Actualizar el estado de detalle de control de carga en estado 3 (en proceso)
    UPDATE REPBDISYS.AUX_CTRL_PROC_CARG_DETA@DBL_BDQA19G7_REPBDISYS
       SET IN_ESTA_PROC_DETA = \\'3\\',
           ID_USUA_MODI = C_ID_USUA_CREA,
           FE_USUA_MODI = SYSDATE,
           DE_TERM_MODI = C_DE_TERM_CREA
     WHERE ID_CTRL_PROC_CARG_DETA = v_id_det;
    --4. Total Incremental
    SELECT COUNT(1) INTO v_tot_incr FROM EQVSYS.TMP_PADRUC; 
    --5. Total de tabla destino.
    SELECT COUNT(1) INTO v_tot_tab_des FROM BDISYS.AUX_VIA WHERE IN_ACTI=\\'1\\'; 
    --6. Total tabla origen
    SELECT COUNT(1) INTO v_tot_tab_ori FROM STGNETISYS.T3726PADRUC@DBL_BDQA11G2_STGNETISYS;
    --7. Registrar en eventos el inicio del proceso
    v_de_evto := \\'Inicia carga Auxiliar Via\\'; 
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA); 
    COMMIT;             
    --8. Obtenemos cantidad total de registros en la tabla intermedia de trabajo.
    SELECT COUNT(1) INTO v_ca_totl_tabl_inte FROM EQVSYS.TMP_EMPL_AUX_SEDE_PRI1;
    --9. Obtenemos cantidad total de empleadores con RUC 11 en la tabla intermedia de BDI.
    v_ca_totl_tbdi_inte := 0;   
    --10. Obtener contador de registros que se actualizaron.
    v_un_totl_actu := 0;
    -- Procesar Cursor 3    
    OPEN cursor_1;
    LOOP
        FETCH cursor_1 INTO  v_de_via, v_id_tipo_via;
        EXIT WHEN cursor_1%NOTFOUND;
        
        SELECT BDISYS.SQ_AUX_VIA_1.NEXTVAL INTO v_id_via FROM DUAL;
        -- Insertar registros en aux_via
        BEGIN
            INSERT INTO bdisys.aux_via (id_via, de_via, id_tipo_via, in_acti, id_usua_crea, fe_usua_crea, de_term_crea)
            VALUES (v_id_via, v_de_via, v_id_tipo_via, \\'1\\', \\'INI-2842\\', SYSDATE, \\'1.1.1.1\\');
            DBMS_OUTPUT.PUT_LINE(\\'v_id_via: \\' || v_id_via || \\'----\\' || v_de_via);
            --Registrar los aux_via para el control de carga
            REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_DETA_CARG_POR_REGI@DBL_BDQA19G7_REPBDISYS(v_id_det, v_id_via, \\'De Via: \\'||TRIM(SUBSTR(v_de_via,1,30))||\\'- Tipo Via: \\'||v_id_tipo_via,  \\'INS\\', C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_deta_carg_regi, v_resul); 
            --11. Obtener contador de registros que se insertaron.
            v_un_totl_ingr := v_un_totl_ingr + 1;
        EXCEPTION
            WHEN OTHERS THEN
                DBMS_OUTPUT.PUT_LINE(\\'Error en : \\' || v_de_via || \\'-----\\' || SQLERRM);
                --12. Contador de registros que se observaron.
                v_un_totl_obse := v_un_totl_obse + 1;
                v_de_obs := \\'Error en : \\' || v_de_via || \\'-\\' || SQLERRM;
                REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_LOG_ERRO_ALER@DBL_BDQA19G7_REPBDISYS(v_id_det, \\'Tipo Via: \\'||v_id_tipo_via, \\'De Via: \\'||TRIM(SUBSTR(v_de_via,1,30)),  v_de_obs, C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_aux_log_erro_aler, v_resul);
        END;
    END LOOP;
    CLOSE cursor_1;
    --13. Obtener contador de registros que se eliminaron.
    v_un_totl_elim := 0;
    --14. Contador de registros que no se aplicó ninguna acción.
    v_un_totl_ning := 0;
    --15. Calcular la cantidad migrados
    v_ca_totl_migr := v_un_totl_actu + v_un_totl_ingr + v_un_totl_elim + v_un_totl_obse;  
    --16. Obtengo el total de match
    v_ca_totl_match   := v_un_totl_actu;
    --17. Obtengo el total de no match
    v_ca_totl_nomatch := v_un_totl_ingr;
    --18. Actualizar los totales en el detalle de control de carga.
    IF v_un_totl_obse > 0 THEN 
      v_de_obs := \\'Con Observaciones\\'; 
      v_in_esta_proc_deta := \\'0\\';
      -- Estado de proceso del detalle de carga 
      --0: Terminado con incidencias 
      --1: Terminado exitoso 
      --2: Pendiente 
      --3: En proceso
    END IF;   
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_ACT_PRC_CRG_DETA@DBL_BDQA19G7_REPBDISYS(v_id_crg,v_tab_ori,v_tab_des,v_ca_totl_migr,v_un_totl_actu,v_un_totl_ingr,v_un_totl_elim,v_un_totl_obse, v_un_totl_ning, v_in_esta_proc_deta,v_st_veri,v_ca_totl_no_migr,v_ca_totl_repr,v_in_tipo_detalle,v_ca_totl_tabl_inte,v_ca_totl_tbdi_inte,v_ca_totl_match,v_ca_totl_nomatch,v_de_obs,C_ID_USUA_CREA,C_DE_TERM_CREA,v_cant_ejec, v_retorno); 
    --20. Detalle finalizado
    v_de_evto := \\'Finaliza carga Axiliar Via.\\'; 
    v_de_evto :=  v_de_evto || \\': \\' || v_cant_ejec;
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA);      
    COMMIT;
    -- Sincronización y obtención de la secuencia para ID_SEDE AL FINAL
    SELECT BDISYS.SQ_AUX_VIA_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_VIA), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_VIA;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_aux_via_1 INCREMENT BY \\' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_VIA_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_aux_via_1 INCREMENT BY 1\\';
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE(\\'Error: \\' || SQLERRM);
        ROLLBACK;
        v_de_evto := \\'Error al ejecutar carga Auxiliar Via: \\'||SQLERRM; 
        REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA); 
        COMMIT;
END;]]><ReadFromFileBeforeSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileBeforeSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LimitRows></Usage></Properties >'
-connector '{
   variant=\\'11\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-source 0 '{
      DSSQLType={IN_PARM=4}, 
      DSSchema=\\'record
         (
           IN_PARM\\:int32\\;
         )\\'
}'
   

## General options
[ident('ora_BDISYS_INS_AUX_VIA_PRI'); jobmon_ident('ora_BDISYS_INS_AUX_VIA_PRI')]
## Outputs
0> [modify (
  IN_PARM:not_nullable int32=IN_PARM;
keep
  IN_PARM;
)] 'ora_BDISYS_INS_AUX_VIA_PRI:lnk_ora_bdisys_aux_via.v'
;

#################################################################
#### STAGE: Peek_VIA
## Operator
peek
## Operator options
-nrecs 10
-name

## General options
[ident('Peek_VIA'); jobmon_ident('Peek_VIA')]
## Inputs
0< [] 'ora_BDISYS_INS_AUX_VIA_PRI:lnk_ora_bdisys_aux_via.v'
;


=+=+=+=
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "3"
      Category "\\Jobs\\FUENTES_EXTERNAS\\MIGRACION_NETI_EMPL\\AUXILIAR\\AUX_SEDE_PRINCIPAL"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V6A0|V7S0|V7S1"
      StageXPos "90|120|504"
      StageYPos "19|144|144"
      StageTypes "ID_PALETTEANNOTATION|CCustomStage.CC_GUI|CCustomStage"
      NextStageID "0"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "100"
      StageXSize "610|48|48"
      StageYSize "71|48|48"
      ContainerViewSizing "0078 0078 0786 0317 0000 0001 0000 0000"
      StageNames " |ora_BDISYS_INS_AUX_VIA_PRI|Peek_VIA"
      StageTypeIDs " |OracleConnectorPX|PxPeek"
      LinkNames " |lnk_ora_bdisys_aux_via| "
      LinkHasMetaDatas " |True| "
      LinkTypes " |1| "
      LinkNamePositionXs " |290| "
      LinkNamePositionYs " |170| "
      TargetStageIDs " |V7S1| "
      SourceStageEffectiveExecutionModes " |2| "
      SourceStageRuntimeExecutionModes " |2| "
      TargetStageEffectiveExecutionModes " |2| "
      TargetStageRuntimeExecutionModes " |2| "
      LinkIsSingleOperatorLookup " |False| "
      LinkIsSortSequential " |False| "
      LinkSortMode " |0| "
      LinkPartColMode " |1| "
      LinkSourcePinIDs " |V7S0P1| "
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V6A0"
      OLEType "CAnnotation"
      Readonly "0"
      Name "V6A0"
      NextID "0"
      AnnotationType "0"
      AnnotationText =+=+=+=
INSERTAR VIAS QUE VIENEN DENTRO DE T3726PADRUC COMO PARTE DE LA DIRECCION DE SEDE PRINCIPAL

Se insertan a partir de la tabla eqvsys.TMP_EMPL_AUX_SEDE_PRI1.
=+=+=+=
      TextFont "MS Shell Dlg\\10\\0\\0\\0\\400\\0"
      TextHorizontalJustification "1"
      TextVerticalJustification "1"
      TextColor "0"
      BackgroundColor "12713983"
      BackgroundTransparent "0"
      BorderVisible "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V7S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_BDISYS_INS_AUX_VIA_PRI"
      NextID "2"
      OutputPins "V7S0P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL modified='1' type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed='1' modified='1' type='string'><![CDATA[select 1 from dual]]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'><Table type='string'><![CDATA[dual]]></Table></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'><Column type='string'><![CDATA[defaulted_alias1,(null),dual]]></Column></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified='1' type='bool'><![CDATA[1]]><BeforeSQL modified='1' type='string'><![CDATA[--J004_INS_EMPL_AUX_VIA_0001
DECLARE
    -- Definición de variables
    v_id_via BDISYS.aux_via.id_via%TYPE;    
    v_de_via BDISYS.aux_via.de_via%TYPE; 
    v_id_tipo_via BDISYS.aux_via.ID_TIPO_VIA%TYPE;
    v_id_aux_log_erro_aler NUMBER;
    C_ID_USUA_CREA  bdisys.aux_sede.id_usua_crea%TYPE := 'INI-2842';
    C_DE_TERM_CREA  bdisys.aux_sede.de_term_crea%TYPE := '1.1.1.1';
    v_id_crg         NUMBER(38,0);
    v_id_det         NUMBER(38,0);
    v_de_proc        VARCHAR2(300) := 'Carga Auxiliar Via.';
    v_de_evto        VARCHAR2(300); 
    v_ca_totl_match   INT := 0; 
    v_ca_totl_nomatch INT := 0;
    v_ca_totl_migr    INT := 0;
    v_un_totl_actu    INT := 0;
    v_un_totl_ingr    INT := 0;
    v_un_totl_elim    INT := 0;
    v_un_totl_obse    INT := 0;
    v_un_totl_ning    INT := 0;
    v_in_tipo_detalle   CHAR(1) := '1'; -- Estado de proceso del detalle de carga 0: Terminado con incidencias 1: Terminado exitoso 2: Pendiente 3: En proceso
    v_in_esta_proc_deta CHAR(1) := '1'; -- Indicador de tipo de detalle. 1: incremental/rango/o inicial. 2: reproceso inmediato.
    v_st_veri           CHAR(1) := '1'; -- Estado de verificación del detalle de carga (0: sin verificar, 1: verificado, 2: pendiente).
    v_tab_ori           VARCHAR2(30);
    v_tab_des           VARCHAR2(30);
    v_tot_tab_des       INT := 0;
    v_tot_tab_ori       INT := 0;
    v_tot_incr          INT;
    v_fe_min            DATE; 
    v_fe_max            DATE;
    v_return            CHAR(1);
    v_ca_totl_tabl_inte INT :=0;
    v_ca_totl_tbdi_inte INT :=0;
    v_ca_totl_no_migr   INT :=0; 
    v_ca_totl_repr      INT :=0; 
    v_de_obs            VARCHAR2(500) := 'Sin Observaciones';
    v_cant_ejec         NUMBER(38,0);
    v_retorno           CHAR(1) := '1';
    v_id_deta_carg_regi NUMBER;   
    v_resul             VARCHAR2(500);
    
    PROJ_KEY_MAX NUMBER := 0;
    PROJ_KEY_CURRVAL NUMBER := 0;
    PROJ_KEY_MAX_SEQ NUMBER := 0;
    
    -- Cursor 1
    CURSOR cursor_1 IS        
        SELECT v.DES_NOMVIA, v.ID_TIPO_VIA FROM --,'---', av.* FROM
            ( select  distinct 
                --case when (s.ID_TIPO_VIA = 0 and NVL(s.DES_NOMVIA,'0') = '0') then 'SIN VIA DEFINIDA' else s.DES_NOMVIA end DES_NOMVIA
               --,s.ID_TIPO_VIA
               case when (NVL(s.DES_NOMVIA,'0') = '0') then 'SIN VIA DEFINIDA' else s.DES_NOMVIA end DES_NOMVIA,
               case when (NVL(s.DES_NOMVIA,'0') = '0') then 0 else s.ID_TIPO_VIA end ID_TIPO_VIA
                from eqvsys.TMP_EMPL_AUX_SEDE_PRI1  s  
            )v
        LEFT JOIN  bdisys.aux_via av ON v.DES_NOMVIA = av.de_via 
                                      AND v.ID_TIPO_VIA =av.ID_TIPO_VIA 
                                      AND av.IN_ACTI = 1
        WHERE av.ID_TIPO_VIA IS NULL;
    BEGIN        
    -- Sincronización y obtención de la secuencia para ID_SEDE AL INICIO
    SELECT BDISYS.SQ_AUX_VIA_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_VIA), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_VIA;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_AUX_VIA_1 INCREMENT BY ' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_VIA_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_AUX_VIA_1 INCREMENT BY 1';
    --Control de Carga
    --1. Setear tabla origen y destino.
    v_tab_ori := 'T3726PADRUC';
    v_tab_des := 'AUX_VIA';
    --2. Obtener el id de control de carga
    SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA
      INTO v_id_crg, v_id_det
    FROM (
        SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_CNFG_PROC_CARG,
               ROW_NUMBER() OVER (ORDER BY ID_CTRL_PROC_CARG_DETA DESC) AS rn
        FROM EQVSYS.TMP_AUX_CTRL_PROC_CARG_DETA
        WHERE ID_CNFG_PROC_CARG =
              (SELECT ID_CNFG_PROC_CARG
                 FROM REPBDISYS.AUX_CONF_PROC_CARG@DBL_BDQA19G7_REPBDISYS
                WHERE ID_TABLA_ORIGEN =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_ori
                          AND IN_ACTI = '1')
                  AND ID_TABLA_DESTINO =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_des
                          AND IN_ACTI = '1'))
    )
    WHERE rn = 1;
    --3. Actualizar el estado de detalle de control de carga en estado 3 (en proceso)
    UPDATE REPBDISYS.AUX_CTRL_PROC_CARG_DETA@DBL_BDQA19G7_REPBDISYS
       SET IN_ESTA_PROC_DETA = '3',
           ID_USUA_MODI = C_ID_USUA_CREA,
           FE_USUA_MODI = SYSDATE,
           DE_TERM_MODI = C_DE_TERM_CREA
     WHERE ID_CTRL_PROC_CARG_DETA = v_id_det;
    --4. Total Incremental
    SELECT COUNT(1) INTO v_tot_incr FROM EQVSYS.TMP_PADRUC; 
    --5. Total de tabla destino.
    SELECT COUNT(1) INTO v_tot_tab_des FROM BDISYS.AUX_VIA WHERE IN_ACTI='1'; 
    --6. Total tabla origen
    SELECT COUNT(1) INTO v_tot_tab_ori FROM STGNETISYS.T3726PADRUC@DBL_BDQA11G2_STGNETISYS;
    --7. Registrar en eventos el inicio del proceso
    v_de_evto := 'Inicia carga Auxiliar Via'; 
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA); 
    COMMIT;             
    --8. Obtenemos cantidad total de registros en la tabla intermedia de trabajo.
    SELECT COUNT(1) INTO v_ca_totl_tabl_inte FROM EQVSYS.TMP_EMPL_AUX_SEDE_PRI1;
    --9. Obtenemos cantidad total de empleadores con RUC 11 en la tabla intermedia de BDI.
    v_ca_totl_tbdi_inte := 0;   
    --10. Obtener contador de registros que se actualizaron.
    v_un_totl_actu := 0;
    -- Procesar Cursor 3    
    OPEN cursor_1;
    LOOP
        FETCH cursor_1 INTO  v_de_via, v_id_tipo_via;
        EXIT WHEN cursor_1%NOTFOUND;
        
        SELECT BDISYS.SQ_AUX_VIA_1.NEXTVAL INTO v_id_via FROM DUAL;
        -- Insertar registros en aux_via
        BEGIN
            INSERT INTO bdisys.aux_via (id_via, de_via, id_tipo_via, in_acti, id_usua_crea, fe_usua_crea, de_term_crea)
            VALUES (v_id_via, v_de_via, v_id_tipo_via, '1', 'INI-2842', SYSDATE, '1.1.1.1');
            DBMS_OUTPUT.PUT_LINE('v_id_via: ' || v_id_via || '----' || v_de_via);
            --Registrar los aux_via para el control de carga
            REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_DETA_CARG_POR_REGI@DBL_BDQA19G7_REPBDISYS(v_id_det, v_id_via, 'De Via: '||TRIM(SUBSTR(v_de_via,1,30))||'- Tipo Via: '||v_id_tipo_via,  'INS', C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_deta_carg_regi, v_resul); 
            --11. Obtener contador de registros que se insertaron.
            v_un_totl_ingr := v_un_totl_ingr + 1;
        EXCEPTION
            WHEN OTHERS THEN
                DBMS_OUTPUT.PUT_LINE('Error en : ' || v_de_via || '-----' || SQLERRM);
                --12. Contador de registros que se observaron.
                v_un_totl_obse := v_un_totl_obse + 1;
                v_de_obs := 'Error en : ' || v_de_via || '-' || SQLERRM;
                REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_LOG_ERRO_ALER@DBL_BDQA19G7_REPBDISYS(v_id_det, 'Tipo Via: '||v_id_tipo_via, 'De Via: '||TRIM(SUBSTR(v_de_via,1,30)),  v_de_obs, C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_aux_log_erro_aler, v_resul);
        END;
    END LOOP;
    CLOSE cursor_1;
    --13. Obtener contador de registros que se eliminaron.
    v_un_totl_elim := 0;
    --14. Contador de registros que no se aplicó ninguna acción.
    v_un_totl_ning := 0;
    --15. Calcular la cantidad migrados
    v_ca_totl_migr := v_un_totl_actu + v_un_totl_ingr + v_un_totl_elim + v_un_totl_obse;  
    --16. Obtengo el total de match
    v_ca_totl_match   := v_un_totl_actu;
    --17. Obtengo el total de no match
    v_ca_totl_nomatch := v_un_totl_ingr;
    --18. Actualizar los totales en el detalle de control de carga.
    IF v_un_totl_obse > 0 THEN 
      v_de_obs := 'Con Observaciones'; 
      v_in_esta_proc_deta := '0';
      -- Estado de proceso del detalle de carga 
      --0: Terminado con incidencias 
      --1: Terminado exitoso 
      --2: Pendiente 
      --3: En proceso
    END IF;   
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_ACT_PRC_CRG_DETA@DBL_BDQA19G7_REPBDISYS(v_id_crg,v_tab_ori,v_tab_des,v_ca_totl_migr,v_un_totl_actu,v_un_totl_ingr,v_un_totl_elim,v_un_totl_obse, v_un_totl_ning, v_in_esta_proc_deta,v_st_veri,v_ca_totl_no_migr,v_ca_totl_repr,v_in_tipo_detalle,v_ca_totl_tabl_inte,v_ca_totl_tbdi_inte,v_ca_totl_match,v_ca_totl_nomatch,v_de_obs,C_ID_USUA_CREA,C_DE_TERM_CREA,v_cant_ejec, v_retorno); 
    --20. Detalle finalizado
    v_de_evto := 'Finaliza carga Axiliar Via.'; 
    v_de_evto :=  v_de_evto || ': ' || v_cant_ejec;
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA);      
    COMMIT;
    -- Sincronización y obtención de la secuencia para ID_SEDE AL FINAL
    SELECT BDISYS.SQ_AUX_VIA_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_VIA), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_VIA;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_aux_via_1 INCREMENT BY ' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_VIA_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_aux_via_1 INCREMENT BY 1';
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
        ROLLBACK;
        v_de_evto := 'Error al ejecutar carga Auxiliar Via: '||SQLERRM; 
        REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA); 
        COMMIT;
END;]]><ReadFromFileBeforeSQL type='bool'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type='string'><![CDATA[]]><ReadFromFileAfterSQL type='bool'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type='string'><![CDATA[]]><ReadFromFileBeforeSQLNode type='bool'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type='string'><![CDATA[]]><ReadFromFileAfterSQLNode type='bool'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V7S0P1"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "lnk_ora_bdisys_aux_via"
      Partner "V7S1|V7S1P1"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "IN_PARM"
         SqlType "4"
         Precision "0"
         Scale "0"
         Nullable "0"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      LeftTextPos "290"
      TopTextPos "170"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V7S1"
      OLEType "CCustomStage"
      Readonly "0"
      Name "Peek_VIA"
      NextID "2"
      InputPins "V7S1P1"
      StageType "PxPeek"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "all"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "nrecs"
         Value "10"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "dataset"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "name"
         Value "name"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "columns"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "selection"
         Value " "
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V7S1P1"
      OLEType "CCustomInput"
      Readonly "0"
      Name "lnk_ora_bdisys_aux_via"
      Partner "V7S0|V7S0P1"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
END DSJOB
BEGIN DSJOB
   Identifier "J005_INS_EMPL_AUX_ZONA_0001"
   DateModified "2025-04-29"
   TimeModified "16.24.46"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "CJobDefn"
      Readonly "0"
      Name "J005_INS_EMPL_AUX_ZONA_0001"
      NextID "9"
      Container "V0"
      JobVersion "56.0.0"
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Prompt "PRM_ORA_CONE_MAE_EMPL parameters"
         Default "(As pre-defined)"
         HelpTxt "Parámetro que contiene parametros de conexion para NETI"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceMode"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSeq"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceRecords"
         Value "100"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSkip"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TracePeriod"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RecordJobPerformanceData"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "IdentList"
         Value "Peek_ZONA|ora_BDISYS_INS_AUX_ZONA_PRI"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "ClientCodePage"
         Value "1252"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      OrchestrateCode =+=+=+=
#################################################################
#### STAGE: Peek_ZONA
## Operator
peek
## Operator options
-nrecs 10
-name

## General options
[ident('Peek_ZONA'); jobmon_ident('Peek_ZONA')]
## Inputs
0< [] 'ora_BDISYS_INS_AUX_ZONA_PRI:lnk_ora_bdisys_aux_zona.v'
;

#################################################################
#### STAGE: ora_BDISYS_INS_AUX_ZONA_PRI
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>1</Context><Variant type=\\'string\\'>11</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD\"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US\"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW\"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type=\\'int\\'><![CDATA[0]]></ReadMode><GenerateSQL modified=\\'1\\' type=\\'bool\\'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed=\\'1\\' modified=\\'1\\' type=\\'string\\'><![CDATA[select 1 from dual]]><ReadFromFileSelect type=\\'bool\\'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed=\\'1\\'><Table type=\\'string\\'><![CDATA[dual]]></Table></Tables><Parameters collapsed=\\'1\\'></Parameters><Columns collapsed=\\'1\\'><Column type=\\'string\\'><![CDATA[defaulted_alias1,(null),dual]]></Column></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount><EndOfWave type=\\'int\\'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><PrefetchRowCount type=\\'int\\'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type=\\'int\\'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type=\\'bool\\'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type=\\'bool\\'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]><BeforeSQL modified=\\'1\\' type=\\'string\\'><![CDATA[--J005_INS_EMPL_AUX_ZONA_0001
DECLARE
    -- Definición de variables
    v_id_zona BDISYS.AUX_ZONA.ID_ZONA%TYPE;    
    v_de_zona BDISYS.AUX_ZONA.DE_ZONA%TYPE; 
    v_id_tipo_zona BDISYS.AUX_ZONA.ID_TIPO_ZONA%TYPE;     
    v_id_area_geog BDISYS.AUX_ZONA.ID_AREA_GEOG%TYPE;  
    v_id_aux_log_erro_aler NUMBER;
    C_ID_USUA_CREA  bdisys.aux_sede.id_usua_crea%TYPE := \\'INI-2842\\';
    C_DE_TERM_CREA  bdisys.aux_sede.de_term_crea%TYPE := \\'1.1.1.1\\';
    v_id_crg         NUMBER(38,0);
    v_id_det         NUMBER(38,0);
    v_de_proc        VARCHAR2(300) := \\'Carga Auxiliar Zona.\\';
    v_de_evto        VARCHAR2(300); 
    v_ca_totl_match   INT := 0; 
    v_ca_totl_nomatch INT := 0;
    v_ca_totl_migr    INT := 0;
    v_un_totl_actu    INT := 0;
    v_un_totl_ingr    INT := 0;
    v_un_totl_elim    INT := 0;
    v_un_totl_obse    INT := 0;
    v_un_totl_ning    INT := 0;
    v_in_tipo_detalle   CHAR(1) := \\'1\\'; -- Estado de proceso del detalle de carga 0: Terminado con incidencias 1: Terminado exitoso 2: Pendiente 3: En proceso
    v_in_esta_proc_deta CHAR(1) := \\'1\\'; -- Indicador de tipo de detalle. 1: incremental/rango/o inicial. 2: reproceso inmediato.
    v_st_veri           CHAR(1) := \\'1\\'; -- Estado de verificación del detalle de carga (0: sin verificar, 1: verificado, 2: pendiente).
    v_tab_ori           VARCHAR2(30);
    v_tab_des           VARCHAR2(30);
    v_tot_tab_des       INT := 0;
    v_tot_tab_ori       INT := 0;
    v_tot_incr          INT;
    v_fe_min            DATE; 
    v_fe_max            DATE;
    v_return            CHAR(1);
    v_ca_totl_tabl_inte INT :=0;
    v_ca_totl_tbdi_inte INT :=0;
    v_ca_totl_no_migr   INT :=0; 
    v_ca_totl_repr      INT :=0; 
    v_de_obs            VARCHAR2(500) := \\'Sin Observaciones\\';
    v_cant_ejec         NUMBER(38,0);
    v_retorno           CHAR(1) := \\'1\\';
    v_id_deta_carg_regi NUMBER;
    v_resul             VARCHAR2(500);    
    PROJ_KEY_MAX NUMBER := 0;
    PROJ_KEY_CURRVAL NUMBER := 0;
    PROJ_KEY_MAX_SEQ NUMBER := 0;
    -- Cursor 1
    CURSOR cursor_1 IS
        SELECT z.DES_NOMZON, z.ID_TIPO_ZONA, z.ID_AREA_GEOG FROM
            ( select distinct 
                --case when (s.ID_TIPO_ZONA = 0 and NVL(s.DES_NOMZON,\\'0\\') = \\'0\\') then \\'SIN ZONA DEFINIDA\\' else s.DES_NOMZON end DES_NOMZON
                --,s.ID_TIPO_ZONA
                case when (NVL(s.DES_NOMZON,\\'0\\') = \\'0\\') then \\'SIN ZONA DEFINIDA\\' else s.DES_NOMZON end DES_NOMZON
                ,case when (NVL(s.DES_NOMZON,\\'0\\') = \\'0\\') then 0 else s.ID_TIPO_ZONA end ID_TIPO_ZONA
                --,s.COD_TIPZON   
                --,case when (s.ID_TIPO_ZONA = 0 and NVL(s.DES_NOMZON,\\'0\\') = \\'0\\') then 0 else s.ID_AREA_GEOG end ID_AREA_GEOG   
                ,case when (NVL(s.DES_NOMZON,\\'0\\') = \\'0\\') then 0 else s.ID_AREA_GEOG end ID_AREA_GEOG             
                from eqvsys.TMP_EMPL_AUX_SEDE_PRI1 s  
                --where s.id_tipo_zona > 0 and s.des_nomzon is not null
            )z
        LEFT JOIN  bdisys.aux_zona az ON z.DES_NOMZON = az.DE_ZONA 
                                      AND z.ID_TIPO_ZONA =az.ID_TIPO_ZONA 
                                      AND z.ID_AREA_GEOG =az.ID_AREA_GEOG 
                                      AND az.IN_ACTI = 1
        WHERE az.ID_TIPO_ZONA IS NULL;
    BEGIN        
    -- Sincronización y obtención de la secuencia para ID_SEDE AL INICIO
    SELECT BDISYS.SQ_AUX_ZONA_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_ZONA), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_ZONA;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_AUX_ZONA_1 INCREMENT BY \\' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_ZONA_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_AUX_ZONA_1 INCREMENT BY 1\\';
    --Control de Carga
    --1. Setear tabla origen y destino.
    v_tab_ori := \\'T3726PADRUC\\';
    v_tab_des := \\'AUX_ZONA\\';
    --2. Obtener el id de control de carga
    SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA
      INTO v_id_crg, v_id_det
    FROM (
        SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_CNFG_PROC_CARG,
               ROW_NUMBER() OVER (ORDER BY ID_CTRL_PROC_CARG_DETA DESC) AS rn
        FROM EQVSYS.TMP_AUX_CTRL_PROC_CARG_DETA
        WHERE ID_CNFG_PROC_CARG =
              (SELECT ID_CNFG_PROC_CARG
                 FROM REPBDISYS.AUX_CONF_PROC_CARG@DBL_BDQA19G7_REPBDISYS
                WHERE ID_TABLA_ORIGEN =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_ori
                          AND IN_ACTI = \\'1\\')
                  AND ID_TABLA_DESTINO =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_des
                          AND IN_ACTI = \\'1\\'))
    )
    WHERE rn = 1;

    --3. Actualizar el estado de detalle de control de carga en estado 3 (en proceso)
    UPDATE REPBDISYS.AUX_CTRL_PROC_CARG_DETA@DBL_BDQA19G7_REPBDISYS
       SET IN_ESTA_PROC_DETA = \\'3\\',
           ID_USUA_MODI = C_ID_USUA_CREA,
           FE_USUA_MODI = SYSDATE,
           DE_TERM_MODI = C_DE_TERM_CREA
     WHERE ID_CTRL_PROC_CARG_DETA = v_id_det;
    --4. Total Incremental
    SELECT COUNT(1) INTO v_tot_incr FROM EQVSYS.TMP_PADRUC; 
    --5. Total de tabla destino.
    SELECT COUNT(1) INTO v_tot_tab_des FROM BDISYS.AUX_ZONA WHERE IN_ACTI=\\'1\\'; 
    --6. Total tabla origen
    SELECT COUNT(1) INTO v_tot_tab_ori FROM STGNETISYS.T3726PADRUC@DBL_BDQA11G2_STGNETISYS;
    --7. Registrar en eventos el inicio del proceso
    v_de_evto := \\'Inicia carga Auxiliar Zona\\'; 
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA); 
    COMMIT;             
    --8. Obtenemos cantidad total de registros en la tabla intermedia de trabajo.
    SELECT COUNT(1) INTO v_ca_totl_tabl_inte FROM EQVSYS.TMP_EMPL_AUX_SEDE_PRI1;
    --9. Obtenemos cantidad total de empleadores con RUC 11 en la tabla intermedia de BDI.
    v_ca_totl_tbdi_inte := 0;   
    --10. Obtener contador de registros que se actualizaron.
    v_un_totl_actu := 0;
    -- Procesar Cursor 1    
    OPEN cursor_1;
    LOOP
        FETCH cursor_1 INTO  v_de_zona, v_id_tipo_zona, v_id_area_geog ;
        EXIT WHEN cursor_1%NOTFOUND;
        
        SELECT BDISYS.SQ_AUX_ZONA_1.NEXTVAL INTO v_id_zona FROM DUAL;
        -- Insertar registros en AUX_ZONA
        BEGIN
            INSERT INTO bdisys.aux_zona (id_zona, de_zona, id_tipo_zona,  id_area_geog, in_acti, id_usua_crea, fe_usua_crea, de_term_crea)
            VALUES (v_id_zona, v_de_zona, v_id_tipo_zona,  v_id_area_geog, \\'1\\', \\'INI-2842\\', SYSDATE, \\'1.1.1.1\\');
            DBMS_OUTPUT.PUT_LINE(\\'v_id_zona: \\' || v_id_zona || \\'----\\' || v_de_zona);
            --Registrar las sedes principales para el control de carga
            REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_DETA_CARG_POR_REGI@DBL_BDQA19G7_REPBDISYS(v_id_det, v_id_tipo_zona,  \\'De zona: \\'||TRIM(SUBSTR(v_de_zona,1,20))||\\'-\\'||\\'Tipo Zona: \\'||v_id_tipo_zona||\\'-\\'||v_id_area_geog, \\'INS\\', C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_deta_carg_regi, v_resul); 
            --11. Obtener contador de registros que se insertaron.
            v_un_totl_ingr := v_un_totl_ingr + 1;
        EXCEPTION
            WHEN OTHERS THEN
                DBMS_OUTPUT.PUT_LINE(\\'Error en : \\' || v_de_zona || \\'-----\\' || SQLERRM);
                --12. Contador de registros que se observaron.
                v_un_totl_obse := v_un_totl_obse + 1;
                v_de_obs := \\'Error en : \\' || v_de_zona || \\'-----\\' || SQLERRM;
                    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_LOG_ERRO_ALER@DBL_BDQA19G7_REPBDISYS(v_id_det, \\'Tipo Zona: \\'||v_id_tipo_zona, \\'De zona: \\'||TRIM(SUBSTR(v_de_zona,1,40)),  v_de_obs, C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_aux_log_erro_aler, v_resul);
        END;
    END LOOP;
    CLOSE cursor_1;
    --13. Obtener contador de registros que se eliminaron.
    v_un_totl_elim := 0;
    --14. Contador de registros que no se aplicó ninguna acción.
    v_un_totl_ning := 0;
    --15. Calcular la cantidad migrados
    v_ca_totl_migr := v_un_totl_actu + v_un_totl_ingr + v_un_totl_elim + v_un_totl_obse;  
    --16. Obtengo el total de match
    v_ca_totl_match   := v_un_totl_actu;
    --17. Obtengo el total de no match
    v_ca_totl_nomatch := v_un_totl_ingr;
    --18. Actualizar los totales en el detalle de control de carga.
    IF v_un_totl_obse > 0 THEN 
      v_de_obs := \\'Con Observaciones\\'; 
      v_in_esta_proc_deta := \\'0\\';
      -- Estado de proceso del detalle de carga 
      --0: Terminado con incidencias 
      --1: Terminado exitoso 
      --2: Pendiente 
      --3: En proceso
    END IF;  
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_ACT_PRC_CRG_DETA@DBL_BDQA19G7_REPBDISYS(v_id_crg,v_tab_ori,v_tab_des,v_ca_totl_migr,v_un_totl_actu,v_un_totl_ingr,v_un_totl_elim,v_un_totl_obse, v_un_totl_ning, v_in_esta_proc_deta,v_st_veri,v_ca_totl_no_migr,v_ca_totl_repr,v_in_tipo_detalle,v_ca_totl_tabl_inte,v_ca_totl_tbdi_inte,v_ca_totl_match,v_ca_totl_nomatch,v_de_obs,C_ID_USUA_CREA,C_DE_TERM_CREA,v_cant_ejec, v_retorno); 
    --20. Detalle finalizado
    v_de_evto := \\'Finaliza carga Axiliar Zona.\\'; 
    v_de_evto :=  v_de_evto || \\': \\' || v_cant_ejec;
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA);
    COMMIT;
    -- Sincronización y obtención de la secuencia para ID_SEDE AL FINAL
    SELECT BDISYS.SQ_AUX_ZONA_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_ZONA), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_ZONA;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_AUX_ZONA_1 INCREMENT BY \\' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_ZONA_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_AUX_ZONA_1 INCREMENT BY 1\\';
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE(\\'Error: \\' || SQLERRM);
        ROLLBACK;
END;]]><ReadFromFileBeforeSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileBeforeSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LimitRows></Usage></Properties >'
-connector '{
   variant=\\'11\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-source 0 '{
      DSSQLType={IN_PARM=4}, 
      DSSchema=\\'record
         (
           IN_PARM\\:int32\\;
         )\\'
}'
   

## General options
[ident('ora_BDISYS_INS_AUX_ZONA_PRI'); jobmon_ident('ora_BDISYS_INS_AUX_ZONA_PRI')]
## Outputs
0> [modify (
  IN_PARM:not_nullable int32=IN_PARM;
keep
  IN_PARM;
)] 'ora_BDISYS_INS_AUX_ZONA_PRI:lnk_ora_bdisys_aux_zona.v'
;


=+=+=+=
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "3"
      Category "\\Jobs\\FUENTES_EXTERNAS\\MIGRACION_NETI_EMPL\\AUXILIAR\\AUX_SEDE_PRINCIPAL"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V8S0|V8S1|V0A0"
      StageXPos "480|96|0"
      StageYPos "96|96|0"
      StageTypes "CCustomStage|CCustomStage.CC_GUI|ID_PALETTEANNOTATION"
      NextStageID "1"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "100"
      StageXSize "48|48|483"
      StageYSize "48|48|72"
      ContainerViewSizing "0104 0104 1214 0496 0000 0001 0000 0000"
      StageNames "Peek_ZONA|ora_BDISYS_INS_AUX_ZONA_PRI| "
      StageTypeIDs "PxPeek|OracleConnectorPX| "
      LinkNames " |lnk_ora_bdisys_aux_zona| "
      LinkHasMetaDatas " |True| "
      LinkTypes " |1| "
      LinkNamePositionXs " |265| "
      LinkNamePositionYs " |123| "
      TargetStageIDs " |V8S0| "
      SourceStageEffectiveExecutionModes " |2| "
      SourceStageRuntimeExecutionModes " |2| "
      TargetStageEffectiveExecutionModes " |2| "
      TargetStageRuntimeExecutionModes " |2| "
      LinkIsSingleOperatorLookup " |False| "
      LinkIsSortSequential " |False| "
      LinkSortMode " |0| "
      LinkPartColMode " |1| "
      LinkSourcePinIDs " |V8S1P1| "
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0A0"
      OLEType "CAnnotation"
      Readonly "0"
      Name "V0A0"
      NextID "0"
      AnnotationType "0"
      AnnotationText =+=+=+=
INSERTAR ZONAS QUE VIENEN DENTRO DE T3726PADRUC COMO PARTE DE LA DIRECCION DE SEDE PRINCIPAL

Se insertan a partir de la tabla eqvsys.TMP_EMPL_AUX_SEDE_PRI1.
=+=+=+=
      TextFont "MS Shell Dlg\\10\\0\\0\\0\\400\\0"
      TextHorizontalJustification "1"
      TextVerticalJustification "1"
      TextColor "0"
      BackgroundColor "12713983"
      BackgroundTransparent "0"
      BorderVisible "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V8S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "Peek_ZONA"
      NextID "2"
      InputPins "V8S0P1"
      StageType "PxPeek"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "all"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "nrecs"
         Value "10"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "dataset"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "name"
         Value "name"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "columns"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "selection"
         Value " "
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V8S0P1"
      OLEType "CCustomInput"
      Readonly "0"
      Name "lnk_ora_bdisys_aux_zona"
      Partner "V8S1|V8S1P1"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V8S1"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_BDISYS_INS_AUX_ZONA_PRI"
      NextID "2"
      OutputPins "V8S1P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL modified='1' type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed='1' modified='1' type='string'><![CDATA[select 1 from dual]]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'><Table type='string'><![CDATA[dual]]></Table></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'><Column type='string'><![CDATA[defaulted_alias1,(null),dual]]></Column></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified='1' type='bool'><![CDATA[1]]><BeforeSQL modified='1' type='string'><![CDATA[--J005_INS_EMPL_AUX_ZONA_0001
DECLARE
    -- Definición de variables
    v_id_zona BDISYS.AUX_ZONA.ID_ZONA%TYPE;    
    v_de_zona BDISYS.AUX_ZONA.DE_ZONA%TYPE; 
    v_id_tipo_zona BDISYS.AUX_ZONA.ID_TIPO_ZONA%TYPE;     
    v_id_area_geog BDISYS.AUX_ZONA.ID_AREA_GEOG%TYPE;  
    v_id_aux_log_erro_aler NUMBER;
    C_ID_USUA_CREA  bdisys.aux_sede.id_usua_crea%TYPE := 'INI-2842';
    C_DE_TERM_CREA  bdisys.aux_sede.de_term_crea%TYPE := '1.1.1.1';
    v_id_crg         NUMBER(38,0);
    v_id_det         NUMBER(38,0);
    v_de_proc        VARCHAR2(300) := 'Carga Auxiliar Zona.';
    v_de_evto        VARCHAR2(300); 
    v_ca_totl_match   INT := 0; 
    v_ca_totl_nomatch INT := 0;
    v_ca_totl_migr    INT := 0;
    v_un_totl_actu    INT := 0;
    v_un_totl_ingr    INT := 0;
    v_un_totl_elim    INT := 0;
    v_un_totl_obse    INT := 0;
    v_un_totl_ning    INT := 0;
    v_in_tipo_detalle   CHAR(1) := '1'; -- Estado de proceso del detalle de carga 0: Terminado con incidencias 1: Terminado exitoso 2: Pendiente 3: En proceso
    v_in_esta_proc_deta CHAR(1) := '1'; -- Indicador de tipo de detalle. 1: incremental/rango/o inicial. 2: reproceso inmediato.
    v_st_veri           CHAR(1) := '1'; -- Estado de verificación del detalle de carga (0: sin verificar, 1: verificado, 2: pendiente).
    v_tab_ori           VARCHAR2(30);
    v_tab_des           VARCHAR2(30);
    v_tot_tab_des       INT := 0;
    v_tot_tab_ori       INT := 0;
    v_tot_incr          INT;
    v_fe_min            DATE; 
    v_fe_max            DATE;
    v_return            CHAR(1);
    v_ca_totl_tabl_inte INT :=0;
    v_ca_totl_tbdi_inte INT :=0;
    v_ca_totl_no_migr   INT :=0; 
    v_ca_totl_repr      INT :=0; 
    v_de_obs            VARCHAR2(500) := 'Sin Observaciones';
    v_cant_ejec         NUMBER(38,0);
    v_retorno           CHAR(1) := '1';
    v_id_deta_carg_regi NUMBER;
    v_resul             VARCHAR2(500);    
    PROJ_KEY_MAX NUMBER := 0;
    PROJ_KEY_CURRVAL NUMBER := 0;
    PROJ_KEY_MAX_SEQ NUMBER := 0;
    -- Cursor 1
    CURSOR cursor_1 IS
        SELECT z.DES_NOMZON, z.ID_TIPO_ZONA, z.ID_AREA_GEOG FROM
            ( select distinct 
                --case when (s.ID_TIPO_ZONA = 0 and NVL(s.DES_NOMZON,'0') = '0') then 'SIN ZONA DEFINIDA' else s.DES_NOMZON end DES_NOMZON
                --,s.ID_TIPO_ZONA
                case when (NVL(s.DES_NOMZON,'0') = '0') then 'SIN ZONA DEFINIDA' else s.DES_NOMZON end DES_NOMZON
                ,case when (NVL(s.DES_NOMZON,'0') = '0') then 0 else s.ID_TIPO_ZONA end ID_TIPO_ZONA
                --,s.COD_TIPZON   
                --,case when (s.ID_TIPO_ZONA = 0 and NVL(s.DES_NOMZON,'0') = '0') then 0 else s.ID_AREA_GEOG end ID_AREA_GEOG   
                ,case when (NVL(s.DES_NOMZON,'0') = '0') then 0 else s.ID_AREA_GEOG end ID_AREA_GEOG             
                from eqvsys.TMP_EMPL_AUX_SEDE_PRI1 s  
                --where s.id_tipo_zona > 0 and s.des_nomzon is not null
            )z
        LEFT JOIN  bdisys.aux_zona az ON z.DES_NOMZON = az.DE_ZONA 
                                      AND z.ID_TIPO_ZONA =az.ID_TIPO_ZONA 
                                      AND z.ID_AREA_GEOG =az.ID_AREA_GEOG 
                                      AND az.IN_ACTI = 1
        WHERE az.ID_TIPO_ZONA IS NULL;
    BEGIN        
    -- Sincronización y obtención de la secuencia para ID_SEDE AL INICIO
    SELECT BDISYS.SQ_AUX_ZONA_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_ZONA), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_ZONA;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_AUX_ZONA_1 INCREMENT BY ' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_ZONA_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_AUX_ZONA_1 INCREMENT BY 1';
    --Control de Carga
    --1. Setear tabla origen y destino.
    v_tab_ori := 'T3726PADRUC';
    v_tab_des := 'AUX_ZONA';
    --2. Obtener el id de control de carga
    SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA
      INTO v_id_crg, v_id_det
    FROM (
        SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_CNFG_PROC_CARG,
               ROW_NUMBER() OVER (ORDER BY ID_CTRL_PROC_CARG_DETA DESC) AS rn
        FROM EQVSYS.TMP_AUX_CTRL_PROC_CARG_DETA
        WHERE ID_CNFG_PROC_CARG =
              (SELECT ID_CNFG_PROC_CARG
                 FROM REPBDISYS.AUX_CONF_PROC_CARG@DBL_BDQA19G7_REPBDISYS
                WHERE ID_TABLA_ORIGEN =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_ori
                          AND IN_ACTI = '1')
                  AND ID_TABLA_DESTINO =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_des
                          AND IN_ACTI = '1'))
    )
    WHERE rn = 1;

    --3. Actualizar el estado de detalle de control de carga en estado 3 (en proceso)
    UPDATE REPBDISYS.AUX_CTRL_PROC_CARG_DETA@DBL_BDQA19G7_REPBDISYS
       SET IN_ESTA_PROC_DETA = '3',
           ID_USUA_MODI = C_ID_USUA_CREA,
           FE_USUA_MODI = SYSDATE,
           DE_TERM_MODI = C_DE_TERM_CREA
     WHERE ID_CTRL_PROC_CARG_DETA = v_id_det;
    --4. Total Incremental
    SELECT COUNT(1) INTO v_tot_incr FROM EQVSYS.TMP_PADRUC; 
    --5. Total de tabla destino.
    SELECT COUNT(1) INTO v_tot_tab_des FROM BDISYS.AUX_ZONA WHERE IN_ACTI='1'; 
    --6. Total tabla origen
    SELECT COUNT(1) INTO v_tot_tab_ori FROM STGNETISYS.T3726PADRUC@DBL_BDQA11G2_STGNETISYS;
    --7. Registrar en eventos el inicio del proceso
    v_de_evto := 'Inicia carga Auxiliar Zona'; 
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA); 
    COMMIT;             
    --8. Obtenemos cantidad total de registros en la tabla intermedia de trabajo.
    SELECT COUNT(1) INTO v_ca_totl_tabl_inte FROM EQVSYS.TMP_EMPL_AUX_SEDE_PRI1;
    --9. Obtenemos cantidad total de empleadores con RUC 11 en la tabla intermedia de BDI.
    v_ca_totl_tbdi_inte := 0;   
    --10. Obtener contador de registros que se actualizaron.
    v_un_totl_actu := 0;
    -- Procesar Cursor 1    
    OPEN cursor_1;
    LOOP
        FETCH cursor_1 INTO  v_de_zona, v_id_tipo_zona, v_id_area_geog ;
        EXIT WHEN cursor_1%NOTFOUND;
        
        SELECT BDISYS.SQ_AUX_ZONA_1.NEXTVAL INTO v_id_zona FROM DUAL;
        -- Insertar registros en AUX_ZONA
        BEGIN
            INSERT INTO bdisys.aux_zona (id_zona, de_zona, id_tipo_zona,  id_area_geog, in_acti, id_usua_crea, fe_usua_crea, de_term_crea)
            VALUES (v_id_zona, v_de_zona, v_id_tipo_zona,  v_id_area_geog, '1', 'INI-2842', SYSDATE, '1.1.1.1');
            DBMS_OUTPUT.PUT_LINE('v_id_zona: ' || v_id_zona || '----' || v_de_zona);
            --Registrar las sedes principales para el control de carga
            REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_DETA_CARG_POR_REGI@DBL_BDQA19G7_REPBDISYS(v_id_det, v_id_tipo_zona,  'De zona: '||TRIM(SUBSTR(v_de_zona,1,20))||'-'||'Tipo Zona: '||v_id_tipo_zona||'-'||v_id_area_geog, 'INS', C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_deta_carg_regi, v_resul); 
            --11. Obtener contador de registros que se insertaron.
            v_un_totl_ingr := v_un_totl_ingr + 1;
        EXCEPTION
            WHEN OTHERS THEN
                DBMS_OUTPUT.PUT_LINE('Error en : ' || v_de_zona || '-----' || SQLERRM);
                --12. Contador de registros que se observaron.
                v_un_totl_obse := v_un_totl_obse + 1;
                v_de_obs := 'Error en : ' || v_de_zona || '-----' || SQLERRM;
                    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_LOG_ERRO_ALER@DBL_BDQA19G7_REPBDISYS(v_id_det, 'Tipo Zona: '||v_id_tipo_zona, 'De zona: '||TRIM(SUBSTR(v_de_zona,1,40)),  v_de_obs, C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_aux_log_erro_aler, v_resul);
        END;
    END LOOP;
    CLOSE cursor_1;
    --13. Obtener contador de registros que se eliminaron.
    v_un_totl_elim := 0;
    --14. Contador de registros que no se aplicó ninguna acción.
    v_un_totl_ning := 0;
    --15. Calcular la cantidad migrados
    v_ca_totl_migr := v_un_totl_actu + v_un_totl_ingr + v_un_totl_elim + v_un_totl_obse;  
    --16. Obtengo el total de match
    v_ca_totl_match   := v_un_totl_actu;
    --17. Obtengo el total de no match
    v_ca_totl_nomatch := v_un_totl_ingr;
    --18. Actualizar los totales en el detalle de control de carga.
    IF v_un_totl_obse > 0 THEN 
      v_de_obs := 'Con Observaciones'; 
      v_in_esta_proc_deta := '0';
      -- Estado de proceso del detalle de carga 
      --0: Terminado con incidencias 
      --1: Terminado exitoso 
      --2: Pendiente 
      --3: En proceso
    END IF;  
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_ACT_PRC_CRG_DETA@DBL_BDQA19G7_REPBDISYS(v_id_crg,v_tab_ori,v_tab_des,v_ca_totl_migr,v_un_totl_actu,v_un_totl_ingr,v_un_totl_elim,v_un_totl_obse, v_un_totl_ning, v_in_esta_proc_deta,v_st_veri,v_ca_totl_no_migr,v_ca_totl_repr,v_in_tipo_detalle,v_ca_totl_tabl_inte,v_ca_totl_tbdi_inte,v_ca_totl_match,v_ca_totl_nomatch,v_de_obs,C_ID_USUA_CREA,C_DE_TERM_CREA,v_cant_ejec, v_retorno); 
    --20. Detalle finalizado
    v_de_evto := 'Finaliza carga Axiliar Zona.'; 
    v_de_evto :=  v_de_evto || ': ' || v_cant_ejec;
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA);
    COMMIT;
    -- Sincronización y obtención de la secuencia para ID_SEDE AL FINAL
    SELECT BDISYS.SQ_AUX_ZONA_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_ZONA), 0) INTO PROJ_KEY_MAX FROM BDISYS.AUX_ZONA;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_AUX_ZONA_1 INCREMENT BY ' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_AUX_ZONA_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_AUX_ZONA_1 INCREMENT BY 1';
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
        ROLLBACK;
END;]]><ReadFromFileBeforeSQL type='bool'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type='string'><![CDATA[]]><ReadFromFileAfterSQL type='bool'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type='string'><![CDATA[]]><ReadFromFileBeforeSQLNode type='bool'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type='string'><![CDATA[]]><ReadFromFileAfterSQLNode type='bool'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V8S1P1"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "lnk_ora_bdisys_aux_zona"
      Partner "V8S0|V8S0P1"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "IN_PARM"
         SqlType "4"
         Precision "0"
         Scale "0"
         Nullable "0"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      LeftTextPos "265"
      TopTextPos "123"
      LinkMinimised "0"
   END DSRECORD
END DSJOB
BEGIN DSJOB
   Identifier "J006_TRN_EMPL_MAE_DIRE_PRI_0001"
   DateModified "2025-04-29"
   TimeModified "16.24.48"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "CJobDefn"
      Readonly "0"
      Name "J006_TRN_EMPL_MAE_DIRE_PRI_0001"
      NextID "6"
      Container "V0"
      JobVersion "56.0.0"
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Prompt "PRM_ORA_CONE_MAE_EMPL parameters"
         Default "(As pre-defined)"
         HelpTxt "Parámetro que contiene parametros de conexion para NETI"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceMode"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSeq"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceRecords"
         Value "100"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSkip"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TracePeriod"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RecordJobPerformanceData"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "IdentList"
         Value "ora_EQVSYS03_TMP_EMPL_MAE_DIR_PRI1|ora_EQVSYS03_TMP_EMPL_AUX_SEDE_PRI_1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "ClientCodePage"
         Value "1252"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      OrchestrateCode =+=+=+=
#################################################################
#### STAGE: ora_EQVSYS03_TMP_EMPL_MAE_DIR_PRI1
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>2</Context><Variant type=\\'string\\'>11</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><WriteMode type=\\'int\\'><![CDATA[0]]></WriteMode><GenerateSQL modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]></GenerateSQL><TableName modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_ES"].TMP_EMPL_MAE_DIR_PRI1]]><TableScope type=\\'int\\'><![CDATA[0]]></TableScope></TableName><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL></SQL><TableAction modified=\\'1\\' type=\\'int\\'><![CDATA[2]]><GenerateCreateStatement type=\\'bool\\'><![CDATA[1]]><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></GenerateCreateStatement><GenerateDropStatement type=\\'bool\\'><![CDATA[1]]><FailOnError type=\\'bool\\'><![CDATA[0]]></FailOnError></GenerateDropStatement><TableActionFirst type=\\'bool\\'><![CDATA[1]]></TableActionFirst></TableAction><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><DropUnmatchedFields type=\\'bool\\'><![CDATA[0]]></DropUnmatchedFields><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><PreserveTrailingBlanks type=\\'bool\\'><![CDATA[1]]></PreserveTrailingBlanks><FailOnRowErrorPX type=\\'bool\\'><![CDATA[1]]></FailOnRowErrorPX></Session><Logging><LogColumnValues collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LogColumnValues></Logging><BeforeAfter collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><Reconnect collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></Reconnect><Disconnect collapsed=\\'1\\' type=\\'int\\'><![CDATA[0]]></Disconnect></Usage></Properties >'
-connector '{
   variant=\\'11\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:"11g":ccora11g;12:"12c":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-target 0 '{
      DSSQLType={ID_PERS=2, NUM_RUC=1, ID_TIPO_ZONA_ORIG=2, ID_TIPO_ZONA=2, DE_ZONA=12, ID_AREA_GEOG_ZONA=2, ID_TIPO_VIA_ORIG=2, ID_TIPO_VIA=2, DE_VIA=12, NU_DIRE_VIA=12, DE_REFE_DIRE=12, ID_VIA=2, ID_ZONA=2, ID_AREA_GEOG=2, NU_INTE_DIRE=12, NU_LOTE_DIRE=12, NU_MANZ_DIRE=12, NU_KILO_DIRE=12, NU_DEPA_DIRE=12, DES_NUMLIC=12, FEC_ACTREG_SUNA=9}, 
      DSSQLPrecision={ID_PERS=38, NUM_RUC=11, ID_TIPO_ZONA_ORIG=38, ID_TIPO_ZONA=38, DE_ZONA=200, ID_AREA_GEOG_ZONA=38, ID_TIPO_VIA_ORIG=38, ID_TIPO_VIA=38, DE_VIA=200, NU_DIRE_VIA=30, DE_REFE_DIRE=300, ID_VIA=38, ID_ZONA=38, ID_AREA_GEOG=38, NU_INTE_DIRE=30, NU_LOTE_DIRE=30, NU_MANZ_DIRE=30, NU_KILO_DIRE=20, NU_DEPA_DIRE=20, DES_NUMLIC=20}, 
      DSSchema=\\'record
         (
           ID_PERS\\:nullable decimal\\[38\\,0\\]\\;
           NUM_RUC\\:nullable string\\[11\\]\\;
           ID_TIPO_ZONA_ORIG\\:nullable decimal\\[38\\,0\\]\\;
           ID_TIPO_ZONA\\:nullable decimal\\[38\\,0\\]\\;
           DE_ZONA\\:nullable string\\[max\\=200\\]\\;
           ID_AREA_GEOG_ZONA\\:nullable decimal\\[38\\,0\\]\\;
           ID_TIPO_VIA_ORIG\\:nullable decimal\\[38\\,0\\]\\;
           ID_TIPO_VIA\\:nullable decimal\\[38\\,0\\]\\;
           DE_VIA\\:nullable string\\[max\\=200\\]\\;
           NU_DIRE_VIA\\:nullable string\\[max\\=30\\]\\;
           DE_REFE_DIRE\\:nullable string\\[max\\=300\\]\\;
           ID_VIA\\:nullable decimal\\[38\\,0\\]\\;
           ID_ZONA\\:nullable decimal\\[38\\,0\\]\\;
           ID_AREA_GEOG\\:nullable decimal\\[38\\,0\\]\\;
           NU_INTE_DIRE\\:nullable string\\[max\\=30\\]\\;
           NU_LOTE_DIRE\\:nullable string\\[max\\=30\\]\\;
           NU_MANZ_DIRE\\:nullable string\\[max\\=30\\]\\;
           NU_KILO_DIRE\\:nullable string\\[max\\=20\\]\\;
           NU_DEPA_DIRE\\:nullable string\\[max\\=20\\]\\;
           DES_NUMLIC\\:nullable string\\[max\\=20\\]\\;
           FEC_ACTREG_SUNA\\:nullable date\\;
         )\\'
}'
   

## General options
[ident('ora_EQVSYS03_TMP_EMPL_MAE_DIR_PRI1'); jobmon_ident('ora_EQVSYS03_TMP_EMPL_MAE_DIR_PRI1')]
## Inputs
0< [] 'ora_EQVSYS03_TMP_EMPL_AUX_SEDE_PRI_1:DSLink2.v'
;

#################################################################
#### STAGE: ora_EQVSYS03_TMP_EMPL_AUX_SEDE_PRI_1
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>1</Context><Variant type=\\'string\\'>11</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type=\\'int\\'><![CDATA[0]]></ReadMode><GenerateSQL modified=\\'1\\' type=\\'bool\\'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed=\\'1\\' modified=\\'1\\' type=\\'string\\'><![CDATA[SELECT  
  d1.ID_PERS
, d1.NUM_RUC
, d1.ID_TIPO_ZONA_ORIG
, d1.ID_TIPO_ZONA
--, d1.DE_ZONA_ORIG
, d1.DE_ZONA
, d1.ID_AREA_GEOG_ZONA
, d1.ID_TIPO_VIA_ORIG
, d1.ID_TIPO_VIA
--, d1.DE_VIA_ORIG
, d1.DE_VIA
, d1.NU_DIRE_VIA
, av.ID_VIA
, az.ID_ZONA
, d1.DE_REFE_DIRE
, d1.ID_AREA_GEOG
, d1.NU_INTE_DIRE
, d1.NU_LOTE_DIRE
, d1.NU_MANZ_DIRE
, d1.NU_KILO_DIRE
, d1.NU_DEPA_DIRE
, d1.DES_NUMLIC
, d1.FEC_ACTREG_SUNA
FROM
(
        SELECT 
          d.id_pers ID_PERS
        , d.num_ruc NUM_RUC
        , d.ID_TIPO_ZONA ID_TIPO_ZONA_ORIG
        , case when  (NVL(d.DES_NOMZON,\\'0\\') = \\'0\\') then 0 else d.ID_TIPO_ZONA end ID_TIPO_ZONA
        , d.DES_NOMZON DE_ZONA_ORIG
        , case when ((NVL(d.DES_NOMZON,\\'0\\') = \\'0\\') OR (d.ID_TIPO_ZONA = 0 and NVL(d.DES_NOMZON,\\'0\\') = \\'0\\')) then \\'SIN ZONA DEFINIDA\\' else d.DES_NOMZON end DE_ZONA
        , case when ((NVL(d.DES_NOMZON,\\'0\\') = \\'0\\') or (d.ID_TIPO_ZONA = 0 and NVL(d.DES_NOMZON,\\'0\\') = \\'0\\')) then 0 else d.ID_AREA_GEOG end ID_AREA_GEOG_ZONA
        , d.ID_TIPO_VIA ID_TIPO_VIA_ORIG
        , case when  (NVL(d.DES_NOMVIA,\\'0\\') = \\'0\\') then 0 else d.ID_TIPO_VIA end ID_TIPO_VIA
        , d.DES_NOMVIA DE_VIA_ORIG
        , case when ((NVL(d.DES_NOMVIA,\\'0\\') = \\'0\\') OR (d.ID_TIPO_VIA = 0 and NVL(d.DES_NOMVIA,\\'0\\') = \\'0\\')) then \\'SIN VIA DEFINIDA\\' else d.DES_NOMVIA end  DE_VIA
        , d.NUM_DIRCON NU_DIRE_VIA 
        , d.DES_REFUBI DE_REFE_DIRE 
        , d.ID_AREA_GEOG 
        , d.NUM_INTDIR NU_INTE_DIRE 
        , d.NUM_LOTDIR NU_LOTE_DIRE 
        , d.NUM_MANDIR NU_MANZ_DIRE 
        , d.NUM_KILDIR NU_KILO_DIRE 
        , d.NUM_DEPDIR NU_DEPA_DIRE 
        , \\'\\' DES_NUMLIC 
        , d.FEC_ACTREG_SUNA
        FROM eqvsys.TMP_EMPL_AUX_SEDE_PRI1 d  
 )d1
 INNER JOIN bdisys.aux_zona az on az.DE_ZONA = d1.DE_ZONA 
                             AND az.ID_TIPO_ZONA = d1.ID_TIPO_ZONA 
                             AND az.ID_AREA_GEOG = d1.ID_AREA_GEOG_ZONA 
                             AND az.IN_ACTI = 1  
INNER JOIN bdisys.aux_via av on av.DE_VIA =  d1.DE_VIA 
                             AND av.ID_TIPO_VIA = d1.ID_TIPO_VIA 
                             AND av.IN_ACTI = 1               
 
]]><ReadFromFileSelect type=\\'bool\\'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed=\\'1\\'></Tables><Parameters collapsed=\\'1\\'></Parameters><Columns collapsed=\\'1\\'></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount><EndOfWave type=\\'int\\'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><PrefetchRowCount type=\\'int\\'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type=\\'int\\'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type=\\'bool\\'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type=\\'bool\\'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]><BeforeSQL modified=\\'1\\' type=\\'string\\'><![CDATA[DECLARE
  C_CUENTA NUMBER :=  0;
BEGIN 
--------------------------------------------------------------------------------------------------------------
--1--CREAR LA TABLA TMP TMP_EMPL_MAE_DIR_PRI1 CONTIENE DATA DE PADRUC PARA CONSTRUIR DIRECCIONES DE SEDES PRINCIPALES --
--------------------------------------------------------------------------------------------------------------
SELECT NVL(COUNT(1),0) INTO C_CUENTA FROM ALL_TABLES 
WHERE OWNER = \\'EQVSYS\\' AND TABLE_NAME = \\'TMP_EMPL_MAE_DIR_PRI1\\';
IF C_CUENTA > 0 THEN
    EXECUTE IMMEDIATE \\'DROP TABLE EQVSYS.TMP_EMPL_MAE_DIR_PRI1 PURGE\\';
END IF;
EXECUTE IMMEDIATE  \\'CREATE TABLE EQVSYS.TMP_EMPL_MAE_DIR_PRI1 
                  (   
                    ID_PERS             NUMBER(38,0)  not null,
                    NUM_RUC             CHAR(11) not null,  
                                        
                    ID_TIPO_ZONA_ORIG   NUMBER(38,0), 
                    ID_TIPO_ZONA        NUMBER(38,0), 
                    DE_ZONA             VARCHAR2(200 BYTE),
                    ID_AREA_GEOG_ZONA   NUMBER(38,0), 
                    ID_TIPO_VIA_ORIG    NUMBER(38,0), 
                    ID_TIPO_VIA         NUMBER(38,0), 
                    DE_VIA              VARCHAR2(200 BYTE),
                    
                    NU_DIRE_VIA         VARCHAR2(30 BYTE),
                    DE_REFE_DIRE        VARCHAR2(300 BYTE),
                    ID_VIA              NUMBER(38,0) ,
                    ID_ZONA             NUMBER(38,0) ,
                    ID_AREA_GEOG        NUMBER(38,0) ,
                    NU_INTE_DIRE        VARCHAR2(30 BYTE),         
                    NU_LOTE_DIRE        VARCHAR2(30 BYTE),
                    NU_MANZ_DIRE        VARCHAR2(30 BYTE),  
                    NU_KILO_DIRE        VARCHAR2(20 BYTE),  
                    NU_DEPA_DIRE        VARCHAR2(20 BYTE),   
                                        
                    DES_NUMLIC          VARCHAR2(20 BYTE),
                    FEC_ACTREG_SUNA     DATE                
                  )\\';
 END;]]><ReadFromFileBeforeSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileBeforeSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LimitRows></Usage></Properties >'
-connector '{
   variant=\\'11\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:"11g":ccora11g;12:"12c":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-source 0 '{
      DSSQLType={ID_PERS=2, NUM_RUC=1, ID_TIPO_ZONA_ORIG=2, ID_TIPO_ZONA=2, DE_ZONA=12, ID_AREA_GEOG_ZONA=2, ID_TIPO_VIA_ORIG=2, ID_TIPO_VIA=2, DE_VIA=12, NU_DIRE_VIA=12, DE_REFE_DIRE=12, ID_VIA=2, ID_ZONA=2, ID_AREA_GEOG=2, NU_INTE_DIRE=12, NU_LOTE_DIRE=12, NU_MANZ_DIRE=12, NU_KILO_DIRE=12, NU_DEPA_DIRE=12, DES_NUMLIC=12, FEC_ACTREG_SUNA=9}, 
      DSSQLPrecision={ID_PERS=38, NUM_RUC=11, ID_TIPO_ZONA_ORIG=38, ID_TIPO_ZONA=38, DE_ZONA=200, ID_AREA_GEOG_ZONA=38, ID_TIPO_VIA_ORIG=38, ID_TIPO_VIA=38, DE_VIA=200, NU_DIRE_VIA=30, DE_REFE_DIRE=300, ID_VIA=38, ID_ZONA=38, ID_AREA_GEOG=38, NU_INTE_DIRE=30, NU_LOTE_DIRE=30, NU_MANZ_DIRE=30, NU_KILO_DIRE=20, NU_DEPA_DIRE=20, DES_NUMLIC=20}, 
      DSSchema=\\'record
         (
           ID_PERS\\:nullable decimal\\[38\\,0\\]\\;
           NUM_RUC\\:nullable string\\[11\\]\\;
           ID_TIPO_ZONA_ORIG\\:nullable decimal\\[38\\,0\\]\\;
           ID_TIPO_ZONA\\:nullable decimal\\[38\\,0\\]\\;
           DE_ZONA\\:nullable string\\[max\\=200\\]\\;
           ID_AREA_GEOG_ZONA\\:nullable decimal\\[38\\,0\\]\\;
           ID_TIPO_VIA_ORIG\\:nullable decimal\\[38\\,0\\]\\;
           ID_TIPO_VIA\\:nullable decimal\\[38\\,0\\]\\;
           DE_VIA\\:nullable string\\[max\\=200\\]\\;
           NU_DIRE_VIA\\:nullable string\\[max\\=30\\]\\;
           DE_REFE_DIRE\\:nullable string\\[max\\=300\\]\\;
           ID_VIA\\:nullable decimal\\[38\\,0\\]\\;
           ID_ZONA\\:nullable decimal\\[38\\,0\\]\\;
           ID_AREA_GEOG\\:nullable decimal\\[38\\,0\\]\\;
           NU_INTE_DIRE\\:nullable string\\[max\\=30\\]\\;
           NU_LOTE_DIRE\\:nullable string\\[max\\=30\\]\\;
           NU_MANZ_DIRE\\:nullable string\\[max\\=30\\]\\;
           NU_KILO_DIRE\\:nullable string\\[max\\=20\\]\\;
           NU_DEPA_DIRE\\:nullable string\\[max\\=20\\]\\;
           DES_NUMLIC\\:nullable string\\[max\\=20\\]\\;
           FEC_ACTREG_SUNA\\:nullable date\\;
         )\\'
}'
   

## General options
[ident('ora_EQVSYS03_TMP_EMPL_AUX_SEDE_PRI_1'); jobmon_ident('ora_EQVSYS03_TMP_EMPL_AUX_SEDE_PRI_1')]
## Outputs
0> [modify (
  ID_PERS:nullable decimal[38,0]=ID_PERS;
  NUM_RUC:nullable string[11]=NUM_RUC;
  ID_TIPO_ZONA_ORIG:nullable decimal[38,0]=ID_TIPO_ZONA_ORIG;
  ID_TIPO_ZONA:nullable decimal[38,0]=ID_TIPO_ZONA;
  DE_ZONA:nullable string[max=200]=DE_ZONA;
  ID_AREA_GEOG_ZONA:nullable decimal[38,0]=ID_AREA_GEOG_ZONA;
  ID_TIPO_VIA_ORIG:nullable decimal[38,0]=ID_TIPO_VIA_ORIG;
  ID_TIPO_VIA:nullable decimal[38,0]=ID_TIPO_VIA;
  DE_VIA:nullable string[max=200]=DE_VIA;
  NU_DIRE_VIA:nullable string[max=30]=NU_DIRE_VIA;
  DE_REFE_DIRE:nullable string[max=300]=DE_REFE_DIRE;
  ID_VIA:nullable decimal[38,0]=ID_VIA;
  ID_ZONA:nullable decimal[38,0]=ID_ZONA;
  ID_AREA_GEOG:nullable decimal[38,0]=ID_AREA_GEOG;
  NU_INTE_DIRE:nullable string[max=30]=NU_INTE_DIRE;
  NU_LOTE_DIRE:nullable string[max=30]=NU_LOTE_DIRE;
  NU_MANZ_DIRE:nullable string[max=30]=NU_MANZ_DIRE;
  NU_KILO_DIRE:nullable string[max=20]=NU_KILO_DIRE;
  NU_DEPA_DIRE:nullable string[max=20]=NU_DEPA_DIRE;
  DES_NUMLIC:nullable string[max=20]=DES_NUMLIC;
  FEC_ACTREG_SUNA:nullable date=FEC_ACTREG_SUNA;
keep
  ID_PERS,NUM_RUC,ID_TIPO_ZONA_ORIG,ID_TIPO_ZONA,
  DE_ZONA,ID_AREA_GEOG_ZONA,ID_TIPO_VIA_ORIG,ID_TIPO_VIA,
  DE_VIA,NU_DIRE_VIA,DE_REFE_DIRE,ID_VIA,
  ID_ZONA,ID_AREA_GEOG,NU_INTE_DIRE,NU_LOTE_DIRE,
  NU_MANZ_DIRE,NU_KILO_DIRE,NU_DEPA_DIRE,DES_NUMLIC,
  FEC_ACTREG_SUNA;
)] 'ora_EQVSYS03_TMP_EMPL_AUX_SEDE_PRI_1:DSLink2.v'
;


=+=+=+=
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "3"
      Category "\\Jobs\\FUENTES_EXTERNAS\\MIGRACION_NETI_EMPL\\AUXILIAR\\AUX_SEDE_PRINCIPAL"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V5S0|V5S1"
      StageXPos "504|72"
      StageYPos "120|120"
      StageTypes "CCustomStage.CC_GUI|CCustomStage.CC_GUI"
      NextStageID "0"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "100"
      StageXSize "48|48"
      StageYSize "48|48"
      ContainerViewSizing "0026 0026 0603 0303 0000 0001 0000 0000"
      StageNames "ora_EQVSYS03_TMP_EMPL_MAE_DIR_PRI1|ora_EQVSYS03_TMP_EMPL_AUX_SEDE_PRI_1"
      StageTypeIDs "OracleConnectorPX|OracleConnectorPX"
      LinkNames " |DSLink2"
      LinkHasMetaDatas " |True"
      LinkTypes " |1"
      LinkNamePositionXs " |312"
      LinkNamePositionYs " |144"
      TargetStageIDs " |V5S0"
      SourceStageEffectiveExecutionModes " |2"
      SourceStageRuntimeExecutionModes " |2"
      TargetStageEffectiveExecutionModes " |2"
      TargetStageRuntimeExecutionModes " |2"
      LinkIsSingleOperatorLookup " |False"
      LinkIsSortSequential " |False"
      LinkSortMode " |0"
      LinkPartColMode " |1"
      LinkSourcePinIDs " |V5S1P1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V5S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_EQVSYS03_TMP_EMPL_MAE_DIR_PRI1"
      NextID "2"
      InputPins "V5S0P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "target"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value "<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>2</Context><Variant type='string'>11</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><WriteMode type='int'><![CDATA[0]]></WriteMode><GenerateSQL modified='1' type='bool'><![CDATA[1]]></GenerateSQL><TableName modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_ES#.TMP_EMPL_MAE_DIR_PRI1]]><TableScope type='int'><![CDATA[0]]></TableScope></TableName><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL></SQL><TableAction modified='1' type='int'><![CDATA[2]]><GenerateCreateStatement type='bool'><![CDATA[1]]><FailOnError type='bool'><![CDATA[1]]></FailOnError></GenerateCreateStatement><GenerateDropStatement type='bool'><![CDATA[1]]><FailOnError type='bool'><![CDATA[0]]></FailOnError></GenerateDropStatement><TableActionFirst type='bool'><![CDATA[1]]></TableActionFirst></TableAction><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><DropUnmatchedFields type='bool'><![CDATA[0]]></DropUnmatchedFields><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><PreserveTrailingBlanks type='bool'><![CDATA[1]]></PreserveTrailingBlanks><FailOnRowErrorPX type='bool'><![CDATA[1]]></FailOnRowErrorPX></Session><Logging><LogColumnValues collapsed='1' type='bool'><![CDATA[0]]></LogColumnValues></Logging><BeforeAfter collapsed='1' type='bool'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><Reconnect collapsed='1' type='bool'><![CDATA[0]]></Reconnect><Disconnect collapsed='1' type='int'><![CDATA[0]]></Disconnect></Usage></Properties >"
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V5S0P1"
      OLEType "CCustomInput"
      Readonly "0"
      Name "DSLink2"
      Partner "V5S1|V5S1P1"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V5S1"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_EQVSYS03_TMP_EMPL_AUX_SEDE_PRI_1"
      NextID "2"
      OutputPins "V5S1P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL modified='1' type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed='1' modified='1' type='string'><![CDATA[SELECT  
  d1.ID_PERS
, d1.NUM_RUC
, d1.ID_TIPO_ZONA_ORIG
, d1.ID_TIPO_ZONA
--, d1.DE_ZONA_ORIG
, d1.DE_ZONA
, d1.ID_AREA_GEOG_ZONA
, d1.ID_TIPO_VIA_ORIG
, d1.ID_TIPO_VIA
--, d1.DE_VIA_ORIG
, d1.DE_VIA
, d1.NU_DIRE_VIA
, av.ID_VIA
, az.ID_ZONA
, d1.DE_REFE_DIRE
, d1.ID_AREA_GEOG
, d1.NU_INTE_DIRE
, d1.NU_LOTE_DIRE
, d1.NU_MANZ_DIRE
, d1.NU_KILO_DIRE
, d1.NU_DEPA_DIRE
, d1.DES_NUMLIC
, d1.FEC_ACTREG_SUNA
FROM
(
        SELECT 
          d.id_pers ID_PERS
        , d.num_ruc NUM_RUC
        , d.ID_TIPO_ZONA ID_TIPO_ZONA_ORIG
        , case when  (NVL(d.DES_NOMZON,'0') = '0') then 0 else d.ID_TIPO_ZONA end ID_TIPO_ZONA
        , d.DES_NOMZON DE_ZONA_ORIG
        , case when ((NVL(d.DES_NOMZON,'0') = '0') OR (d.ID_TIPO_ZONA = 0 and NVL(d.DES_NOMZON,'0') = '0')) then 'SIN ZONA DEFINIDA' else d.DES_NOMZON end DE_ZONA
        , case when ((NVL(d.DES_NOMZON,'0') = '0') or (d.ID_TIPO_ZONA = 0 and NVL(d.DES_NOMZON,'0') = '0')) then 0 else d.ID_AREA_GEOG end ID_AREA_GEOG_ZONA
        , d.ID_TIPO_VIA ID_TIPO_VIA_ORIG
        , case when  (NVL(d.DES_NOMVIA,'0') = '0') then 0 else d.ID_TIPO_VIA end ID_TIPO_VIA
        , d.DES_NOMVIA DE_VIA_ORIG
        , case when ((NVL(d.DES_NOMVIA,'0') = '0') OR (d.ID_TIPO_VIA = 0 and NVL(d.DES_NOMVIA,'0') = '0')) then 'SIN VIA DEFINIDA' else d.DES_NOMVIA end  DE_VIA
        , d.NUM_DIRCON NU_DIRE_VIA 
        , d.DES_REFUBI DE_REFE_DIRE 
        , d.ID_AREA_GEOG 
        , d.NUM_INTDIR NU_INTE_DIRE 
        , d.NUM_LOTDIR NU_LOTE_DIRE 
        , d.NUM_MANDIR NU_MANZ_DIRE 
        , d.NUM_KILDIR NU_KILO_DIRE 
        , d.NUM_DEPDIR NU_DEPA_DIRE 
        , '' DES_NUMLIC 
        , d.FEC_ACTREG_SUNA
        FROM eqvsys.TMP_EMPL_AUX_SEDE_PRI1 d  
 )d1
 INNER JOIN bdisys.aux_zona az on az.DE_ZONA = d1.DE_ZONA 
                             AND az.ID_TIPO_ZONA = d1.ID_TIPO_ZONA 
                             AND az.ID_AREA_GEOG = d1.ID_AREA_GEOG_ZONA 
                             AND az.IN_ACTI = 1  
INNER JOIN bdisys.aux_via av on av.DE_VIA =  d1.DE_VIA 
                             AND av.ID_TIPO_VIA = d1.ID_TIPO_VIA 
                             AND av.IN_ACTI = 1               
 
]]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified='1' type='bool'><![CDATA[1]]><BeforeSQL modified='1' type='string'><![CDATA[DECLARE
  C_CUENTA NUMBER :=  0;
BEGIN 
--------------------------------------------------------------------------------------------------------------
--1--CREAR LA TABLA TMP TMP_EMPL_MAE_DIR_PRI1 CONTIENE DATA DE PADRUC PARA CONSTRUIR DIRECCIONES DE SEDES PRINCIPALES --
--------------------------------------------------------------------------------------------------------------
SELECT NVL(COUNT(1),0) INTO C_CUENTA FROM ALL_TABLES 
WHERE OWNER = 'EQVSYS' AND TABLE_NAME = 'TMP_EMPL_MAE_DIR_PRI1';
IF C_CUENTA > 0 THEN
    EXECUTE IMMEDIATE 'DROP TABLE EQVSYS.TMP_EMPL_MAE_DIR_PRI1 PURGE';
END IF;
EXECUTE IMMEDIATE  'CREATE TABLE EQVSYS.TMP_EMPL_MAE_DIR_PRI1 
                  (   
                    ID_PERS             NUMBER(38,0)  not null,
                    NUM_RUC             CHAR(11) not null,  
                                        
                    ID_TIPO_ZONA_ORIG   NUMBER(38,0), 
                    ID_TIPO_ZONA        NUMBER(38,0), 
                    DE_ZONA             VARCHAR2(200 BYTE),
                    ID_AREA_GEOG_ZONA   NUMBER(38,0), 
                    ID_TIPO_VIA_ORIG    NUMBER(38,0), 
                    ID_TIPO_VIA         NUMBER(38,0), 
                    DE_VIA              VARCHAR2(200 BYTE),
                    
                    NU_DIRE_VIA         VARCHAR2(30 BYTE),
                    DE_REFE_DIRE        VARCHAR2(300 BYTE),
                    ID_VIA              NUMBER(38,0) ,
                    ID_ZONA             NUMBER(38,0) ,
                    ID_AREA_GEOG        NUMBER(38,0) ,
                    NU_INTE_DIRE        VARCHAR2(30 BYTE),         
                    NU_LOTE_DIRE        VARCHAR2(30 BYTE),
                    NU_MANZ_DIRE        VARCHAR2(30 BYTE),  
                    NU_KILO_DIRE        VARCHAR2(20 BYTE),  
                    NU_DEPA_DIRE        VARCHAR2(20 BYTE),   
                                        
                    DES_NUMLIC          VARCHAR2(20 BYTE),
                    FEC_ACTREG_SUNA     DATE                
                  )';
 END;]]><ReadFromFileBeforeSQL type='bool'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type='string'><![CDATA[]]><ReadFromFileAfterSQL type='bool'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type='string'><![CDATA[]]><ReadFromFileBeforeSQLNode type='bool'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type='string'><![CDATA[]]><ReadFromFileAfterSQLNode type='bool'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V5S1P1"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "DSLink2"
      Partner "V5S0|V5S0P1"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "ID_PERS"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NUM_RUC"
         SqlType "1"
         Precision "11"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_TIPO_ZONA_ORIG"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_TIPO_ZONA"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DE_ZONA"
         SqlType "12"
         Precision "200"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_AREA_GEOG_ZONA"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_TIPO_VIA_ORIG"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_TIPO_VIA"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DE_VIA"
         SqlType "12"
         Precision "200"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NU_DIRE_VIA"
         SqlType "12"
         Precision "30"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DE_REFE_DIRE"
         SqlType "12"
         Precision "300"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_VIA"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_ZONA"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_AREA_GEOG"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NU_INTE_DIRE"
         SqlType "12"
         Precision "30"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NU_LOTE_DIRE"
         SqlType "12"
         Precision "30"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NU_MANZ_DIRE"
         SqlType "12"
         Precision "30"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NU_KILO_DIRE"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NU_DEPA_DIRE"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DES_NUMLIC"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "FEC_ACTREG_SUNA"
         SqlType "9"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      LeftTextPos "312"
      TopTextPos "144"
      LinkMinimised "0"
   END DSRECORD
END DSJOB
BEGIN DSJOB
   Identifier "J007_INS_EMPL_DIR_PRI_0001"
   DateModified "2025-04-29"
   TimeModified "16.24.49"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "CJobDefn"
      Readonly "0"
      Name "J007_INS_EMPL_DIR_PRI_0001"
      NextID "11"
      Container "V0"
      JobVersion "56.0.0"
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Prompt "PRM_ORA_CONE_MAE_EMPL parameters"
         Default "(As pre-defined)"
         HelpTxt "Parámetro que contiene parametros de conexion para NETI"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "IdentList"
         Value "ora_BDISYS_INS_MAE_DIR_PRI|Peek_MAE_DIR"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "ClientCodePage"
         Value "1252"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceMode"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSeq"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceRecords"
         Value "100"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSkip"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TracePeriod"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RecordJobPerformanceData"
         Value "0"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      OrchestrateCode =+=+=+=
#################################################################
#### STAGE: ora_BDISYS_INS_MAE_DIR_PRI
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>1</Context><Variant type=\\'string\\'>11</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD\"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US\"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW\"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type=\\'int\\'><![CDATA[0]]></ReadMode><GenerateSQL modified=\\'1\\' type=\\'bool\\'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed=\\'1\\' modified=\\'1\\' type=\\'string\\'><![CDATA[select 1 from dual]]><ReadFromFileSelect type=\\'bool\\'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed=\\'1\\'><Table type=\\'string\\'><![CDATA[dual]]></Table></Tables><Parameters collapsed=\\'1\\'></Parameters><Columns collapsed=\\'1\\'><Column type=\\'string\\'><![CDATA[defaulted_alias1,(null),dual]]></Column></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount><EndOfWave type=\\'int\\'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><PrefetchRowCount type=\\'int\\'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type=\\'int\\'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type=\\'bool\\'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type=\\'bool\\'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]><BeforeSQL modified=\\'1\\' type=\\'string\\'><![CDATA[--J007_INS_EMPL_DIR_PRI_0001
DECLARE
    -- Definición de variables
    v_id_dire           BDISYS.MAE_DIRE.ID_DIRE%TYPE;    
    v_nu_dire_via       BDISYS.MAE_DIRE.NU_DIRE_VIA%TYPE;    
    v_de_refe_dire      BDISYS.MAE_DIRE.DE_REFE_DIRE%TYPE;    
    v_id_via            BDISYS.MAE_DIRE.ID_VIA%TYPE;    
    v_id_zona           BDISYS.MAE_DIRE.ID_ZONA%TYPE;    
    v_id_area_geog      BDISYS.MAE_DIRE.ID_AREA_GEOG%TYPE;    
    v_nu_inte_dire      BDISYS.MAE_DIRE.NU_INTE_DIRE%TYPE;    
    v_nu_lote_dire      BDISYS.MAE_DIRE.NU_LOTE_DIRE%TYPE;    
    v_nu_manz_dire      BDISYS.MAE_DIRE.NU_MANZ_DIRE%TYPE;    
    v_nu_kilo_dire      BDISYS.MAE_DIRE.NU_KILO_DIRE%TYPE;    
    v_nu_depa_dire      BDISYS.MAE_DIRE.NU_DEPA_DIRE%TYPE;    
    v_id_aux_log_erro_aler NUMBER;
    C_ID_USUA_CREA  bdisys.aux_sede.id_usua_crea%TYPE := \\'INI-2842\\';
    C_DE_TERM_CREA  bdisys.aux_sede.de_term_crea%TYPE := \\'1.1.1.1\\';
    v_id_crg         NUMBER(38,0);
    v_id_det         NUMBER(38,0);
    v_de_proc        VARCHAR2(300) := \\'Carga Direcciones.\\';
    v_de_evto        VARCHAR2(300); 
    v_ca_totl_match   INT := 0; 
    v_ca_totl_nomatch INT := 0;
    v_ca_totl_migr    INT := 0;
    v_un_totl_actu    INT := 0;
    v_un_totl_ingr    INT := 0;
    v_un_totl_elim    INT := 0;
    v_un_totl_obse    INT := 0;
    v_un_totl_ning    INT := 0;
    v_in_tipo_detalle   CHAR(1) := \\'1\\'; -- Estado de proceso del detalle de carga 0: Terminado con incidencias 1: Terminado exitoso 2: Pendiente 3: En proceso
    v_in_esta_proc_deta CHAR(1) := \\'1\\'; -- Indicador de tipo de detalle. 1: incremental/rango/o inicial. 2: reproceso inmediato.
    v_st_veri           CHAR(1) := \\'1\\'; -- Estado de verificación del detalle de carga (0: sin verificar, 1: verificado, 2: pendiente).
    v_tab_ori           VARCHAR2(30);
    v_tab_des           VARCHAR2(30);
    v_tot_tab_des       INT := 0;
    v_tot_tab_ori       INT := 0;
    v_tot_incr          INT;
    v_fe_min            DATE; 
    v_fe_max            DATE;
    v_return            CHAR(1);
    v_ca_totl_tabl_inte INT :=0;
    v_ca_totl_tbdi_inte INT :=0;
    v_ca_totl_no_migr   INT :=0; 
    v_ca_totl_repr      INT :=0; 
    v_de_obs            VARCHAR2(500) := \\'Sin Observaciones\\';
    v_cant_ejec         NUMBER(38,0);
    v_retorno           CHAR(1) := \\'1\\';
    v_resul             VARCHAR2(500);
    v_id_deta_carg_regi NUMBER;    
    PROJ_KEY_MAX NUMBER := 0;
    PROJ_KEY_CURRVAL NUMBER := 0;
    PROJ_KEY_MAX_SEQ NUMBER := 0;
    -- Cursor 1
    CURSOR cursor_1 IS
                SELECT DISTINCT
                      d.NU_DIRE_VIA
                    , d.DE_REFE_DIRE
                    , d.ID_VIA
                    , d.ID_ZONA
                    , d.ID_AREA_GEOG
                    , d.NU_INTE_DIRE
                    , d.NU_LOTE_DIRE
                    , d.NU_MANZ_DIRE
                    , d.NU_KILO_DIRE
                    , d.NU_DEPA_DIRE            
                FROM EQVSYS.TMP_EMPL_MAE_DIR_PRI1 d  
                LEFT JOIN bdisys.mae_dire md ON
                                md.ID_VIA = d.ID_VIA
                            AND md.ID_ZONA = d.ID_ZONA
                            AND md.ID_AREA_GEOG = d.ID_AREA_GEOG
                            AND NVL(UPPER(TRIM(md.NU_DIRE_VIA)),\\'-\\')  = NVL(UPPER(TRIM(d.NU_DIRE_VIA)),\\'-\\') 
                            AND NVL(UPPER(TRIM(md.NU_MANZ_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.NU_MANZ_DIRE)),\\'-\\')
                            AND NVL(UPPER(TRIM(md.NU_LOTE_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.NU_LOTE_DIRE)),\\'-\\')
                            AND NVL(UPPER(TRIM(md.NU_KILO_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.NU_KILO_DIRE)),\\'-\\')
                            AND NVL(UPPER(TRIM(md.NU_DEPA_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.NU_DEPA_DIRE)),\\'-\\')               
                            AND NVL(UPPER(TRIM(md.NU_INTE_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.NU_INTE_DIRE)),\\'-\\')     
                            AND NVL(UPPER(TRIM(md.DE_REFE_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.DE_REFE_DIRE)),\\'-\\')
                            AND md.IN_ACTI = 1
                WHERE md.ID_DIRE IS NULL;

    BEGIN        
    -- Sincronización y obtención de la secuencia para ID_SEDE AL INICIO
    SELECT BDISYS.SQ_MAE_DIRE_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_DIRE), 0) INTO PROJ_KEY_MAX FROM BDISYS.MAE_DIRE;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_MAE_DIRE_1 INCREMENT BY \\' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_MAE_DIRE_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_MAE_DIRE_1 INCREMENT BY 1\\';
    
    --Control de Carga
    --1. Setear tabla origen y destino.
    v_tab_ori := \\'T3726PADRUC\\';
    v_tab_des := \\'MAE_DIRE\\';
    --2. Obtener el id de control de carga
    SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA
      INTO v_id_crg, v_id_det
    FROM (
        SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_CNFG_PROC_CARG,
               ROW_NUMBER() OVER (ORDER BY ID_CTRL_PROC_CARG_DETA DESC) AS rn
        FROM EQVSYS.TMP_AUX_CTRL_PROC_CARG_DETA
        WHERE ID_CNFG_PROC_CARG =
              (SELECT ID_CNFG_PROC_CARG
                 FROM REPBDISYS.AUX_CONF_PROC_CARG@DBL_BDQA19G7_REPBDISYS
                WHERE ID_TABLA_ORIGEN =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_ori
                          AND IN_ACTI = \\'1\\')
                  AND ID_TABLA_DESTINO =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_des
                          AND IN_ACTI = \\'1\\'))
    )
    WHERE rn = 1;

    --3. Actualizar el estado de detalle de control de carga en estado 3 (en proceso)
    UPDATE REPBDISYS.AUX_CTRL_PROC_CARG_DETA@DBL_BDQA19G7_REPBDISYS
       SET IN_ESTA_PROC_DETA = \\'3\\',
           ID_USUA_MODI = C_ID_USUA_CREA,
           FE_USUA_MODI = SYSDATE,
           DE_TERM_MODI = C_DE_TERM_CREA
     WHERE ID_CTRL_PROC_CARG_DETA = v_id_det;
    --2. Total Incremental
    SELECT COUNT(1) INTO v_tot_incr FROM EQVSYS.TMP_PADRUC; 
    --3. Total de tabla destino.
    SELECT COUNT(1) INTO v_tot_tab_des FROM BDISYS.MAE_DIRE WHERE IN_ACTI=\\'1\\'; 
    --4. Total tabla origen
    SELECT COUNT(1) INTO v_tot_tab_ori FROM STGNETISYS.T3726PADRUC@DBL_BDQA11G2_STGNETISYS;
    --5. Registrar en eventos el inicio del proceso
    v_de_evto := \\'Inicia Carga Direcciones\\'; 
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA); 
    COMMIT;             
    --8. Obtenemos cantidad total de registros en la tabla intermedia de trabajo.
    SELECT COUNT(1) INTO v_ca_totl_tabl_inte FROM EQVSYS.TMP_EMPL_MAE_DIR_PRI1;
    --9. Obtenemos cantidad total de empleadores con RUC 11 en la tabla intermedia de BDI.
    v_ca_totl_tbdi_inte := 0;   
    --10. Obtener contador de registros que se actualizaron.
    v_un_totl_actu := 0;        
    -- Procesar Cursor 3    
    OPEN cursor_1;
    LOOP
        FETCH cursor_1 INTO  v_nu_dire_via, v_de_refe_dire, v_id_via, v_id_zona, v_id_area_geog, v_nu_inte_dire, v_nu_lote_dire, v_nu_manz_dire, v_nu_kilo_dire, v_nu_depa_dire;
        EXIT WHEN cursor_1%NOTFOUND;
        
        SELECT BDISYS.SQ_MAE_DIRE_1.NEXTVAL INTO v_id_dire FROM DUAL;
        -- Insertar registros en MAE_DIRE
        BEGIN
            INSERT INTO bdisys.MAE_DIRE (id_dire, nu_dire_via, de_refe_dire, id_via, id_zona, id_area_geog, nu_inte_dire, nu_lote_dire, nu_manz_dire, nu_kilo_dire, nu_depa_dire, in_acti, id_usua_crea, fe_usua_crea, de_term_crea)
            VALUES (v_id_dire, v_nu_dire_via,  v_de_refe_dire, v_id_via, v_id_zona, v_id_area_geog, v_nu_inte_dire, v_nu_lote_dire, v_nu_manz_dire, v_nu_kilo_dire, v_nu_depa_dire, \\'1\\', \\'INI-2842\\', SYSDATE, \\'1.1.1.1\\');
            DBMS_OUTPUT.PUT_LINE(\\'v_id_dire: \\' || v_id_dire || \\'----\\' );
            --Registrar las sedes principales para el control de carga
            REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_DETA_CARG_POR_REGI@DBL_BDQA19G7_REPBDISYS(v_id_det, SUBSTR(\\'Id Via: \\'||v_id_via || \\'|| Id Dire: \\'||v_id_dire,1,50),  SUBSTR(\\'nu_dire_via: \\' ||v_nu_dire_via ||  \\'|| de_refe_dire:\\' || v_de_refe_dire,1,50),  \\'INS\\', C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_deta_carg_regi, v_resul); 
            --11. Obtener contador de registros que se insertaron.
            v_un_totl_ingr := v_un_totl_ingr + 1;            
        EXCEPTION
            WHEN OTHERS THEN
                DBMS_OUTPUT.PUT_LINE(\\'Error en : \\' || v_id_via || \\'-----\\' || SQLERRM);
                --12. Contador de registros que se observaron.
                v_un_totl_obse := v_un_totl_obse + 1;
                v_de_obs := \\'Error en : \\' || v_id_via || \\'-\\' || SQLERRM;
                REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_LOG_ERRO_ALER@DBL_BDQA19G7_REPBDISYS(v_id_det, SUBSTR(\\'Id Via: \\'||v_id_via || \\'|| Id Dire: \\'||v_id_dire,1,50),  SUBSTR(\\'nu_dire_via: \\' ||v_nu_dire_via ||  \\'|| de_refe_dire:\\' || v_de_refe_dire,1,50),  v_de_obs, C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_aux_log_erro_aler, v_resul);                
        END;
    END LOOP;
    CLOSE cursor_1;
    --13. Obtener contador de registros que se eliminaron.
    v_un_totl_elim := 0;
    --14. Contador de registros que no se aplicó ninguna acción.
    v_un_totl_ning := 0;
    --15. Calcular la cantidad migrados
    v_ca_totl_migr := v_un_totl_actu + v_un_totl_ingr + v_un_totl_elim + v_un_totl_obse;  
    --16. Obtengo el total de match
    v_ca_totl_match   := v_un_totl_actu;
    --17. Obtengo el total de no match
    v_ca_totl_nomatch := v_un_totl_ingr;
    --18. Actualizar los totales en el detalle de control de carga.
    IF v_un_totl_obse > 0 THEN 
      v_de_obs := \\'Con Observaciones\\'; 
      v_in_esta_proc_deta := \\'0\\';
      -- Estado de proceso del detalle de carga 
      --0: Terminado con incidencias 
      --1: Terminado exitoso 
      --2: Pendiente 
      --3: En proceso
    END IF;   
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_ACT_PRC_CRG_DETA@DBL_BDQA19G7_REPBDISYS(v_id_crg,v_tab_ori,v_tab_des,v_ca_totl_migr,v_un_totl_actu,v_un_totl_ingr,v_un_totl_elim,v_un_totl_obse, v_un_totl_ning, v_in_esta_proc_deta,v_st_veri,v_ca_totl_no_migr,v_ca_totl_repr,v_in_tipo_detalle,v_ca_totl_tabl_inte,v_ca_totl_tbdi_inte,v_ca_totl_match,v_ca_totl_nomatch,v_de_obs,C_ID_USUA_CREA,C_DE_TERM_CREA,v_cant_ejec, v_retorno); 
    --20. Detalle finalizado
    v_de_evto := \\'Finaliza carga Direcciones.\\'; 
    v_de_evto :=  v_de_evto || \\': \\' || v_cant_ejec;
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA);
    COMMIT;
    -- Sincronización y obtención de la secuencia para ID_SEDE AL FINAL
    SELECT BDISYS.SQ_MAE_DIRE_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_DIRE), 0) INTO PROJ_KEY_MAX FROM BDISYS.MAE_DIRE;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_MAE_DIRE_1 INCREMENT BY \\' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_MAE_DIRE_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE \\'ALTER SEQUENCE BDISYS.SQ_MAE_DIRE_1 INCREMENT BY 1\\';
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE(\\'Error: \\' || SQLERRM);
        ROLLBACK;
END;]]><ReadFromFileBeforeSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileBeforeSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LimitRows></Usage></Properties >'
-connector '{
   variant=\\'11\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-source 0 '{
      DSSQLType={IN_PARM=4}, 
      DSSchema=\\'record
         (
           IN_PARM\\:int32\\;
         )\\'
}'
   

## General options
[ident('ora_BDISYS_INS_MAE_DIR_PRI'); jobmon_ident('ora_BDISYS_INS_MAE_DIR_PRI')]
## Outputs
0> [modify (
  IN_PARM:not_nullable int32=IN_PARM;
keep
  IN_PARM;
)] 'ora_BDISYS_INS_MAE_DIR_PRI:lnk_ora_bdisys_mae_dir_pri.v'
;

#################################################################
#### STAGE: Peek_MAE_DIR
## Operator
peek
## Operator options
-nrecs 10
-name

## General options
[ident('Peek_MAE_DIR'); jobmon_ident('Peek_MAE_DIR')]
## Inputs
0< [] 'ora_BDISYS_INS_MAE_DIR_PRI:lnk_ora_bdisys_mae_dir_pri.v'
;


=+=+=+=
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "3"
      Category "\\Jobs\\FUENTES_EXTERNAS\\MIGRACION_NETI_EMPL\\AUXILIAR\\AUX_SEDE_PRINCIPAL"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V10S0|V10S1"
      StageXPos "144|528"
      StageYPos "96|96"
      StageTypes "CCustomStage.CC_GUI|CCustomStage"
      NextStageID "0"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "100"
      StageXSize "48|48"
      StageYSize "48|48"
      ContainerViewSizing "0052 0052 0719 0307 0000 0001 0008 0040"
      StageNames "ora_BDISYS_INS_MAE_DIR_PRI|Peek_MAE_DIR"
      StageTypeIDs "OracleConnectorPX|PxPeek"
      LinkNames "lnk_ora_bdisys_mae_dir_pri| "
      LinkHasMetaDatas "True| "
      LinkTypes "1| "
      LinkNamePositionXs "288| "
      LinkNamePositionYs "120| "
      TargetStageIDs "V10S1| "
      SourceStageEffectiveExecutionModes "2| "
      SourceStageRuntimeExecutionModes "2| "
      TargetStageEffectiveExecutionModes "2| "
      TargetStageRuntimeExecutionModes "2| "
      LinkIsSingleOperatorLookup "False| "
      LinkIsSortSequential "False| "
      LinkSortMode "0| "
      LinkPartColMode "1| "
      LinkSourcePinIDs "V10S0P1| "
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V10S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_BDISYS_INS_MAE_DIR_PRI"
      NextID "2"
      OutputPins "V10S0P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL modified='1' type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed='1' modified='1' type='string'><![CDATA[select 1 from dual]]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'><Table type='string'><![CDATA[dual]]></Table></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'><Column type='string'><![CDATA[defaulted_alias1,(null),dual]]></Column></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified='1' type='bool'><![CDATA[1]]><BeforeSQL modified='1' type='string'><![CDATA[--J007_INS_EMPL_DIR_PRI_0001
DECLARE
    -- Definición de variables
    v_id_dire           BDISYS.MAE_DIRE.ID_DIRE%TYPE;    
    v_nu_dire_via       BDISYS.MAE_DIRE.NU_DIRE_VIA%TYPE;    
    v_de_refe_dire      BDISYS.MAE_DIRE.DE_REFE_DIRE%TYPE;    
    v_id_via            BDISYS.MAE_DIRE.ID_VIA%TYPE;    
    v_id_zona           BDISYS.MAE_DIRE.ID_ZONA%TYPE;    
    v_id_area_geog      BDISYS.MAE_DIRE.ID_AREA_GEOG%TYPE;    
    v_nu_inte_dire      BDISYS.MAE_DIRE.NU_INTE_DIRE%TYPE;    
    v_nu_lote_dire      BDISYS.MAE_DIRE.NU_LOTE_DIRE%TYPE;    
    v_nu_manz_dire      BDISYS.MAE_DIRE.NU_MANZ_DIRE%TYPE;    
    v_nu_kilo_dire      BDISYS.MAE_DIRE.NU_KILO_DIRE%TYPE;    
    v_nu_depa_dire      BDISYS.MAE_DIRE.NU_DEPA_DIRE%TYPE;    
    v_id_aux_log_erro_aler NUMBER;
    C_ID_USUA_CREA  bdisys.aux_sede.id_usua_crea%TYPE := 'INI-2842';
    C_DE_TERM_CREA  bdisys.aux_sede.de_term_crea%TYPE := '1.1.1.1';
    v_id_crg         NUMBER(38,0);
    v_id_det         NUMBER(38,0);
    v_de_proc        VARCHAR2(300) := 'Carga Direcciones.';
    v_de_evto        VARCHAR2(300); 
    v_ca_totl_match   INT := 0; 
    v_ca_totl_nomatch INT := 0;
    v_ca_totl_migr    INT := 0;
    v_un_totl_actu    INT := 0;
    v_un_totl_ingr    INT := 0;
    v_un_totl_elim    INT := 0;
    v_un_totl_obse    INT := 0;
    v_un_totl_ning    INT := 0;
    v_in_tipo_detalle   CHAR(1) := '1'; -- Estado de proceso del detalle de carga 0: Terminado con incidencias 1: Terminado exitoso 2: Pendiente 3: En proceso
    v_in_esta_proc_deta CHAR(1) := '1'; -- Indicador de tipo de detalle. 1: incremental/rango/o inicial. 2: reproceso inmediato.
    v_st_veri           CHAR(1) := '1'; -- Estado de verificación del detalle de carga (0: sin verificar, 1: verificado, 2: pendiente).
    v_tab_ori           VARCHAR2(30);
    v_tab_des           VARCHAR2(30);
    v_tot_tab_des       INT := 0;
    v_tot_tab_ori       INT := 0;
    v_tot_incr          INT;
    v_fe_min            DATE; 
    v_fe_max            DATE;
    v_return            CHAR(1);
    v_ca_totl_tabl_inte INT :=0;
    v_ca_totl_tbdi_inte INT :=0;
    v_ca_totl_no_migr   INT :=0; 
    v_ca_totl_repr      INT :=0; 
    v_de_obs            VARCHAR2(500) := 'Sin Observaciones';
    v_cant_ejec         NUMBER(38,0);
    v_retorno           CHAR(1) := '1';
    v_resul             VARCHAR2(500);
    v_id_deta_carg_regi NUMBER;    
    PROJ_KEY_MAX NUMBER := 0;
    PROJ_KEY_CURRVAL NUMBER := 0;
    PROJ_KEY_MAX_SEQ NUMBER := 0;
    -- Cursor 1
    CURSOR cursor_1 IS
                SELECT DISTINCT
                      d.NU_DIRE_VIA
                    , d.DE_REFE_DIRE
                    , d.ID_VIA
                    , d.ID_ZONA
                    , d.ID_AREA_GEOG
                    , d.NU_INTE_DIRE
                    , d.NU_LOTE_DIRE
                    , d.NU_MANZ_DIRE
                    , d.NU_KILO_DIRE
                    , d.NU_DEPA_DIRE            
                FROM EQVSYS.TMP_EMPL_MAE_DIR_PRI1 d  
                LEFT JOIN bdisys.mae_dire md ON
                                md.ID_VIA = d.ID_VIA
                            AND md.ID_ZONA = d.ID_ZONA
                            AND md.ID_AREA_GEOG = d.ID_AREA_GEOG
                            AND NVL(UPPER(TRIM(md.NU_DIRE_VIA)),'-')  = NVL(UPPER(TRIM(d.NU_DIRE_VIA)),'-') 
                            AND NVL(UPPER(TRIM(md.NU_MANZ_DIRE)),'-') = NVL(UPPER(TRIM(d.NU_MANZ_DIRE)),'-')
                            AND NVL(UPPER(TRIM(md.NU_LOTE_DIRE)),'-') = NVL(UPPER(TRIM(d.NU_LOTE_DIRE)),'-')
                            AND NVL(UPPER(TRIM(md.NU_KILO_DIRE)),'-') = NVL(UPPER(TRIM(d.NU_KILO_DIRE)),'-')
                            AND NVL(UPPER(TRIM(md.NU_DEPA_DIRE)),'-') = NVL(UPPER(TRIM(d.NU_DEPA_DIRE)),'-')               
                            AND NVL(UPPER(TRIM(md.NU_INTE_DIRE)),'-') = NVL(UPPER(TRIM(d.NU_INTE_DIRE)),'-')     
                            AND NVL(UPPER(TRIM(md.DE_REFE_DIRE)),'-') = NVL(UPPER(TRIM(d.DE_REFE_DIRE)),'-')
                            AND md.IN_ACTI = 1
                WHERE md.ID_DIRE IS NULL;

    BEGIN        
    -- Sincronización y obtención de la secuencia para ID_SEDE AL INICIO
    SELECT BDISYS.SQ_MAE_DIRE_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_DIRE), 0) INTO PROJ_KEY_MAX FROM BDISYS.MAE_DIRE;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_MAE_DIRE_1 INCREMENT BY ' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_MAE_DIRE_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_MAE_DIRE_1 INCREMENT BY 1';
    
    --Control de Carga
    --1. Setear tabla origen y destino.
    v_tab_ori := 'T3726PADRUC';
    v_tab_des := 'MAE_DIRE';
    --2. Obtener el id de control de carga
    SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA
      INTO v_id_crg, v_id_det
    FROM (
        SELECT ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_CNFG_PROC_CARG,
               ROW_NUMBER() OVER (ORDER BY ID_CTRL_PROC_CARG_DETA DESC) AS rn
        FROM EQVSYS.TMP_AUX_CTRL_PROC_CARG_DETA
        WHERE ID_CNFG_PROC_CARG =
              (SELECT ID_CNFG_PROC_CARG
                 FROM REPBDISYS.AUX_CONF_PROC_CARG@DBL_BDQA19G7_REPBDISYS
                WHERE ID_TABLA_ORIGEN =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_ori
                          AND IN_ACTI = '1')
                  AND ID_TABLA_DESTINO =
                      (SELECT ID_TABLA
                         FROM REPBDISYS.CAT_TABLA@DBL_BDQA19G7_REPBDISYS
                        WHERE DE_TABLA = v_tab_des
                          AND IN_ACTI = '1'))
    )
    WHERE rn = 1;

    --3. Actualizar el estado de detalle de control de carga en estado 3 (en proceso)
    UPDATE REPBDISYS.AUX_CTRL_PROC_CARG_DETA@DBL_BDQA19G7_REPBDISYS
       SET IN_ESTA_PROC_DETA = '3',
           ID_USUA_MODI = C_ID_USUA_CREA,
           FE_USUA_MODI = SYSDATE,
           DE_TERM_MODI = C_DE_TERM_CREA
     WHERE ID_CTRL_PROC_CARG_DETA = v_id_det;
    --2. Total Incremental
    SELECT COUNT(1) INTO v_tot_incr FROM EQVSYS.TMP_PADRUC; 
    --3. Total de tabla destino.
    SELECT COUNT(1) INTO v_tot_tab_des FROM BDISYS.MAE_DIRE WHERE IN_ACTI='1'; 
    --4. Total tabla origen
    SELECT COUNT(1) INTO v_tot_tab_ori FROM STGNETISYS.T3726PADRUC@DBL_BDQA11G2_STGNETISYS;
    --5. Registrar en eventos el inicio del proceso
    v_de_evto := 'Inicia Carga Direcciones'; 
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA); 
    COMMIT;             
    --8. Obtenemos cantidad total de registros en la tabla intermedia de trabajo.
    SELECT COUNT(1) INTO v_ca_totl_tabl_inte FROM EQVSYS.TMP_EMPL_MAE_DIR_PRI1;
    --9. Obtenemos cantidad total de empleadores con RUC 11 en la tabla intermedia de BDI.
    v_ca_totl_tbdi_inte := 0;   
    --10. Obtener contador de registros que se actualizaron.
    v_un_totl_actu := 0;        
    -- Procesar Cursor 3    
    OPEN cursor_1;
    LOOP
        FETCH cursor_1 INTO  v_nu_dire_via, v_de_refe_dire, v_id_via, v_id_zona, v_id_area_geog, v_nu_inte_dire, v_nu_lote_dire, v_nu_manz_dire, v_nu_kilo_dire, v_nu_depa_dire;
        EXIT WHEN cursor_1%NOTFOUND;
        
        SELECT BDISYS.SQ_MAE_DIRE_1.NEXTVAL INTO v_id_dire FROM DUAL;
        -- Insertar registros en MAE_DIRE
        BEGIN
            INSERT INTO bdisys.MAE_DIRE (id_dire, nu_dire_via, de_refe_dire, id_via, id_zona, id_area_geog, nu_inte_dire, nu_lote_dire, nu_manz_dire, nu_kilo_dire, nu_depa_dire, in_acti, id_usua_crea, fe_usua_crea, de_term_crea)
            VALUES (v_id_dire, v_nu_dire_via,  v_de_refe_dire, v_id_via, v_id_zona, v_id_area_geog, v_nu_inte_dire, v_nu_lote_dire, v_nu_manz_dire, v_nu_kilo_dire, v_nu_depa_dire, '1', 'INI-2842', SYSDATE, '1.1.1.1');
            DBMS_OUTPUT.PUT_LINE('v_id_dire: ' || v_id_dire || '----' );
            --Registrar las sedes principales para el control de carga
            REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_DETA_CARG_POR_REGI@DBL_BDQA19G7_REPBDISYS(v_id_det, SUBSTR('Id Via: '||v_id_via || '|| Id Dire: '||v_id_dire,1,50),  SUBSTR('nu_dire_via: ' ||v_nu_dire_via ||  '|| de_refe_dire:' || v_de_refe_dire,1,50),  'INS', C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_deta_carg_regi, v_resul); 
            --11. Obtener contador de registros que se insertaron.
            v_un_totl_ingr := v_un_totl_ingr + 1;            
        EXCEPTION
            WHEN OTHERS THEN
                DBMS_OUTPUT.PUT_LINE('Error en : ' || v_id_via || '-----' || SQLERRM);
                --12. Contador de registros que se observaron.
                v_un_totl_obse := v_un_totl_obse + 1;
                v_de_obs := 'Error en : ' || v_id_via || '-' || SQLERRM;
                REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_INSERTAR_LOG_ERRO_ALER@DBL_BDQA19G7_REPBDISYS(v_id_det, SUBSTR('Id Via: '||v_id_via || '|| Id Dire: '||v_id_dire,1,50),  SUBSTR('nu_dire_via: ' ||v_nu_dire_via ||  '|| de_refe_dire:' || v_de_refe_dire,1,50),  v_de_obs, C_ID_USUA_CREA, C_DE_TERM_CREA, v_id_aux_log_erro_aler, v_resul);                
        END;
    END LOOP;
    CLOSE cursor_1;
    --13. Obtener contador de registros que se eliminaron.
    v_un_totl_elim := 0;
    --14. Contador de registros que no se aplicó ninguna acción.
    v_un_totl_ning := 0;
    --15. Calcular la cantidad migrados
    v_ca_totl_migr := v_un_totl_actu + v_un_totl_ingr + v_un_totl_elim + v_un_totl_obse;  
    --16. Obtengo el total de match
    v_ca_totl_match   := v_un_totl_actu;
    --17. Obtengo el total de no match
    v_ca_totl_nomatch := v_un_totl_ingr;
    --18. Actualizar los totales en el detalle de control de carga.
    IF v_un_totl_obse > 0 THEN 
      v_de_obs := 'Con Observaciones'; 
      v_in_esta_proc_deta := '0';
      -- Estado de proceso del detalle de carga 
      --0: Terminado con incidencias 
      --1: Terminado exitoso 
      --2: Pendiente 
      --3: En proceso
    END IF;   
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_ACT_PRC_CRG_DETA@DBL_BDQA19G7_REPBDISYS(v_id_crg,v_tab_ori,v_tab_des,v_ca_totl_migr,v_un_totl_actu,v_un_totl_ingr,v_un_totl_elim,v_un_totl_obse, v_un_totl_ning, v_in_esta_proc_deta,v_st_veri,v_ca_totl_no_migr,v_ca_totl_repr,v_in_tipo_detalle,v_ca_totl_tabl_inte,v_ca_totl_tbdi_inte,v_ca_totl_match,v_ca_totl_nomatch,v_de_obs,C_ID_USUA_CREA,C_DE_TERM_CREA,v_cant_ejec, v_retorno); 
    --20. Detalle finalizado
    v_de_evto := 'Finaliza carga Direcciones.'; 
    v_de_evto :=  v_de_evto || ': ' || v_cant_ejec;
    REPBDISYS.PKG_EMPL_PRC_CRG_INCR.SP_EMPL_INS_PRC_CRG_BITA_EVEN@DBL_BDQA19G7_REPBDISYS(v_id_crg, v_id_det, v_de_proc, v_de_evto, C_ID_USUA_CREA, C_DE_TERM_CREA);
    COMMIT;
    -- Sincronización y obtención de la secuencia para ID_SEDE AL FINAL
    SELECT BDISYS.SQ_MAE_DIRE_1.NEXTVAL INTO PROJ_KEY_MAX_SEQ FROM DUAL;
    SELECT NVL(MAX(ID_DIRE), 0) INTO PROJ_KEY_MAX FROM BDISYS.MAE_DIRE;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_MAE_DIRE_1 INCREMENT BY ' || (PROJ_KEY_MAX - PROJ_KEY_MAX_SEQ);
    SELECT BDISYS.SQ_MAE_DIRE_1.NEXTVAL INTO PROJ_KEY_CURRVAL FROM DUAL;
    EXECUTE IMMEDIATE 'ALTER SEQUENCE BDISYS.SQ_MAE_DIRE_1 INCREMENT BY 1';
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
        ROLLBACK;
END;]]><ReadFromFileBeforeSQL type='bool'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type='string'><![CDATA[]]><ReadFromFileAfterSQL type='bool'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type='string'><![CDATA[]]><ReadFromFileBeforeSQLNode type='bool'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type='string'><![CDATA[]]><ReadFromFileAfterSQLNode type='bool'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V10S0P1"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "lnk_ora_bdisys_mae_dir_pri"
      Partner "V10S1|V10S1P1"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "IN_PARM"
         SqlType "4"
         Precision "0"
         Scale "0"
         Nullable "0"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      LeftTextPos "288"
      TopTextPos "120"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V10S1"
      OLEType "CCustomStage"
      Readonly "0"
      Name "Peek_MAE_DIR"
      NextID "2"
      InputPins "V10S1P1"
      StageType "PxPeek"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "all"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "nrecs"
         Value "10"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "dataset"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "name"
         Value "name"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "columns"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "selection"
         Value " "
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V10S1P1"
      OLEType "CCustomInput"
      Readonly "0"
      Name "lnk_ora_bdisys_mae_dir_pri"
      Partner "V10S0|V10S0P1"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
END DSJOB
BEGIN DSJOB
   Identifier "J008_TRN_EMPL_MAE_DIR_PRI_0002"
   DateModified "2025-04-29"
   TimeModified "16.24.50"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "CJobDefn"
      Readonly "0"
      Name "J008_TRN_EMPL_MAE_DIR_PRI_0002"
      NextID "6"
      Container "V0"
      JobVersion "56.0.0"
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Prompt "PRM_ORA_CONE_MAE_EMPL parameters"
         Default "(As pre-defined)"
         HelpTxt "Parámetro que contiene parametros de conexion para NETI"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceMode"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSeq"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceRecords"
         Value "100"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSkip"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TracePeriod"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RecordJobPerformanceData"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "IdentList"
         Value "ora_EQVSYS2_TMP_EMPL_MAE_DIR_PRI1|ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI2"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "ClientCodePage"
         Value "1252"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      OrchestrateCode =+=+=+=
#################################################################
#### STAGE: ora_EQVSYS2_TMP_EMPL_MAE_DIR_PRI1
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>1</Context><Variant type=\\'string\\'>11g</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type=\\'int\\'><![CDATA[0]]></ReadMode><GenerateSQL type=\\'bool\\'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement modified=\\'1\\' type=\\'string\\'><![CDATA[               --OBTENIENDO LOS ID_DIRE CORRESPONDIENTES A CADA REGISTRO, TOMANDO EL DE MAYOR FECHA DE CREACION O MODIFICACION.
               SELECT reg_dire_part,ID_DIRE, ID_PERS, NUM_RUC, DES_NUMLIC, FEC_ACTREG_SUNA, FECHA_MODI_CREA  FROM (
                SELECT  --5216  Filas                    
                      ROW_NUMBER() over (Partition By md.ID_VIA 
                             ,md.ID_ZONA 
                             ,md.ID_AREA_GEOG
                             ,NVL(UPPER(TRIM(md.NU_DIRE_VIA)),\\'-\\')
                             ,NVL(UPPER(TRIM(md.NU_MANZ_DIRE)),\\'-\\')
                             ,NVL(UPPER(TRIM(md.NU_LOTE_DIRE)),\\'-\\')
                             ,NVL(UPPER(TRIM(md.NU_KILO_DIRE)),\\'-\\')
                             ,NVL(UPPER(TRIM(md.NU_DEPA_DIRE)),\\'-\\')
                             ,NVL(UPPER(TRIM(md.NU_INTE_DIRE)),\\'-\\')
                             ,NVL(UPPER(TRIM(md.DE_REFE_DIRE)),\\'-\\') 
                             ,d.ID_PERS
                             ORDER BY NVL (md.FE_USUA_MODI, md.FE_USUA_CREA)DESC ) reg_dire_part
                    , md.ID_DIRE
                    --, md.FE_USUA_MODI
                    --, md.FE_USUA_CREA
                    , NVL (md.FE_USUA_MODI, md.FE_USUA_CREA) FECHA_MODI_CREA
                    , d.ID_PERS
                    , d.NUM_RUC
                    , d.DES_NUMLIC
                    , d.FEC_ACTREG_SUNA
                    --, d.NU_DIRE_VIA
                    --, d.DE_REFE_DIRE
                    --, d.ID_VIA
                    --, d.ID_ZONA
                    --, d.ID_AREA_GEOG
                    --, d.NU_INTE_DIRE
                    --, d.NU_LOTE_DIRE
                    --, d.NU_MANZ_DIRE
                    --, d.NU_KILO_DIRE
                    --, d.NU_DEPA_DIRE            
                FROM EQVSYS.TMP_EMPL_MAE_DIR_PRI1 d  
                INNER JOIN bdisys.mae_dire md ON
                                md.ID_VIA = d.ID_VIA
                            AND md.ID_ZONA = d.ID_ZONA
                            AND md.ID_AREA_GEOG = d.ID_AREA_GEOG
                            AND NVL(UPPER(TRIM(md.NU_DIRE_VIA)),\\'-\\')  = NVL(UPPER(TRIM(d.NU_DIRE_VIA)),\\'-\\') 
                            AND NVL(UPPER(TRIM(md.NU_MANZ_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.NU_MANZ_DIRE)),\\'-\\')
                            AND NVL(UPPER(TRIM(md.NU_LOTE_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.NU_LOTE_DIRE)),\\'-\\')
                            AND NVL(UPPER(TRIM(md.NU_KILO_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.NU_KILO_DIRE)),\\'-\\')
                            AND NVL(UPPER(TRIM(md.NU_DEPA_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.NU_DEPA_DIRE)),\\'-\\')               
                            AND NVL(UPPER(TRIM(md.NU_INTE_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.NU_INTE_DIRE)),\\'-\\')     
                            AND NVL(UPPER(TRIM(md.DE_REFE_DIRE)),\\'-\\') = NVL(UPPER(TRIM(d.DE_REFE_DIRE)),\\'-\\')
                            AND md.IN_ACTI = 1  --5278  Filas
           )t1 where reg_dire_part = 1 --5216  Filas
   ]]><ReadFromFileSelect type=\\'bool\\'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed=\\'1\\'></Tables><Parameters collapsed=\\'1\\'></Parameters><Columns collapsed=\\'1\\'></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount><EndOfWave type=\\'int\\'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><PrefetchRowCount type=\\'int\\'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type=\\'int\\'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type=\\'bool\\'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type=\\'bool\\'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]><BeforeSQL modified=\\'1\\' type=\\'string\\'><![CDATA[DECLARE
  C_CUENTA NUMBER :=  0;
BEGIN 
--------------------------------------------------------------------------------------------------------------
--1--CREAR LA TABLA TMP TMP_EMPL_MAE_DIR_PRI2 CONTIENE LOS ID DE DIRECCIONES QUE SE VINCULARAN A LAS SEDES PRINCIPALES --
--------------------------------------------------------------------------------------------------------------
SELECT NVL(COUNT(1),0) INTO C_CUENTA FROM ALL_TABLES 
WHERE OWNER = \\'EQVSYS\\' AND TABLE_NAME = \\'TMP_EMPL_MAE_DIR_PRI2\\';
IF C_CUENTA > 0 THEN
    EXECUTE IMMEDIATE \\'DROP TABLE EQVSYS.TMP_EMPL_MAE_DIR_PRI2 PURGE\\';
END IF;
EXECUTE IMMEDIATE  \\'CREATE TABLE EQVSYS.TMP_EMPL_MAE_DIR_PRI2 
                  (   
                    reg_dire_part		INTEGER,
                    ID_DIRE		        NUMBER(38,0)  not null,  
                    ID_PERS             NUMBER(38,0)  not null,
                    NUM_RUC             CHAR(11),
                    DES_NUMLIC          VARCHAR(20),
                    FEC_ACTREG_SUNA	    DATE,
                    FE_USUA_MODI_CREA   DATE               
                  )\\';
 END;]]><ReadFromFileBeforeSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileBeforeSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LimitRows></Usage></Properties >'
-connector '{
   variant=\\'11g\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:"11g":ccora11g;12:"12c":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-source 0 '{
      DSSQLType={reg_dire_part=4, ID_DIRE=2, ID_PERS=2, NUM_RUC=1, DES_NUMLIC=12, FEC_ACTREG_SUNA=9, FE_USUA_MODI_CREA=9}, 
      DSSQLPrecision={ID_DIRE=38, ID_PERS=38, NUM_RUC=11, DES_NUMLIC=20}, 
      DSSchema=\\'record
         (
           reg_dire_part\\:nullable int32\\;
           ID_DIRE\\:nullable decimal\\[38\\,0\\]\\;
           ID_PERS\\:nullable decimal\\[38\\,0\\]\\;
           NUM_RUC\\:nullable string\\[11\\]\\;
           DES_NUMLIC\\:nullable string\\[max\\=20\\]\\;
           FEC_ACTREG_SUNA\\:nullable date\\;
           FE_USUA_MODI_CREA\\:nullable date\\;
         )\\'
}'
   

## General options
[ident('ora_EQVSYS2_TMP_EMPL_MAE_DIR_PRI1'); jobmon_ident('ora_EQVSYS2_TMP_EMPL_MAE_DIR_PRI1')]
## Outputs
0> [modify (
  reg_dire_part:nullable int32=reg_dire_part;
  ID_DIRE:nullable decimal[38,0]=ID_DIRE;
  ID_PERS:nullable decimal[38,0]=ID_PERS;
  NUM_RUC:nullable string[11]=NUM_RUC;
  DES_NUMLIC:nullable string[max=20]=DES_NUMLIC;
  FEC_ACTREG_SUNA:nullable date=FEC_ACTREG_SUNA;
  FE_USUA_MODI_CREA:nullable date=FE_USUA_MODI_CREA;
keep
  reg_dire_part,ID_DIRE,ID_PERS,NUM_RUC,
  DES_NUMLIC,FEC_ACTREG_SUNA,FE_USUA_MODI_CREA;
)] 'ora_EQVSYS2_TMP_EMPL_MAE_DIR_PRI1:DSLink2_mae_dir.v'
;

#################################################################
#### STAGE: ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI2
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>2</Context><Variant type=\\'string\\'>11</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><WriteMode type=\\'int\\'><![CDATA[0]]></WriteMode><GenerateSQL modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]></GenerateSQL><TableName modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_ES"].TMP_EMPL_MAE_DIR_PRI2]]><TableScope type=\\'int\\'><![CDATA[0]]></TableScope></TableName><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL></SQL><TableAction modified=\\'1\\' type=\\'int\\'><![CDATA[3]]><GenerateTruncateStatement type=\\'bool\\'><![CDATA[1]]><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></GenerateTruncateStatement><TableActionFirst type=\\'bool\\'><![CDATA[1]]></TableActionFirst></TableAction><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><DropUnmatchedFields type=\\'bool\\'><![CDATA[0]]></DropUnmatchedFields><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><PreserveTrailingBlanks type=\\'bool\\'><![CDATA[1]]></PreserveTrailingBlanks><FailOnRowErrorPX type=\\'bool\\'><![CDATA[1]]></FailOnRowErrorPX></Session><Logging><LogColumnValues collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LogColumnValues></Logging><BeforeAfter collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><Reconnect collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></Reconnect><Disconnect collapsed=\\'1\\' type=\\'int\\'><![CDATA[0]]></Disconnect></Usage></Properties >'
-connector '{
   variant=\\'11\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:"11g":ccora11g;12:"12c":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-target 0 '{
      DSSQLType={reg_dire_part=4, ID_DIRE=2, ID_PERS=2, NUM_RUC=1, DES_NUMLIC=12, FEC_ACTREG_SUNA=9, FE_USUA_MODI_CREA=9}, 
      DSSQLPrecision={ID_DIRE=38, ID_PERS=38, NUM_RUC=11, DES_NUMLIC=20}, 
      DSSchema=\\'record
         (
           reg_dire_part\\:nullable int32\\;
           ID_DIRE\\:nullable decimal\\[38\\,0\\]\\;
           ID_PERS\\:nullable decimal\\[38\\,0\\]\\;
           NUM_RUC\\:nullable string\\[11\\]\\;
           DES_NUMLIC\\:nullable string\\[max\\=20\\]\\;
           FEC_ACTREG_SUNA\\:nullable date\\;
           FE_USUA_MODI_CREA\\:nullable date\\;
         )\\'
}'
   

## General options
[ident('ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI2'); jobmon_ident('ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI2')]
## Inputs
0< [] 'ora_EQVSYS2_TMP_EMPL_MAE_DIR_PRI1:DSLink2_mae_dir.v'
;


=+=+=+=
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "3"
      Category "\\Jobs\\FUENTES_EXTERNAS\\MIGRACION_NETI_EMPL\\AUXILIAR\\AUX_SEDE_PRINCIPAL"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V5S0|V5S1"
      StageXPos "288|744"
      StageYPos "120|120"
      StageTypes "CCustomStage.CC_GUI|CCustomStage.CC_GUI"
      NextStageID "0"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "100"
      StageXSize "48|48"
      StageYSize "48|48"
      ContainerViewSizing "0000 0000 1150 0518 0000 0001 0160 0000"
      StageNames "ora_EQVSYS2_TMP_EMPL_MAE_DIR_PRI1|ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI2"
      StageTypeIDs "OracleConnectorPX|OracleConnectorPX"
      LinkNames "DSLink2_mae_dir| "
      LinkHasMetaDatas "True| "
      LinkTypes "1| "
      LinkNamePositionXs "458| "
      LinkNamePositionYs "144| "
      TargetStageIDs "V5S1| "
      SourceStageEffectiveExecutionModes "2| "
      SourceStageRuntimeExecutionModes "2| "
      TargetStageEffectiveExecutionModes "2| "
      TargetStageRuntimeExecutionModes "2| "
      LinkIsSingleOperatorLookup "False| "
      LinkIsSortSequential "False| "
      LinkSortMode "0| "
      LinkPartColMode "1| "
      LinkSourcePinIDs "V5S0P1| "
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V5S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_EQVSYS2_TMP_EMPL_MAE_DIR_PRI1"
      NextID "2"
      OutputPins "V5S0P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11g</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement modified='1' type='string'><![CDATA[               --OBTENIENDO LOS ID_DIRE CORRESPONDIENTES A CADA REGISTRO, TOMANDO EL DE MAYOR FECHA DE CREACION O MODIFICACION.
               SELECT reg_dire_part,ID_DIRE, ID_PERS, NUM_RUC, DES_NUMLIC, FEC_ACTREG_SUNA, FECHA_MODI_CREA  FROM (
                SELECT  --5216  Filas                    
                      ROW_NUMBER() over (Partition By md.ID_VIA 
                             ,md.ID_ZONA 
                             ,md.ID_AREA_GEOG
                             ,NVL(UPPER(TRIM(md.NU_DIRE_VIA)),'-')
                             ,NVL(UPPER(TRIM(md.NU_MANZ_DIRE)),'-')
                             ,NVL(UPPER(TRIM(md.NU_LOTE_DIRE)),'-')
                             ,NVL(UPPER(TRIM(md.NU_KILO_DIRE)),'-')
                             ,NVL(UPPER(TRIM(md.NU_DEPA_DIRE)),'-')
                             ,NVL(UPPER(TRIM(md.NU_INTE_DIRE)),'-')
                             ,NVL(UPPER(TRIM(md.DE_REFE_DIRE)),'-') 
                             ,d.ID_PERS
                             ORDER BY NVL (md.FE_USUA_MODI, md.FE_USUA_CREA)DESC ) reg_dire_part
                    , md.ID_DIRE
                    --, md.FE_USUA_MODI
                    --, md.FE_USUA_CREA
                    , NVL (md.FE_USUA_MODI, md.FE_USUA_CREA) FECHA_MODI_CREA
                    , d.ID_PERS
                    , d.NUM_RUC
                    , d.DES_NUMLIC
                    , d.FEC_ACTREG_SUNA
                    --, d.NU_DIRE_VIA
                    --, d.DE_REFE_DIRE
                    --, d.ID_VIA
                    --, d.ID_ZONA
                    --, d.ID_AREA_GEOG
                    --, d.NU_INTE_DIRE
                    --, d.NU_LOTE_DIRE
                    --, d.NU_MANZ_DIRE
                    --, d.NU_KILO_DIRE
                    --, d.NU_DEPA_DIRE            
                FROM EQVSYS.TMP_EMPL_MAE_DIR_PRI1 d  
                INNER JOIN bdisys.mae_dire md ON
                                md.ID_VIA = d.ID_VIA
                            AND md.ID_ZONA = d.ID_ZONA
                            AND md.ID_AREA_GEOG = d.ID_AREA_GEOG
                            AND NVL(UPPER(TRIM(md.NU_DIRE_VIA)),'-')  = NVL(UPPER(TRIM(d.NU_DIRE_VIA)),'-') 
                            AND NVL(UPPER(TRIM(md.NU_MANZ_DIRE)),'-') = NVL(UPPER(TRIM(d.NU_MANZ_DIRE)),'-')
                            AND NVL(UPPER(TRIM(md.NU_LOTE_DIRE)),'-') = NVL(UPPER(TRIM(d.NU_LOTE_DIRE)),'-')
                            AND NVL(UPPER(TRIM(md.NU_KILO_DIRE)),'-') = NVL(UPPER(TRIM(d.NU_KILO_DIRE)),'-')
                            AND NVL(UPPER(TRIM(md.NU_DEPA_DIRE)),'-') = NVL(UPPER(TRIM(d.NU_DEPA_DIRE)),'-')               
                            AND NVL(UPPER(TRIM(md.NU_INTE_DIRE)),'-') = NVL(UPPER(TRIM(d.NU_INTE_DIRE)),'-')     
                            AND NVL(UPPER(TRIM(md.DE_REFE_DIRE)),'-') = NVL(UPPER(TRIM(d.DE_REFE_DIRE)),'-')
                            AND md.IN_ACTI = 1  --5278  Filas
           )t1 where reg_dire_part = 1 --5216  Filas
   ]]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified='1' type='bool'><![CDATA[1]]><BeforeSQL modified='1' type='string'><![CDATA[DECLARE
  C_CUENTA NUMBER :=  0;
BEGIN 
--------------------------------------------------------------------------------------------------------------
--1--CREAR LA TABLA TMP TMP_EMPL_MAE_DIR_PRI2 CONTIENE LOS ID DE DIRECCIONES QUE SE VINCULARAN A LAS SEDES PRINCIPALES --
--------------------------------------------------------------------------------------------------------------
SELECT NVL(COUNT(1),0) INTO C_CUENTA FROM ALL_TABLES 
WHERE OWNER = 'EQVSYS' AND TABLE_NAME = 'TMP_EMPL_MAE_DIR_PRI2';
IF C_CUENTA > 0 THEN
    EXECUTE IMMEDIATE 'DROP TABLE EQVSYS.TMP_EMPL_MAE_DIR_PRI2 PURGE';
END IF;
EXECUTE IMMEDIATE  'CREATE TABLE EQVSYS.TMP_EMPL_MAE_DIR_PRI2 
                  (   
                    reg_dire_part		INTEGER,
                    ID_DIRE		        NUMBER(38,0)  not null,  
                    ID_PERS             NUMBER(38,0)  not null,
                    NUM_RUC             CHAR(11),
                    DES_NUMLIC          VARCHAR(20),
                    FEC_ACTREG_SUNA	    DATE,
                    FE_USUA_MODI_CREA   DATE               
                  )';
 END;]]><ReadFromFileBeforeSQL type='bool'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type='string'><![CDATA[]]><ReadFromFileAfterSQL type='bool'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type='string'><![CDATA[]]><ReadFromFileBeforeSQLNode type='bool'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type='string'><![CDATA[]]><ReadFromFileAfterSQLNode type='bool'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V5S0P1"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "DSLink2_mae_dir"
      Partner "V5S1|V5S1P1"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "reg_dire_part"
         SqlType "4"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_DIRE"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_PERS"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NUM_RUC"
         SqlType "1"
         Precision "11"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "DES_NUMLIC"
         SqlType "12"
         Precision "20"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "FEC_ACTREG_SUNA"
         SqlType "9"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "FE_USUA_MODI_CREA"
         SqlType "9"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      LeftTextPos "458"
      TopTextPos "144"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V5S1"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI2"
      NextID "2"
      InputPins "V5S1P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "target"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value "<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>2</Context><Variant type='string'>11</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><WriteMode type='int'><![CDATA[0]]></WriteMode><GenerateSQL modified='1' type='bool'><![CDATA[1]]></GenerateSQL><TableName modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_ES#.TMP_EMPL_MAE_DIR_PRI2]]><TableScope type='int'><![CDATA[0]]></TableScope></TableName><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL></SQL><TableAction modified='1' type='int'><![CDATA[3]]><GenerateTruncateStatement type='bool'><![CDATA[1]]><FailOnError type='bool'><![CDATA[1]]></FailOnError></GenerateTruncateStatement><TableActionFirst type='bool'><![CDATA[1]]></TableActionFirst></TableAction><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><DropUnmatchedFields type='bool'><![CDATA[0]]></DropUnmatchedFields><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><PreserveTrailingBlanks type='bool'><![CDATA[1]]></PreserveTrailingBlanks><FailOnRowErrorPX type='bool'><![CDATA[1]]></FailOnRowErrorPX></Session><Logging><LogColumnValues collapsed='1' type='bool'><![CDATA[0]]></LogColumnValues></Logging><BeforeAfter collapsed='1' type='bool'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><Reconnect collapsed='1' type='bool'><![CDATA[0]]></Reconnect><Disconnect collapsed='1' type='int'><![CDATA[0]]></Disconnect></Usage></Properties >"
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V5S1P1"
      OLEType "CCustomInput"
      Readonly "0"
      Name "DSLink2_mae_dir"
      Partner "V5S0|V5S0P1"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
END DSJOB
BEGIN DSJOB
   Identifier "J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001"
   DateModified "2025-05-22"
   TimeModified "14.04.00"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "CJobDefn"
      Readonly "0"
      Name "J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001"
      NextID "9"
      Container "V0"
      JobVersion "56.0.0"
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Prompt "PRM_ORA_CONE_MAE_EMPL parameters"
         Default "(As pre-defined)"
         HelpTxt "Parámetro que contiene parametros de conexion para NETI"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceMode"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSeq"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceRecords"
         Value "100"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSkip"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TracePeriod"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RecordJobPerformanceData"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "IdentList"
         Value "ora_EQVSYS_TMP_EMPL_REL_SEDE_DIR_PRI1|ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI1_X_SEDE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "ClientCodePage"
         Value "1252"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      OrchestrateCode =+=+=+=
#################################################################
#### STAGE: ora_EQVSYS_TMP_EMPL_REL_SEDE_DIR_PRI1
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>2</Context><Variant type=\\'string\\'>11</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><WriteMode type=\\'int\\'><![CDATA[0]]></WriteMode><GenerateSQL modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]></GenerateSQL><TableName modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_ES"].TMP_EMPL_REL_SEDE_DIRE_PRI1]]><TableScope type=\\'int\\'><![CDATA[0]]></TableScope></TableName><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL></SQL><TableAction modified=\\'1\\' type=\\'int\\'><![CDATA[3]]><GenerateTruncateStatement type=\\'bool\\'><![CDATA[1]]><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></GenerateTruncateStatement><TableActionFirst type=\\'bool\\'><![CDATA[1]]></TableActionFirst></TableAction><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><DropUnmatchedFields type=\\'bool\\'><![CDATA[0]]></DropUnmatchedFields><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><PreserveTrailingBlanks type=\\'bool\\'><![CDATA[1]]></PreserveTrailingBlanks><FailOnRowErrorPX type=\\'bool\\'><![CDATA[1]]></FailOnRowErrorPX></Session><Logging><LogColumnValues collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LogColumnValues></Logging><BeforeAfter collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><Reconnect collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></Reconnect><Disconnect collapsed=\\'1\\' type=\\'int\\'><![CDATA[0]]></Disconnect></Usage></Properties >'
-connector '{
   variant=\\'11\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:"11g":ccora11g;12:"12c":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-target 0 '{
      DSSQLType={REG_SEDE_PART=4, ID_PERS=2, NUM_RUC=1, ID_SEDE_N=2, ID_DIRE_N=2, FEC_ACTREG_SUNA=9, ID_SEDE_E=2, ID_DIRE_E=2}, 
      DSSQLPrecision={ID_PERS=38, NUM_RUC=11, ID_SEDE_N=38, ID_DIRE_N=38, ID_SEDE_E=38, ID_DIRE_E=38}, 
      DSSchema=\\'record
         (
           REG_SEDE_PART\\:nullable int32\\;
           ID_PERS\\:nullable decimal\\[38\\,0\\]\\;
           NUM_RUC\\:nullable string\\[11\\]\\;
           ID_SEDE_N\\:nullable decimal\\[38\\,0\\]\\;
           ID_DIRE_N\\:nullable decimal\\[38\\,0\\]\\;
           FEC_ACTREG_SUNA\\:nullable date\\;
           ID_SEDE_E\\:nullable decimal\\[38\\,0\\]\\;
           ID_DIRE_E\\:nullable decimal\\[38\\,0\\]\\;
         )\\'
}'
   

## General options
[ident('ora_EQVSYS_TMP_EMPL_REL_SEDE_DIR_PRI1'); jobmon_ident('ora_EQVSYS_TMP_EMPL_REL_SEDE_DIR_PRI1')]
## Inputs
0< [] 'ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI1_X_SEDE:DSLink_rel_sede_dir.v'
;

#################################################################
#### STAGE: ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI1_X_SEDE
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>1</Context><Variant type=\\'string\\'>11g</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type=\\'int\\'><![CDATA[0]]></ReadMode><GenerateSQL type=\\'bool\\'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement modified=\\'1\\' type=\\'string\\'><![CDATA[select s.REG_SEDE_PART
, s.ID_PERS
, s.NUM_RUC
, s.ID_SEDE ID_SEDE_N
, d.ID_DIRE ID_DIRE_N
, d.FEC_ACTREG_SUNA
, rsd.ID_SEDE ID_SEDE_E
, rsd.ID_DIRE ID_DIRE_E
--SELECT *  
from eqvsys.TMP_EMPL_AUX_SEDE_PRI2 s
inner join eqvsys.TMP_EMPL_MAE_DIR_PRI2 d on s.ID_PERS = d.ID_PERS AND s.REG_SEDE_PART = 1
left join bdisys.REL_SEDE_DIRE rsd ON rsd.ID_SEDE = s.ID_SEDE AND rsd.ID_DIRE = d.ID_DIRE and rsd.IN_ACTI = 1
where rsd.ID_SEDE is null;]]><ReadFromFileSelect type=\\'bool\\'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed=\\'1\\'></Tables><Parameters collapsed=\\'1\\'></Parameters><Columns collapsed=\\'1\\'></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount><EndOfWave type=\\'int\\'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><PrefetchRowCount type=\\'int\\'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type=\\'int\\'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type=\\'bool\\'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type=\\'bool\\'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]><BeforeSQL modified=\\'1\\' type=\\'string\\'><![CDATA[DECLARE
  C_CUENTA NUMBER :=  0;
BEGIN 
--------------------------------------------------------------------------------------------------------------
--1--CREAR LA TABLA TMP TMP_EMPL_REL_SEDE_DIRE_PRI1 CONTIENE LAS REL_SEDE_DIR CONSTRUIDAS A PARTIR DE 
----TMP_EMPL_AUX_SEDE_PRI2 Y TMP_EMPL_MAE_DIR_PRI2 QUE EXISTEN Y NO EXISTEN EN bdisys.REL_SEDE_DIRE
--------------------------------------------------------------------------------------------------------------
SELECT NVL(COUNT(1),0) INTO C_CUENTA FROM ALL_TABLES 
WHERE OWNER = \\'EQVSYS\\' AND TABLE_NAME = \\'TMP_EMPL_REL_SEDE_DIRE_PRI1\\';
IF C_CUENTA > 0 THEN
    EXECUTE IMMEDIATE \\'DROP TABLE EQVSYS.TMP_EMPL_REL_SEDE_DIRE_PRI1 PURGE\\';
END IF;
EXECUTE IMMEDIATE  \\'CREATE TABLE EQVSYS.TMP_EMPL_REL_SEDE_DIRE_PRI1 
                  (   
                    REG_SEDE_PART     INTEGER,
                    ID_PERS           INTEGER not null,
                    NUM_RUC           CHAR(11) not null,  
                    ID_SEDE_N         INTEGER,
                    ID_DIRE_N         INTEGER,
                    FEC_ACTREG_SUNA   DATE,
                    ID_SEDE_E         INTEGER,
                    ID_DIRE_E         INTEGER                    
                  )\\';
 END;
 
]]><ReadFromFileBeforeSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileBeforeSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LimitRows></Usage></Properties >'
-connector '{
   variant=\\'11g\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:"11g":ccora11g;12:"12c":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-source 0 '{
      DSSQLType={REG_SEDE_PART=4, ID_PERS=2, NUM_RUC=1, ID_SEDE_N=2, ID_DIRE_N=2, FEC_ACTREG_SUNA=9, ID_SEDE_E=2, ID_DIRE_E=2}, 
      DSSQLPrecision={ID_PERS=38, NUM_RUC=11, ID_SEDE_N=38, ID_DIRE_N=38, ID_SEDE_E=38, ID_DIRE_E=38}, 
      DSSchema=\\'record
         (
           REG_SEDE_PART\\:nullable int32\\;
           ID_PERS\\:nullable decimal\\[38\\,0\\]\\;
           NUM_RUC\\:nullable string\\[11\\]\\;
           ID_SEDE_N\\:nullable decimal\\[38\\,0\\]\\;
           ID_DIRE_N\\:nullable decimal\\[38\\,0\\]\\;
           FEC_ACTREG_SUNA\\:nullable date\\;
           ID_SEDE_E\\:nullable decimal\\[38\\,0\\]\\;
           ID_DIRE_E\\:nullable decimal\\[38\\,0\\]\\;
         )\\'
}'
   

## General options
[ident('ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI1_X_SEDE'); jobmon_ident('ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI1_X_SEDE')]
## Outputs
0> [modify (
  REG_SEDE_PART:nullable int32=REG_SEDE_PART;
  ID_PERS:nullable decimal[38,0]=ID_PERS;
  NUM_RUC:nullable string[11]=NUM_RUC;
  ID_SEDE_N:nullable decimal[38,0]=ID_SEDE_N;
  ID_DIRE_N:nullable decimal[38,0]=ID_DIRE_N;
  FEC_ACTREG_SUNA:nullable date=FEC_ACTREG_SUNA;
  ID_SEDE_E:nullable decimal[38,0]=ID_SEDE_E;
  ID_DIRE_E:nullable decimal[38,0]=ID_DIRE_E;
keep
  REG_SEDE_PART,ID_PERS,NUM_RUC,ID_SEDE_N,
  ID_DIRE_N,FEC_ACTREG_SUNA,ID_SEDE_E,ID_DIRE_E;
)] 'ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI1_X_SEDE:DSLink_rel_sede_dir.v'
;


=+=+=+=
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "3"
      Category "\\Jobs\\FUENTES_EXTERNAS\\MIGRACION_NETI_EMPL\\AUXILIAR\\AUX_SEDE_PRINCIPAL"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V8S0|V8S1"
      StageXPos "600|144"
      StageYPos "144|144"
      StageTypes "CCustomStage.CC_GUI|CCustomStage.CC_GUI"
      NextStageID "0"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "100"
      StageXSize "48|48"
      StageYSize "48|48"
      ContainerViewSizing "0000 0000 0675 0260 0000 0001 0000 0080"
      StageNames "ora_EQVSYS_TMP_EMPL_REL_SEDE_DIR_PRI1|ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI1_X_SEDE"
      StageTypeIDs "OracleConnectorPX|OracleConnectorPX"
      LinkNames " |DSLink_rel_sede_dir"
      LinkHasMetaDatas " |True"
      LinkTypes " |1"
      LinkNamePositionXs " |348"
      LinkNamePositionYs " |168"
      TargetStageIDs " |V8S0"
      SourceStageEffectiveExecutionModes " |2"
      SourceStageRuntimeExecutionModes " |2"
      TargetStageEffectiveExecutionModes " |2"
      TargetStageRuntimeExecutionModes " |2"
      LinkIsSingleOperatorLookup " |False"
      LinkIsSortSequential " |False"
      LinkSortMode " |0"
      LinkPartColMode " |1"
      LinkSourcePinIDs " |V8S1P1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V8S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_EQVSYS_TMP_EMPL_REL_SEDE_DIR_PRI1"
      NextID "2"
      InputPins "V8S0P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "target"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value "<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>2</Context><Variant type='string'>11</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><WriteMode type='int'><![CDATA[0]]></WriteMode><GenerateSQL modified='1' type='bool'><![CDATA[1]]></GenerateSQL><TableName modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_ES#.TMP_EMPL_REL_SEDE_DIRE_PRI1]]><TableScope type='int'><![CDATA[0]]></TableScope></TableName><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL></SQL><TableAction modified='1' type='int'><![CDATA[3]]><GenerateTruncateStatement type='bool'><![CDATA[1]]><FailOnError type='bool'><![CDATA[1]]></FailOnError></GenerateTruncateStatement><TableActionFirst type='bool'><![CDATA[1]]></TableActionFirst></TableAction><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><DropUnmatchedFields type='bool'><![CDATA[0]]></DropUnmatchedFields><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><PreserveTrailingBlanks type='bool'><![CDATA[1]]></PreserveTrailingBlanks><FailOnRowErrorPX type='bool'><![CDATA[1]]></FailOnRowErrorPX></Session><Logging><LogColumnValues collapsed='1' type='bool'><![CDATA[0]]></LogColumnValues></Logging><BeforeAfter collapsed='1' type='bool'><![CDATA[0]]></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><Reconnect collapsed='1' type='bool'><![CDATA[0]]></Reconnect><Disconnect collapsed='1' type='int'><![CDATA[0]]></Disconnect></Usage></Properties >"
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V8S0P1"
      OLEType "CCustomInput"
      Readonly "0"
      Name "DSLink_rel_sede_dir"
      Partner "V8S1|V8S1P1"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V8S1"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_EQVSYS_TMP_EMPL_MAE_DIR_PRI1_X_SEDE"
      NextID "2"
      OutputPins "V8S1P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11g</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement modified='1' type='string'><![CDATA[select s.REG_SEDE_PART
, s.ID_PERS
, s.NUM_RUC
, s.ID_SEDE ID_SEDE_N
, d.ID_DIRE ID_DIRE_N
, d.FEC_ACTREG_SUNA
, rsd.ID_SEDE ID_SEDE_E
, rsd.ID_DIRE ID_DIRE_E
--SELECT *  
from eqvsys.TMP_EMPL_AUX_SEDE_PRI2 s
inner join eqvsys.TMP_EMPL_MAE_DIR_PRI2 d on s.ID_PERS = d.ID_PERS AND s.REG_SEDE_PART = 1
left join bdisys.REL_SEDE_DIRE rsd ON rsd.ID_SEDE = s.ID_SEDE AND rsd.ID_DIRE = d.ID_DIRE and rsd.IN_ACTI = 1
where rsd.ID_SEDE is null;]]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified='1' type='bool'><![CDATA[1]]><BeforeSQL modified='1' type='string'><![CDATA[DECLARE
  C_CUENTA NUMBER :=  0;
BEGIN 
--------------------------------------------------------------------------------------------------------------
--1--CREAR LA TABLA TMP TMP_EMPL_REL_SEDE_DIRE_PRI1 CONTIENE LAS REL_SEDE_DIR CONSTRUIDAS A PARTIR DE 
----TMP_EMPL_AUX_SEDE_PRI2 Y TMP_EMPL_MAE_DIR_PRI2 QUE EXISTEN Y NO EXISTEN EN bdisys.REL_SEDE_DIRE
--------------------------------------------------------------------------------------------------------------
SELECT NVL(COUNT(1),0) INTO C_CUENTA FROM ALL_TABLES 
WHERE OWNER = 'EQVSYS' AND TABLE_NAME = 'TMP_EMPL_REL_SEDE_DIRE_PRI1';
IF C_CUENTA > 0 THEN
    EXECUTE IMMEDIATE 'DROP TABLE EQVSYS.TMP_EMPL_REL_SEDE_DIRE_PRI1 PURGE';
END IF;
EXECUTE IMMEDIATE  'CREATE TABLE EQVSYS.TMP_EMPL_REL_SEDE_DIRE_PRI1 
                  (   
                    REG_SEDE_PART     INTEGER,
                    ID_PERS           INTEGER not null,
                    NUM_RUC           CHAR(11) not null,  
                    ID_SEDE_N         INTEGER,
                    ID_DIRE_N         INTEGER,
                    FEC_ACTREG_SUNA   DATE,
                    ID_SEDE_E         INTEGER,
                    ID_DIRE_E         INTEGER                    
                  )';
 END;
 
]]><ReadFromFileBeforeSQL type='bool'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type='string'><![CDATA[]]><ReadFromFileAfterSQL type='bool'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type='string'><![CDATA[]]><ReadFromFileBeforeSQLNode type='bool'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type='string'><![CDATA[]]><ReadFromFileAfterSQLNode type='bool'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V8S1P1"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "DSLink_rel_sede_dir"
      Partner "V8S0|V8S0P1"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "REG_SEDE_PART"
         SqlType "4"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_PERS"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "NUM_RUC"
         SqlType "1"
         Precision "11"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_SEDE_N"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_DIRE_N"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "FEC_ACTREG_SUNA"
         SqlType "9"
         Precision "0"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_SEDE_E"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ID_DIRE_E"
         SqlType "2"
         Precision "38"
         Scale "0"
         Nullable "1"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      LeftTextPos "348"
      TopTextPos "168"
      LinkMinimised "0"
   END DSRECORD
END DSJOB
BEGIN DSJOB
   Identifier "J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001"
   DateModified "2025-05-22"
   TimeModified "14.04.00"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "CJobDefn"
      Readonly "0"
      Name "J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001"
      NextID "13"
      Container "V0"
      JobVersion "56.0.0"
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Prompt "PRM_ORA_CONE_MAE_EMPL parameters"
         Default "(As pre-defined)"
         HelpTxt "Parámetro que contiene parametros de conexion para NETI"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceMode"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSeq"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceRecords"
         Value "100"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TraceSkip"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "TracePeriod"
         Value "1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RecordJobPerformanceData"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "IdentList"
         Value "Peek_REL_SEDE_DIRE|ora_BDISYS_INS_REL_SEDE_DIRE_PRI"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "ClientCodePage"
         Value "1252"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      OrchestrateCode =+=+=+=
#################################################################
#### STAGE: Peek_REL_SEDE_DIRE
## Operator
peek
## Operator options
-nrecs 10
-name

## General options
[ident('Peek_REL_SEDE_DIRE'); jobmon_ident('Peek_REL_SEDE_DIRE')]
## Inputs
0< [] 'ora_BDISYS_INS_REL_SEDE_DIRE_PRI:lnk_ora_bdisys_mae_dir.v'
;

#################################################################
#### STAGE: ora_BDISYS_INS_REL_SEDE_DIRE_PRI
## Operator
pxbridge
## Operator options
-Orientation link
-XMLProperties '<?xml version=\\'1.0\\' encoding=\\'UTF-16\\'?><Properties version=\\'1.1\\'><Common><Context type=\\'int\\'>1</Context><Variant type=\\'string\\'>11</Variant><DescriptorVersion type=\\'string\\'>1.0</DescriptorVersion><PartitionType type=\\'int\\'>-1</PartitionType><RCP type=\\'int\\'>0</RCP></Common><Connection><Server modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD\"]]]></Server><Username modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US\"]]]></Username><Password modified=\\'1\\' type=\\'string\\'><![CDATA[[&\"PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW\"]]]></Password><OSLevelAuthentication type=\\'bool\\'><![CDATA[0]]></OSLevelAuthentication><Version type=\\'string\\'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type=\\'int\\'><![CDATA[0]]></ReadMode><GenerateSQL modified=\\'1\\' type=\\'bool\\'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type=\\'bool\\'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed=\\'1\\' modified=\\'1\\' type=\\'string\\'><![CDATA[select 1 from dual]]><ReadFromFileSelect type=\\'bool\\'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed=\\'1\\'><Table type=\\'string\\'><![CDATA[dual]]></Table></Tables><Parameters collapsed=\\'1\\'></Parameters><Columns collapsed=\\'1\\'><Column type=\\'string\\'><![CDATA[defaulted_alias1,(null),dual]]></Column></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type=\\'int\\'><![CDATA[0]]></IsolationLevel><RecordCount type=\\'int\\'><![CDATA[2000]]></RecordCount><EndOfWave type=\\'int\\'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type=\\'int\\'><![CDATA[2000]]></ArraySize><PrefetchRowCount type=\\'int\\'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type=\\'int\\'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type=\\'bool\\'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type=\\'bool\\'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type=\\'bool\\'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified=\\'1\\' type=\\'bool\\'><![CDATA[1]]><BeforeSQL modified=\\'1\\' type=\\'string\\'><![CDATA[--SET SERVEROUTPUT ON;
DECLARE
    -- Constantes de configuración
    C_USUARIO_CARGA  CONSTANT VARCHAR2(10) := \\'INI-2842\\';
    C_TERMINAL_CARGA CONSTANT VARCHAR2(15) := \\'1.1.1.1\\';
    
    -- Variables de control de proceso
    v_id_proceso_carga     NUMBER(38,0);
    v_id_detalle_proceso   NUMBER(38,0);
    v_fecha_inicio         DATE := SYSDATE;
    v_tab_ori              VARCHAR2(30);
    v_tab_des              VARCHAR2(30);
    
    -- Contadores globales de proceso - no se reinician en cada iteración
    v_total_insertados     INTEGER := 0;
    v_total_observados     INTEGER := 0;
    v_total_actualizados   INTEGER := 0;
    v_total_insertados_adic INTEGER := 0;
    
    -- Variables de trabajo
    v_id_origen_direccion  NUMBER;
    v_mensaje_error        VARCHAR2(4000);
    v_de_obs               VARCHAR2(500) := \\'Sin Observaciones\\';
    v_texto                VARCHAR2(50) :=\\'\\';
    v_id_pers              BDISYS.MAE_PERS.ID_PERS%TYPE; 
    v_num_ruc              BDISYS.REL_PERS_DOCU.CO_DOCU%TYPE; 
    v_id_sede_n            BDISYS.AUX_SEDE.ID_SEDE%TYPE;
    v_id_dire_n            BDISYS.MAE_DIRE.ID_DIRE%TYPE;
    v_fec_actreg_suna      DATE;
    l_total_registros      INTEGER := 0;
    v_insertedos_historico INTEGER := 0;
    v_tiempo_inicio        TIMESTAMP;
    v_tiempo_fin           TIMESTAMP;
    
    -- Tipo de registro para procesamiento de lotes
    TYPE t_registro_sede IS RECORD (
        id_persona     BDISYS.MAE_EMPL.ID_EMPL%TYPE,
        num_ruc        BDISYS.REL_PERS_DOCU.CO_DOCU%TYPE,
        id_sede_nueva  BDISYS.AUX_SEDE.ID_SEDE%TYPE,
        id_dir_nueva   BDISYS.MAE_DIRE.ID_DIRE%TYPE,
        fecha_registro EQVSYS.TMP_EMPL_MAE_DIR_PRI2.FEC_ACTREG_SUNA%TYPE
    );
    
    TYPE t_tabla_sedes IS TABLE OF t_registro_sede;
    
    -- Función local para registrar eventos
    PROCEDURE registrar_evento(
        p_id_proceso     NUMBER,
        p_id_detalle     NUMBER,
        p_descripcion    VARCHAR2
    ) IS
    BEGIN
        INSERT INTO eqvsys.TMP_AUX_EVTO_PROC_CARG(
            id_ctrl_PROC_CARG,
            id_ctrl_PROC_CARG_DETA,
            DE_PROC_CARG,
            fe_evto_carg,
            de_evto,
            id_usua_crea,
            de_term_crea
        ) VALUES (
            p_id_proceso,
            p_id_detalle,
            \\'Carga Sede Dirección\\',
            SYSDATE,
            p_descripcion,
            C_USUARIO_CARGA,
            C_TERMINAL_CARGA
        );
        
        DBMS_OUTPUT.PUT_LINE(p_descripcion);
    END;
    
BEGIN
    v_tiempo_inicio := SYSTIMESTAMP;
    DBMS_OUTPUT.PUT_LINE(\\'INICIA --->>>>>>>>   \\' || TO_CHAR(SYSDATE, \\'DD/MM/YYYY HH24:MI:SS\\'));
    
    --------------------------------------------------------------------------------------------------------------
    -- Inicialización y configuración del proceso
    --------------------------------------------------------------------------------------------------------------
    -- Obtener ID de proceso de carga
    BEGIN
        SELECT ID_CTRL_PROC_CARG 
        INTO v_id_proceso_carga 
        FROM EQVSYS.TMP_EMPL_CTRL_PROC_CARG_TMP;
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20001, \\'No se encontró ID de proceso de carga\\');
    END;
    
    --1. Setear tabla origen y destino.
    v_tab_ori := \\'T3726PADRUC\\';
    v_tab_des := \\'REL_SEDE_DIRE\\';
    
    -- Obtener ID de detalle de proceso
    BEGIN
        SELECT ID_CTRL_PROC_CARG_DETA, FE_MIN_RANG_CARG, FE_MAX_RANG_CARG    
        INTO v_id_detalle_proceso, v_fecha_inicio, v_fecha_inicio
        FROM (
            SELECT ID_CTRL_PROC_CARG_DETA, FE_MIN_RANG_CARG, FE_MAX_RANG_CARG
            FROM EQVSYS.TMP_AUX_CTRL_PROC_CARG_DETA
            WHERE DE_TABLA_DESTINO = v_tab_des 
            AND DE_TABLA_ORIG = v_tab_ori 
            AND ID_CTRL_PROC_CARG = v_id_proceso_carga
            ORDER BY ID_CTRL_PROC_CARG_DETA DESC
        )
        WHERE ROWNUM = 1;
        DBMS_OUTPUT.PUT_LINE(\\'ID de detalle de proceso: \\' || v_id_detalle_proceso);
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20002, \\'No se encontró detalle de proceso de carga\\');
    END;
    
    -- Registrar inicio de proceso
    registrar_evento(
        v_id_proceso_carga, 
        v_id_detalle_proceso, 
        \\'Inicio de carga de sedes principales \\' || TO_CHAR(SYSDATE, \\'DD/MM/YYYY HH24:MI:SS\\')
    );
    
    -- Obtener ID de origen de dirección SUNAT
    BEGIN
        SELECT ID_PARM INTO v_id_origen_direccion 
        FROM BDISYS.CAT_PARM 
        WHERE ID_PARM_PADR IN (
            SELECT ID_PARM 
            FROM BDISYS.CAT_PARM 
            WHERE CO_PARM = \\'PARM_ORIN_DIRE\\'
        ) AND CO_PARM = \\'PARM_DIRE_SUNAT\\';
        DBMS_OUTPUT.PUT_LINE(\\'ID de origen dirección SUNAT: \\' || v_id_origen_direccion);
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20003, \\'No se encontró origen de dirección SUNAT\\');
    END;
    
    --------------------------------------------------------------------------------------------------------
    -- Procesamiento principal: inserción y actualización de rel_sede_dir y rel_sede_dir_adic
    --------------------------------------------------------------------------------------------------------
    BEGIN
        -- Variables para procesamiento por lotes
        DECLARE
            l_registros         t_tabla_sedes;
            l_limite            CONSTANT PLS_INTEGER := 1000; -- Reducido de 5000 a 1000 para mejor rendimiento
            l_desplazamiento    PLS_INTEGER := 0;
            l_iteracion         PLS_INTEGER := 0;
            l_insertados_batch  PLS_INTEGER := 0;
            l_adic_batch        PLS_INTEGER := 0;
            l_actualizados_batch PLS_INTEGER := 0;
            l_observados_batch  PLS_INTEGER := 0;
            l_ultimo_commit     PLS_INTEGER := 0;
            l_query_inicio      TIMESTAMP;
            l_query_fin         TIMESTAMP;
        BEGIN
            -- Obtener total de registros
            SELECT COUNT(*) INTO l_total_registros
            FROM eqvsys.TMP_EMPL_REL_SEDE_DIRE_PRI1;
            
            DBMS_OUTPUT.PUT_LINE(\\'Total de registros a procesar: \\' || l_total_registros);
            DBMS_OUTPUT.PUT_LINE(\\'Tamaño de lote: \\' || l_limite);
            
            -- Registrar evento de carga
            registrar_evento(
                v_id_proceso_carga, 
                v_id_detalle_proceso, 
                \\'Total registros a procesar: \\' || l_total_registros
            );
    
            -- Procesamiento por lotes
            WHILE l_desplazamiento < l_total_registros LOOP
                l_iteracion := l_iteracion + 1;
                l_query_inicio := SYSTIMESTAMP;
                
                -- Reiniciar contadores de lote
                l_insertados_batch := 0;
                l_adic_batch := 0;
                l_actualizados_batch := 0;
                l_observados_batch := 0;
                
                BEGIN
                    -- Selección de registros por lotes compatible con versiones anteriores de Oracle
                    SELECT ID_PERS, NUM_RUC, ID_SEDE_N, ID_DIRE_N, FEC_ACTREG_SUNA 
                    BULK COLLECT INTO l_registros
                    FROM (
                        SELECT x.*, ROWNUM rn
                        FROM (
                            SELECT ID_PERS, NUM_RUC, ID_SEDE_N, ID_DIRE_N, FEC_ACTREG_SUNA
                            FROM eqvsys.TMP_EMPL_REL_SEDE_DIRE_PRI1
                            ORDER BY ID_PERS, ID_SEDE_N, ID_DIRE_N
                        ) x
                        WHERE ROWNUM <= l_desplazamiento + l_limite
                    )
                    WHERE rn > l_desplazamiento;
                    
                    l_query_fin := SYSTIMESTAMP;
                    DBMS_OUTPUT.PUT_LINE(\\'Lote \\' || l_iteracion || \\': Consulta completada en \\' || 
                                        EXTRACT(SECOND FROM (l_query_fin - l_query_inicio)) || \\' segundos\\');
                    
                    EXIT WHEN l_registros.COUNT = 0;
                    
                    -- Inserción masiva en REL_SEDE_DIRE con mejor manejo de errores
                    BEGIN
                        DBMS_OUTPUT.PUT_LINE(\\'Lote \\' || l_iteracion || \\': Insertando \\' || 
                                            l_registros.COUNT || \\' registros en REL_SEDE_DIRE\\');
                        
                        FORALL i IN 1..l_registros.COUNT SAVE EXCEPTIONS
                        INSERT INTO BDISYS.REL_SEDE_DIRE (
                            ID_SEDE, ID_DIRE, FE_INI_VALI, 
                            IN_VERI_SEDE_DIRE, ID_ORIG_DIRE, 
                            IN_ACTI, ID_USUA_CREA, 
                            FE_USUA_CREA, DE_TERM_CREA
                        )
                        VALUES (
                            l_registros(i).id_sede_nueva, 
                            l_registros(i).id_dir_nueva, 
                            SYSDATE, \\'0\\', 
                            v_id_origen_direccion, \\'1\\', 
                            C_USUARIO_CARGA, 
                            v_fecha_inicio, 
                            C_TERMINAL_CARGA
                        );
                        
                        -- Registrar total de insertados en este lote
                        l_insertados_batch := SQL%ROWCOUNT;
                        v_total_insertados := v_total_insertados + l_insertados_batch;
                        
                        DBMS_OUTPUT.PUT_LINE(\\'Lote \\' || l_iteracion || \\': Insertados en REL_SEDE_DIRE: \\' || 
                                            l_insertados_batch || \\' registros\\');
                        
                    EXCEPTION
                        WHEN OTHERS THEN
                            -- Registrar errores específicos para la inserción en REL_SEDE_DIRE
                            DBMS_OUTPUT.PUT_LINE(\\'Error en inserción REL_SEDE_DIRE: \\' || SQLERRM);
                            
                            -- Procesamiento de errores bulk
                            FOR j IN 1..SQL%BULK_EXCEPTIONS.COUNT LOOP
                                v_mensaje_error := SQLERRM(-SQL%BULK_EXCEPTIONS(j).ERROR_CODE);
                                v_id_sede_n := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_sede_nueva, 0);
                                v_id_dire_n := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_dir_nueva, 0);
                                v_num_ruc := l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).num_ruc;
                                v_id_pers := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_persona, 0);
                                v_fec_actreg_suna := l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).fecha_registro;
                                
                                v_de_obs := SUBSTR(\\'Error REL_SEDE_DIRE - ID_SEDE: \\' || v_id_sede_n || 
                                                 \\', ID_DIRE: \\' || v_id_dire_n || \\' - \\' || v_mensaje_error, 1, 500);
                                
                                -- Registrar error en log
                                INSERT INTO EQVSYS.TMP_AUX_LOG_ERRO_ALER(
                                    ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_REG_DEST, ID_REG_ORIG,
                                    DE_OBS, ID_EMPL, NUM_RUC, FEC_ACTREG, TI_OPER,
                                    ID_USUA_CREA, FE_USUA_CREA, DE_TERM_CREA
                                ) VALUES (
                                    v_id_proceso_carga, v_id_detalle_proceso,
                                    \\'SEDE:\\' || v_id_sede_n || \\',DIRE:\\' || v_id_dire_n,
                                    \\'RUC:\\' || v_num_ruc, v_de_obs, v_id_pers, v_num_ruc,
                                    v_fec_actreg_suna, \\'INS\\', C_USUARIO_CARGA, v_fecha_inicio, C_TERMINAL_CARGA
                                );
                                
                                l_observados_batch := l_observados_batch + 1;
                            END LOOP;
                            
                            v_total_observados := v_total_observados + l_observados_batch;
                    END;
                                   
                    -- Inserción en REL_SEDE_DIRE_ADIC CON MANEJO DE ERRORES
                    BEGIN
                        DBMS_OUTPUT.PUT_LINE(\\'Lote \\' || l_iteracion || \\': Insertando en REL_SEDE_DIRE_ADIC\\');
                        
                        FORALL i IN 1..l_registros.COUNT SAVE EXCEPTIONS
                        INSERT INTO bdisys.REL_SEDE_DIRE_ADIC (
                            ID_EMPL, ID_SEDE, ID_DIRE, 
                            NUM_RUC, IN_ES_PRINC, 
                            FEC_ACTREG_SUNA, ID_HABI, 
                            DES_NUMLIC, IN_ACTI, 
                            ID_USUA_CREA, FE_USUA_CREA, 
                            DE_TERM_CREA
                        )
                        VALUES (
                            l_registros(i).id_persona, 
                            l_registros(i).id_sede_nueva, 
                            l_registros(i).id_dir_nueva, 
                            l_registros(i).num_ruc, 
                            \\'1\\', 
                            l_registros(i).fecha_registro, 
                            \\'1\\', 
                            NULL, 
                            \\'1\\', 
                            C_USUARIO_CARGA, 
                            v_fecha_inicio, 
                            C_TERMINAL_CARGA
                        );
                        
                        -- Registrar total insertados en ADIC
                        l_adic_batch := SQL%ROWCOUNT;
                        v_total_insertados_adic := v_total_insertados_adic + l_adic_batch;
                        
                        DBMS_OUTPUT.PUT_LINE(\\'Lote \\' || l_iteracion || \\': Insertados en REL_SEDE_DIRE_ADIC: \\' || 
                                           l_adic_batch || \\' registros\\');
                    EXCEPTION
                        WHEN OTHERS THEN
                            -- Registrar errores específicos para la inserción en REL_SEDE_DIRE_ADIC
                            DBMS_OUTPUT.PUT_LINE(\\'Error en inserción REL_SEDE_DIRE_ADIC: \\' || SQLERRM);
                            
                            -- Procesamiento de errores bulk
                            FOR j IN 1..SQL%BULK_EXCEPTIONS.COUNT LOOP
                                v_mensaje_error := SQLERRM(-SQL%BULK_EXCEPTIONS(j).ERROR_CODE);
                                v_id_sede_n := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_sede_nueva, 0);
                                v_id_dire_n := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_dir_nueva, 0);
                                v_num_ruc := l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).num_ruc;
                                v_id_pers := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_persona, 0);
                                v_fec_actreg_suna := l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).fecha_registro;
                                
                                v_de_obs := SUBSTR(\\'Error REL_SEDE_DIRE_ADIC - ID_SEDE: \\' || v_id_sede_n || 
                                                 \\', ID_DIRE: \\' || v_id_dire_n || \\' - \\' || v_mensaje_error, 1, 500);
                                
                                -- Registrar error en log
                                INSERT INTO EQVSYS.TMP_AUX_LOG_ERRO_ALER(
                                    ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_REG_DEST, ID_REG_ORIG,
                                    DE_OBS, ID_EMPL, NUM_RUC, FEC_ACTREG, TI_OPER,
                                    ID_USUA_CREA, FE_USUA_CREA, DE_TERM_CREA
                                ) VALUES (
                                    v_id_proceso_carga, v_id_detalle_proceso,
                                    \\'SEDE:\\' || v_id_sede_n || \\',DIRE:\\' || v_id_dire_n,
                                    \\'RUC:\\' || v_num_ruc, v_de_obs, v_id_pers, v_num_ruc,
                                    v_fec_actreg_suna, \\'INS\\', C_USUARIO_CARGA, v_fecha_inicio, C_TERMINAL_CARGA
                                );
                                
                                l_observados_batch := l_observados_batch + 1;
                            END LOOP;
                            
                            v_total_observados := v_total_observados + l_observados_batch;
                    END;
\(9)\(9)\(9)\(9)\(9)
\(9)\(9)\(9)\(9)\(9)-- Commit después de los 2 procesos principales
                    COMMIT;
\(9)\(9)\(9)\(9)\(9)-- Registrar detalles de carga exitosa
                    BEGIN
                        FORALL i IN 1..l_registros.COUNT
                        INSERT INTO EQVSYS.TMP_AUX_DETA_CARG_POR_REGI(
                            ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_REG_DEST, ID_REG_ORIG, 
                            TI_OPER, ID_EMPL, NUM_RUC, FEC_ACTREG, 
                            ID_USUA_CREA, FE_USUA_CREA, DE_TERM_CREA
                        ) VALUES (
                            v_id_proceso_carga, v_id_detalle_proceso,
                            l_registros(i).id_persona, \\'|ruc:\\' || l_registros(i).NUM_RUC,
                            \\'UPD\\', l_registros(i).id_persona, l_registros(i).NUM_RUC,
                            l_registros(i).fecha_registro, C_USUARIO_CARGA, SYSDATE, C_TERMINAL_CARGA
                        );
                    EXCEPTION
                        WHEN OTHERS THEN
                            DBMS_OUTPUT.PUT_LINE(\\'Error al registrar detalles de carga: \\' || SQLERRM);
                    END;
                    
\(9)\(9)\(9)\(9)\(9)
                    -- Actualizar otras sedes del mismo empleador
                    BEGIN
                        DBMS_OUTPUT.PUT_LINE(\\'Lote \\' || l_iteracion || \\': Actualizando otras sedes\\');
                        
                        FORALL i IN 1..l_registros.COUNT --SAVE EXCEPTIONS
                        UPDATE bdisys.REL_SEDE_DIRE_ADIC rsda
                        SET 
                            rsda.ID_HABI = 0,
                            rsda.ID_USUA_MODI = C_USUARIO_CARGA,
                            rsda.FE_USUA_MODI = SYSDATE,
                            rsda.DE_TERM_MODI = C_TERMINAL_CARGA
                        WHERE 
                            rsda.ID_EMPL = l_registros(i).id_persona AND
                            (
                                (rsda.ID_SEDE = l_registros(i).id_sede_nueva AND 
                                 rsda.ID_DIRE <> l_registros(i).id_dir_nueva) OR
                                (rsda.ID_SEDE <> l_registros(i).id_sede_nueva)
                            ) AND
                            rsda.ID_HABI = 1 AND
                            rsda.IN_ACTI = 1 AND
\(9)\(9)\(9)\(9)\(9)\(9)\(9)rsda.IN_ES_PRINC = \\'1\\';
\(9)\(9)\(9)\(9)\(9)\(9)\(9)
                        -- Registrar total actualizados
                        l_actualizados_batch := SQL%ROWCOUNT;
                        v_total_actualizados := v_total_actualizados + l_actualizados_batch;
                        
                        DBMS_OUTPUT.PUT_LINE(\\'Lote \\' || l_iteracion || \\': Actualizados en otras sedes: \\' || 
                                           l_actualizados_batch || \\' registros\\');
                    EXCEPTION
                        WHEN OTHERS THEN
                            -- Registrar errores específicos para la actualización
                            DBMS_OUTPUT.PUT_LINE(\\'Error en actualización otras sedes: \\' || SQLERRM);                            
                    END;
                    
                    -- Commit después de los 2 procesos complementarios
                    COMMIT;
                    
                    -- Imprimir resumen de este lote
                    DBMS_OUTPUT.PUT_LINE(\\'Resumen Lote \\' || l_iteracion || \\': \\' ||
                                       \\'Insertados REL_SEDE_DIRE=\\' || l_insertados_batch ||
                                       \\', Insertados REL_SEDE_DIRE_ADIC=\\' || l_adic_batch ||
                                       \\', Actualizados=\\' || l_actualizados_batch ||
                                       \\', Observados=\\' || l_observados_batch);
                    
                    -- Siguiente lote
                    l_desplazamiento := l_desplazamiento + l_limite;
                    
                    -- Registrar progreso cada 5 lotes o al final
                    IF (MOD(l_iteracion, 5) = 0) OR (l_desplazamiento >= l_total_registros) THEN
                        registrar_evento(
                            v_id_proceso_carga, 
                            v_id_detalle_proceso, 
                            \\'Progreso: \\' || l_desplazamiento || \\'/\\' || l_total_registros || 
                            \\' registros (\\' || ROUND((l_desplazamiento/l_total_registros)*100) || 
                            \\'%). Insertados=\\' || v_total_insertados || 
                            \\', Observados=\\' || v_total_observados
                        );
                    END IF;
                    
                EXCEPTION
                    WHEN OTHERS THEN
                        -- Manejo general de errores para todo el lote
                        DBMS_OUTPUT.PUT_LINE(\\'Error general en lote \\' || l_iteracion || \\': \\' || SQLERRM);
                        registrar_evento(
                            v_id_proceso_carga, 
                            v_id_detalle_proceso, 
                            \\'Error en lote \\' || l_iteracion || \\': \\' || SUBSTR(SQLERRM, 1, 300)
                        );
                                              
                        -- Commit para guardar los logs de error
                        COMMIT;
                END;
            END LOOP;
            
            -- Estadísticas finales
            DBMS_OUTPUT.PUT_LINE(\\'--------------------------------------------------\\');
            DBMS_OUTPUT.PUT_LINE(\\'ESTADÍSTICAS DE PROCESAMIENTO:\\');
            DBMS_OUTPUT.PUT_LINE(\\'Total registros procesados: \\' || l_total_registros);
            DBMS_OUTPUT.PUT_LINE(\\'Registros insertados en REL_SEDE_DIRE: \\' || v_total_insertados);
            DBMS_OUTPUT.PUT_LINE(\\'Registros insertados en REL_SEDE_DIRE_ADIC: \\' || v_total_insertados_adic);
            DBMS_OUTPUT.PUT_LINE(\\'Registros actualizados: \\' || v_total_actualizados);
            DBMS_OUTPUT.PUT_LINE(\\'Registros con observaciones: \\' || v_total_observados);
        END;
    END;
    
     ------------------------------------------------------------------------------------------------------------------------------------------------------
    -- Reconstruyendo historico de direcciones (de BDI) : Si existian en REL_SEDE_DIRE y NO existian en REL_SEDE_DIRE_ADIC las insertamos Inabilitadas.\(9)
    ------------------------------------------------------------------------------------------------------------------------------------------------------
    BEGIN
\(9)\(9)DBMS_OUTPUT.PUT_LINE(\\' Reconstruyendo historico de direcciones\\');        
        INSERT INTO bdisys.REL_SEDE_DIRE_ADIC 
\(9)\(9)\(9)(ID_EMPL, ID_SEDE, ID_DIRE, NUM_RUC, IN_ES_PRINC, FEC_ACTREG_SUNA, ID_HABI, DES_NUMLIC, IN_ACTI, ID_USUA_CREA, FE_USUA_CREA, DE_TERM_CREA)\(9)\(9)\(9)\(9)   
\(9)\(9)SELECT\(9)--s.REG_SEDE_PART
             s.ID_PERS
\(9)\(9)\(9), s.ID_SEDE
\(9)\(9)\(9), rsd.ID_DIRE
            , s.NUM_RUC
\(9)\(9)\(9),\\'1\\'
            , s.FEC_ACTREG_SUNA
\(9)\(9)\(9),\\'0\\' ---*
\(9)\(9)\(9), NULL
\(9)\(9)\(9), \\'1\\'
            , C_USUARIO_CARGA
\(9)\(9)\(9), SYSDATE
\(9)\(9)\(9), C_TERMINAL_CARGA
            FROM eqvsys.TMP_EMPL_AUX_SEDE_PRI2 s
            INNER JOIN bdisys.REL_SEDE_DIRE rsd ON rsd.ID_SEDE = s.ID_SEDE 
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)--AND rsd.ID_DIRE = d.ID_DIRE 
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)AND rsd.IN_ACTI = 1
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)--AND s.REG_SEDE_PART > 1
\(9)\(9)\(9)LEFT JOIN bdisys.REL_SEDE_DIRE_ADIC rsda ON rsda.ID_SEDE = s.ID_SEDE 
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9) AND rsda.ID_DIRE = rsd.ID_DIRE 
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9) AND rsda.ID_EMPL = s.ID_PERS
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9) AND rsda.IN_ACTI = 1
            WHERE rsda.ID_SEDE IS NULL;
            
            -- Obtener el número de filas insertadas
            v_insertedos_historico := SQL%ROWCOUNT;

            -- Mostrar el resultado
            DBMS_OUTPUT.PUT_LINE(\\'--------------------------------------------------------------------------------\\');
            DBMS_OUTPUT.PUT_LINE(\\'Registros insertados en reconstruccion de historico: \\' || v_insertedos_historico);
                                
     EXCEPTION
           WHEN OTHERS THEN
           DBMS_OUTPUT.PUT_LINE(\\'Error EN RECONSTRUCCION DE HIST - INSERCION EN REL_SEDE_DIRE_ADIC : ID_SEDE: \\' ||  v_id_sede_n || SQLERRM);
     END; 
     
    -------------------------------------------------------------------------------------------------------------
    -- Control de carga (final)
    --------------------------------------------------------------------------------------------------------------
    -- Registrar finalización
     DBMS_OUTPUT.PUT_LINE(\\'Registrar finalización\\');
    registrar_evento(
        v_id_proceso_carga, 
        v_id_detalle_proceso, 
        \\'Finalización de carga de sedes principales. \\' || 
        \\'Insertados: \\' || v_total_insertados || 
        \\'Observados: \\' || v_total_observados
    );
    
 -- Registrar inicio de proceso
    registrar_evento(
        v_id_proceso_carga, 
        v_id_detalle_proceso, 
        \\'Inicio de carga de sedes principales\\' || \\'FINALIZA >>>> \\' || TO_CHAR(SYSDATE, \\'DD/MM/YYYY HH24:MI:SS\\')
    );
    
    -- Actualizar estado del proceso
    DBMS_OUTPUT.PUT_LINE(\\'Actualizar estado del proceso\\');
    UPDATE REPBDISYS.AUX_CTRL_PROC_CARG_DETA@DBL_BDQA19G7_REPBDISYS
    SET 
        IN_ESTA_PROC_DETA = CASE WHEN v_total_observados > 0 THEN \\'0\\' ELSE \\'1\\' END,
        CA_TOTL_MIGR = l_total_registros,
        un_totl_ingr = v_total_insertados,
        un_totl_obse = v_total_observados,
        fe_fin_carg_deta = SYSDATE,
        ID_USUA_MODI = C_USUARIO_CARGA,
        FE_USUA_MODI = SYSDATE,
        DE_TERM_MODI = C_TERMINAL_CARGA
    WHERE ID_CTRL_PROC_CARG_DETA = v_id_detalle_proceso;
    
    COMMIT;

DBMS_OUTPUT.PUT_LINE(\\'TERMINA --->>>>>>>>   \\' || TO_CHAR(SYSDATE, \\'DD/MM/YYYY HH24:MI:SS\\'));

EXCEPTION
    WHEN OTHERS THEN
        -- Manejo de errores críticos
        BEGIN
            registrar_evento(
                v_id_proceso_carga, 
                v_id_detalle_proceso, 
                \\'Error crítico: \\' || SUBSTR(SQLERRM, 1, 300)
            );
            
           
            COMMIT;
        EXCEPTION
            WHEN OTHERS THEN
                DBMS_OUTPUT.PUT_LINE(\\'Error irrecuperable: \\' || SQLERRM);
        END;

        DBMS_OUTPUT.PUT_LINE(\\'WHEN OTHERS THEN errores\\');
        ROLLBACK;
       -- RAISE;       
END;]]><ReadFromFileBeforeSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQL type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileBeforeSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type=\\'string\\'><![CDATA[]]><ReadFromFileAfterSQLNode type=\\'bool\\'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type=\\'bool\\'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed=\\'1\\' type=\\'bool\\'><![CDATA[0]]></LimitRows></Usage></Properties >'
-connector '{
   variant=\\'11\\', 
   library=ccora11g, 
   version=1.0, 
   variantlist=\\'V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c\\', 
   versionlist=\\'1.0,1.0\\', 
   name=OracleConnector
}'
-source 0 '{
      DSSQLType={IN_PARM=4}, 
      DSSchema=\\'record
         (
           IN_PARM\\:int32\\;
         )\\'
}'
   

## General options
[ident('ora_BDISYS_INS_REL_SEDE_DIRE_PRI'); jobmon_ident('ora_BDISYS_INS_REL_SEDE_DIRE_PRI')]
## Outputs
0> [modify (
  IN_PARM:not_nullable int32=IN_PARM;
keep
  IN_PARM;
)] 'ora_BDISYS_INS_REL_SEDE_DIRE_PRI:lnk_ora_bdisys_mae_dir.v'
;


=+=+=+=
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "3"
      Category "\\Jobs\\FUENTES_EXTERNAS\\MIGRACION_NETI_EMPL\\AUXILIAR\\AUX_SEDE_PRINCIPAL"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V12S0|V12S1"
      StageXPos "480|120"
      StageYPos "120|120"
      StageTypes "CCustomStage|CCustomStage.CC_GUI"
      NextStageID "0"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "100"
      StageXSize "48|48"
      StageYSize "48|48"
      ContainerViewSizing "0026 0026 0687 0314 0000 0001 0000 0000"
      StageNames "Peek_REL_SEDE_DIRE|ora_BDISYS_INS_REL_SEDE_DIRE_PRI"
      StageTypeIDs "PxPeek|OracleConnectorPX"
      LinkNames " |lnk_ora_bdisys_mae_dir"
      LinkHasMetaDatas " |True"
      LinkTypes " |1"
      LinkNamePositionXs " |312"
      LinkNamePositionYs " |144"
      TargetStageIDs " |V12S0"
      SourceStageEffectiveExecutionModes " |2"
      SourceStageRuntimeExecutionModes " |2"
      TargetStageEffectiveExecutionModes " |2"
      TargetStageRuntimeExecutionModes " |2"
      LinkIsSingleOperatorLookup " |False"
      LinkIsSortSequential " |False"
      LinkSortMode " |0"
      LinkPartColMode " |1"
      LinkSourcePinIDs " |V12S1P1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V12S0"
      OLEType "CCustomStage"
      Readonly "0"
      Name "Peek_REL_SEDE_DIRE"
      NextID "2"
      InputPins "V12S0P1"
      StageType "PxPeek"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "all"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "nrecs"
         Value "10"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "dataset"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "name"
         Value "name"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "columns"
         Value " "
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "selection"
         Value " "
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V12S0P1"
      OLEType "CCustomInput"
      Readonly "0"
      Name "lnk_ora_bdisys_mae_dir"
      Partner "V12S1|V12S1P1"
      LinkType "1"
      ConditionNotMet "fail"
      LookupFail "fail"
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "RTColumnProp"
         Value "0"
      END DSSUBRECORD
      TransactionSize "0"
      TXNBehaviour "0"
      EnableTxGroup "0"
      LinkMinimised "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V12S1"
      OLEType "CCustomStage"
      Readonly "0"
      Name "ora_BDISYS_INS_REL_SEDE_DIRE_PRI"
      NextID "2"
      OutputPins "V12S1P1"
      StageType "OracleConnectorPX"
      AllowColumnMapping "0"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariants"
         Value "V1;11:\"11g\":ccora11g;12:\"12c\":ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsLibraries"
         Value "ccora11g,ccora12c"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "SupportedVariantsVersions"
         Value "1.0,1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Orientation"
         Value "link"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Engine"
         Value "EE"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Context"
         Value "source"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectionString"
         Value "/Connection/Server"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Username"
         Value "/Connection/Username"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "Password"
         Value "/Connection/Password"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RACName"
         Value "/Connection/RACName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "xaoDbName"
         Value "/Connection/xaoDbName"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "OSLevelAuthentication"
         Value "/Connection/OSLevelAuthentication"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "XMLProperties"
         Value =+=+=+=
<?xml version='1.0' encoding='UTF-16'?><Properties version='1.1'><Common><Context type='int'>1</Context><Variant type='string'>11</Variant><DescriptorVersion type='string'>1.0</DescriptorVersion><PartitionType type='int'>-1</PartitionType><RCP type='int'>0</RCP></Common><Connection><Server modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_BD#]]></Server><Username modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_US#]]></Username><Password modified='1' type='string'><![CDATA[#PRM_ORA_CONE_MAE_EMPL.$VE_DTS_EQV_ORA_PW#]]></Password><OSLevelAuthentication type='bool'><![CDATA[0]]></OSLevelAuthentication><Version type='string'><![CDATA[11g]]></Version></Connection><Usage><ReadMode type='int'><![CDATA[0]]></ReadMode><GenerateSQL modified='1' type='bool'><![CDATA[0]]></GenerateSQL><EnableQuotedIDs type='bool'><![CDATA[0]]></EnableQuotedIDs><SQL><SelectStatement collapsed='1' modified='1' type='string'><![CDATA[select 1 from dual]]><ReadFromFileSelect type='bool'><![CDATA[0]]></ReadFromFileSelect><Tables collapsed='1'><Table type='string'><![CDATA[dual]]></Table></Tables><Parameters collapsed='1'></Parameters><Columns collapsed='1'><Column type='string'><![CDATA[defaulted_alias1,(null),dual]]></Column></Columns></SelectStatement></SQL><EnablePartitionedReads collapsed='1' type='bool'><![CDATA[0]]></EnablePartitionedReads><Transaction><IsolationLevel type='int'><![CDATA[0]]></IsolationLevel><RecordCount type='int'><![CDATA[2000]]></RecordCount><EndOfWave type='int'><![CDATA[0]]></EndOfWave></Transaction><Session><ArraySize type='int'><![CDATA[2000]]></ArraySize><PrefetchRowCount type='int'><![CDATA[1]]></PrefetchRowCount><PrefetchMemorySize type='int'><![CDATA[0]]></PrefetchMemorySize><PassLobLocator collapsed='1' type='bool'><![CDATA[0]]></PassLobLocator><BFILEasBLOB type='bool'><![CDATA[0]]></BFILEasBLOB><TreatWarningsAsErrors type='bool'><![CDATA[0]]></TreatWarningsAsErrors><TreatFetchTruncateAsError type='bool'><![CDATA[1]]></TreatFetchTruncateAsError></Session><BeforeAfter modified='1' type='bool'><![CDATA[1]]><BeforeSQL modified='1' type='string'><![CDATA[--SET SERVEROUTPUT ON;
DECLARE
    -- Constantes de configuración
    C_USUARIO_CARGA  CONSTANT VARCHAR2(10) := 'INI-2842';
    C_TERMINAL_CARGA CONSTANT VARCHAR2(15) := '1.1.1.1';
    
    -- Variables de control de proceso
    v_id_proceso_carga     NUMBER(38,0);
    v_id_detalle_proceso   NUMBER(38,0);
    v_fecha_inicio         DATE := SYSDATE;
    v_tab_ori              VARCHAR2(30);
    v_tab_des              VARCHAR2(30);
    
    -- Contadores globales de proceso - no se reinician en cada iteración
    v_total_insertados     INTEGER := 0;
    v_total_observados     INTEGER := 0;
    v_total_actualizados   INTEGER := 0;
    v_total_insertados_adic INTEGER := 0;
    
    -- Variables de trabajo
    v_id_origen_direccion  NUMBER;
    v_mensaje_error        VARCHAR2(4000);
    v_de_obs               VARCHAR2(500) := 'Sin Observaciones';
    v_texto                VARCHAR2(50) :='';
    v_id_pers              BDISYS.MAE_PERS.ID_PERS%TYPE; 
    v_num_ruc              BDISYS.REL_PERS_DOCU.CO_DOCU%TYPE; 
    v_id_sede_n            BDISYS.AUX_SEDE.ID_SEDE%TYPE;
    v_id_dire_n            BDISYS.MAE_DIRE.ID_DIRE%TYPE;
    v_fec_actreg_suna      DATE;
    l_total_registros      INTEGER := 0;
    v_insertedos_historico INTEGER := 0;
    v_tiempo_inicio        TIMESTAMP;
    v_tiempo_fin           TIMESTAMP;
    
    -- Tipo de registro para procesamiento de lotes
    TYPE t_registro_sede IS RECORD (
        id_persona     BDISYS.MAE_EMPL.ID_EMPL%TYPE,
        num_ruc        BDISYS.REL_PERS_DOCU.CO_DOCU%TYPE,
        id_sede_nueva  BDISYS.AUX_SEDE.ID_SEDE%TYPE,
        id_dir_nueva   BDISYS.MAE_DIRE.ID_DIRE%TYPE,
        fecha_registro EQVSYS.TMP_EMPL_MAE_DIR_PRI2.FEC_ACTREG_SUNA%TYPE
    );
    
    TYPE t_tabla_sedes IS TABLE OF t_registro_sede;
    
    -- Función local para registrar eventos
    PROCEDURE registrar_evento(
        p_id_proceso     NUMBER,
        p_id_detalle     NUMBER,
        p_descripcion    VARCHAR2
    ) IS
    BEGIN
        INSERT INTO eqvsys.TMP_AUX_EVTO_PROC_CARG(
            id_ctrl_PROC_CARG,
            id_ctrl_PROC_CARG_DETA,
            DE_PROC_CARG,
            fe_evto_carg,
            de_evto,
            id_usua_crea,
            de_term_crea
        ) VALUES (
            p_id_proceso,
            p_id_detalle,
            'Carga Sede Dirección',
            SYSDATE,
            p_descripcion,
            C_USUARIO_CARGA,
            C_TERMINAL_CARGA
        );
        
        DBMS_OUTPUT.PUT_LINE(p_descripcion);
    END;
    
BEGIN
    v_tiempo_inicio := SYSTIMESTAMP;
    DBMS_OUTPUT.PUT_LINE('INICIA --->>>>>>>>   ' || TO_CHAR(SYSDATE, 'DD/MM/YYYY HH24:MI:SS'));
    
    --------------------------------------------------------------------------------------------------------------
    -- Inicialización y configuración del proceso
    --------------------------------------------------------------------------------------------------------------
    -- Obtener ID de proceso de carga
    BEGIN
        SELECT ID_CTRL_PROC_CARG 
        INTO v_id_proceso_carga 
        FROM EQVSYS.TMP_EMPL_CTRL_PROC_CARG_TMP;
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20001, 'No se encontró ID de proceso de carga');
    END;
    
    --1. Setear tabla origen y destino.
    v_tab_ori := 'T3726PADRUC';
    v_tab_des := 'REL_SEDE_DIRE';
    
    -- Obtener ID de detalle de proceso
    BEGIN
        SELECT ID_CTRL_PROC_CARG_DETA, FE_MIN_RANG_CARG, FE_MAX_RANG_CARG    
        INTO v_id_detalle_proceso, v_fecha_inicio, v_fecha_inicio
        FROM (
            SELECT ID_CTRL_PROC_CARG_DETA, FE_MIN_RANG_CARG, FE_MAX_RANG_CARG
            FROM EQVSYS.TMP_AUX_CTRL_PROC_CARG_DETA
            WHERE DE_TABLA_DESTINO = v_tab_des 
            AND DE_TABLA_ORIG = v_tab_ori 
            AND ID_CTRL_PROC_CARG = v_id_proceso_carga
            ORDER BY ID_CTRL_PROC_CARG_DETA DESC
        )
        WHERE ROWNUM = 1;
        DBMS_OUTPUT.PUT_LINE('ID de detalle de proceso: ' || v_id_detalle_proceso);
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20002, 'No se encontró detalle de proceso de carga');
    END;
    
    -- Registrar inicio de proceso
    registrar_evento(
        v_id_proceso_carga, 
        v_id_detalle_proceso, 
        'Inicio de carga de sedes principales ' || TO_CHAR(SYSDATE, 'DD/MM/YYYY HH24:MI:SS')
    );
    
    -- Obtener ID de origen de dirección SUNAT
    BEGIN
        SELECT ID_PARM INTO v_id_origen_direccion 
        FROM BDISYS.CAT_PARM 
        WHERE ID_PARM_PADR IN (
            SELECT ID_PARM 
            FROM BDISYS.CAT_PARM 
            WHERE CO_PARM = 'PARM_ORIN_DIRE'
        ) AND CO_PARM = 'PARM_DIRE_SUNAT';
        DBMS_OUTPUT.PUT_LINE('ID de origen dirección SUNAT: ' || v_id_origen_direccion);
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20003, 'No se encontró origen de dirección SUNAT');
    END;
    
    --------------------------------------------------------------------------------------------------------
    -- Procesamiento principal: inserción y actualización de rel_sede_dir y rel_sede_dir_adic
    --------------------------------------------------------------------------------------------------------
    BEGIN
        -- Variables para procesamiento por lotes
        DECLARE
            l_registros         t_tabla_sedes;
            l_limite            CONSTANT PLS_INTEGER := 1000; -- Reducido de 5000 a 1000 para mejor rendimiento
            l_desplazamiento    PLS_INTEGER := 0;
            l_iteracion         PLS_INTEGER := 0;
            l_insertados_batch  PLS_INTEGER := 0;
            l_adic_batch        PLS_INTEGER := 0;
            l_actualizados_batch PLS_INTEGER := 0;
            l_observados_batch  PLS_INTEGER := 0;
            l_ultimo_commit     PLS_INTEGER := 0;
            l_query_inicio      TIMESTAMP;
            l_query_fin         TIMESTAMP;
        BEGIN
            -- Obtener total de registros
            SELECT COUNT(*) INTO l_total_registros
            FROM eqvsys.TMP_EMPL_REL_SEDE_DIRE_PRI1;
            
            DBMS_OUTPUT.PUT_LINE('Total de registros a procesar: ' || l_total_registros);
            DBMS_OUTPUT.PUT_LINE('Tamaño de lote: ' || l_limite);
            
            -- Registrar evento de carga
            registrar_evento(
                v_id_proceso_carga, 
                v_id_detalle_proceso, 
                'Total registros a procesar: ' || l_total_registros
            );
    
            -- Procesamiento por lotes
            WHILE l_desplazamiento < l_total_registros LOOP
                l_iteracion := l_iteracion + 1;
                l_query_inicio := SYSTIMESTAMP;
                
                -- Reiniciar contadores de lote
                l_insertados_batch := 0;
                l_adic_batch := 0;
                l_actualizados_batch := 0;
                l_observados_batch := 0;
                
                BEGIN
                    -- Selección de registros por lotes compatible con versiones anteriores de Oracle
                    SELECT ID_PERS, NUM_RUC, ID_SEDE_N, ID_DIRE_N, FEC_ACTREG_SUNA 
                    BULK COLLECT INTO l_registros
                    FROM (
                        SELECT x.*, ROWNUM rn
                        FROM (
                            SELECT ID_PERS, NUM_RUC, ID_SEDE_N, ID_DIRE_N, FEC_ACTREG_SUNA
                            FROM eqvsys.TMP_EMPL_REL_SEDE_DIRE_PRI1
                            ORDER BY ID_PERS, ID_SEDE_N, ID_DIRE_N
                        ) x
                        WHERE ROWNUM <= l_desplazamiento + l_limite
                    )
                    WHERE rn > l_desplazamiento;
                    
                    l_query_fin := SYSTIMESTAMP;
                    DBMS_OUTPUT.PUT_LINE('Lote ' || l_iteracion || ': Consulta completada en ' || 
                                        EXTRACT(SECOND FROM (l_query_fin - l_query_inicio)) || ' segundos');
                    
                    EXIT WHEN l_registros.COUNT = 0;
                    
                    -- Inserción masiva en REL_SEDE_DIRE con mejor manejo de errores
                    BEGIN
                        DBMS_OUTPUT.PUT_LINE('Lote ' || l_iteracion || ': Insertando ' || 
                                            l_registros.COUNT || ' registros en REL_SEDE_DIRE');
                        
                        FORALL i IN 1..l_registros.COUNT SAVE EXCEPTIONS
                        INSERT INTO BDISYS.REL_SEDE_DIRE (
                            ID_SEDE, ID_DIRE, FE_INI_VALI, 
                            IN_VERI_SEDE_DIRE, ID_ORIG_DIRE, 
                            IN_ACTI, ID_USUA_CREA, 
                            FE_USUA_CREA, DE_TERM_CREA
                        )
                        VALUES (
                            l_registros(i).id_sede_nueva, 
                            l_registros(i).id_dir_nueva, 
                            SYSDATE, '0', 
                            v_id_origen_direccion, '1', 
                            C_USUARIO_CARGA, 
                            v_fecha_inicio, 
                            C_TERMINAL_CARGA
                        );
                        
                        -- Registrar total de insertados en este lote
                        l_insertados_batch := SQL%ROWCOUNT;
                        v_total_insertados := v_total_insertados + l_insertados_batch;
                        
                        DBMS_OUTPUT.PUT_LINE('Lote ' || l_iteracion || ': Insertados en REL_SEDE_DIRE: ' || 
                                            l_insertados_batch || ' registros');
                        
                    EXCEPTION
                        WHEN OTHERS THEN
                            -- Registrar errores específicos para la inserción en REL_SEDE_DIRE
                            DBMS_OUTPUT.PUT_LINE('Error en inserción REL_SEDE_DIRE: ' || SQLERRM);
                            
                            -- Procesamiento de errores bulk
                            FOR j IN 1..SQL%BULK_EXCEPTIONS.COUNT LOOP
                                v_mensaje_error := SQLERRM(-SQL%BULK_EXCEPTIONS(j).ERROR_CODE);
                                v_id_sede_n := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_sede_nueva, 0);
                                v_id_dire_n := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_dir_nueva, 0);
                                v_num_ruc := l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).num_ruc;
                                v_id_pers := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_persona, 0);
                                v_fec_actreg_suna := l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).fecha_registro;
                                
                                v_de_obs := SUBSTR('Error REL_SEDE_DIRE - ID_SEDE: ' || v_id_sede_n || 
                                                 ', ID_DIRE: ' || v_id_dire_n || ' - ' || v_mensaje_error, 1, 500);
                                
                                -- Registrar error en log
                                INSERT INTO EQVSYS.TMP_AUX_LOG_ERRO_ALER(
                                    ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_REG_DEST, ID_REG_ORIG,
                                    DE_OBS, ID_EMPL, NUM_RUC, FEC_ACTREG, TI_OPER,
                                    ID_USUA_CREA, FE_USUA_CREA, DE_TERM_CREA
                                ) VALUES (
                                    v_id_proceso_carga, v_id_detalle_proceso,
                                    'SEDE:' || v_id_sede_n || ',DIRE:' || v_id_dire_n,
                                    'RUC:' || v_num_ruc, v_de_obs, v_id_pers, v_num_ruc,
                                    v_fec_actreg_suna, 'INS', C_USUARIO_CARGA, v_fecha_inicio, C_TERMINAL_CARGA
                                );
                                
                                l_observados_batch := l_observados_batch + 1;
                            END LOOP;
                            
                            v_total_observados := v_total_observados + l_observados_batch;
                    END;
                                   
                    -- Inserción en REL_SEDE_DIRE_ADIC CON MANEJO DE ERRORES
                    BEGIN
                        DBMS_OUTPUT.PUT_LINE('Lote ' || l_iteracion || ': Insertando en REL_SEDE_DIRE_ADIC');
                        
                        FORALL i IN 1..l_registros.COUNT SAVE EXCEPTIONS
                        INSERT INTO bdisys.REL_SEDE_DIRE_ADIC (
                            ID_EMPL, ID_SEDE, ID_DIRE, 
                            NUM_RUC, IN_ES_PRINC, 
                            FEC_ACTREG_SUNA, ID_HABI, 
                            DES_NUMLIC, IN_ACTI, 
                            ID_USUA_CREA, FE_USUA_CREA, 
                            DE_TERM_CREA
                        )
                        VALUES (
                            l_registros(i).id_persona, 
                            l_registros(i).id_sede_nueva, 
                            l_registros(i).id_dir_nueva, 
                            l_registros(i).num_ruc, 
                            '1', 
                            l_registros(i).fecha_registro, 
                            '1', 
                            NULL, 
                            '1', 
                            C_USUARIO_CARGA, 
                            v_fecha_inicio, 
                            C_TERMINAL_CARGA
                        );
                        
                        -- Registrar total insertados en ADIC
                        l_adic_batch := SQL%ROWCOUNT;
                        v_total_insertados_adic := v_total_insertados_adic + l_adic_batch;
                        
                        DBMS_OUTPUT.PUT_LINE('Lote ' || l_iteracion || ': Insertados en REL_SEDE_DIRE_ADIC: ' || 
                                           l_adic_batch || ' registros');
                    EXCEPTION
                        WHEN OTHERS THEN
                            -- Registrar errores específicos para la inserción en REL_SEDE_DIRE_ADIC
                            DBMS_OUTPUT.PUT_LINE('Error en inserción REL_SEDE_DIRE_ADIC: ' || SQLERRM);
                            
                            -- Procesamiento de errores bulk
                            FOR j IN 1..SQL%BULK_EXCEPTIONS.COUNT LOOP
                                v_mensaje_error := SQLERRM(-SQL%BULK_EXCEPTIONS(j).ERROR_CODE);
                                v_id_sede_n := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_sede_nueva, 0);
                                v_id_dire_n := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_dir_nueva, 0);
                                v_num_ruc := l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).num_ruc;
                                v_id_pers := NVL(l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).id_persona, 0);
                                v_fec_actreg_suna := l_registros(SQL%BULK_EXCEPTIONS(j).ERROR_INDEX).fecha_registro;
                                
                                v_de_obs := SUBSTR('Error REL_SEDE_DIRE_ADIC - ID_SEDE: ' || v_id_sede_n || 
                                                 ', ID_DIRE: ' || v_id_dire_n || ' - ' || v_mensaje_error, 1, 500);
                                
                                -- Registrar error en log
                                INSERT INTO EQVSYS.TMP_AUX_LOG_ERRO_ALER(
                                    ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_REG_DEST, ID_REG_ORIG,
                                    DE_OBS, ID_EMPL, NUM_RUC, FEC_ACTREG, TI_OPER,
                                    ID_USUA_CREA, FE_USUA_CREA, DE_TERM_CREA
                                ) VALUES (
                                    v_id_proceso_carga, v_id_detalle_proceso,
                                    'SEDE:' || v_id_sede_n || ',DIRE:' || v_id_dire_n,
                                    'RUC:' || v_num_ruc, v_de_obs, v_id_pers, v_num_ruc,
                                    v_fec_actreg_suna, 'INS', C_USUARIO_CARGA, v_fecha_inicio, C_TERMINAL_CARGA
                                );
                                
                                l_observados_batch := l_observados_batch + 1;
                            END LOOP;
                            
                            v_total_observados := v_total_observados + l_observados_batch;
                    END;
\(9)\(9)\(9)\(9)\(9)
\(9)\(9)\(9)\(9)\(9)-- Commit después de los 2 procesos principales
                    COMMIT;
\(9)\(9)\(9)\(9)\(9)-- Registrar detalles de carga exitosa
                    BEGIN
                        FORALL i IN 1..l_registros.COUNT
                        INSERT INTO EQVSYS.TMP_AUX_DETA_CARG_POR_REGI(
                            ID_CTRL_PROC_CARG, ID_CTRL_PROC_CARG_DETA, ID_REG_DEST, ID_REG_ORIG, 
                            TI_OPER, ID_EMPL, NUM_RUC, FEC_ACTREG, 
                            ID_USUA_CREA, FE_USUA_CREA, DE_TERM_CREA
                        ) VALUES (
                            v_id_proceso_carga, v_id_detalle_proceso,
                            l_registros(i).id_persona, '|ruc:' || l_registros(i).NUM_RUC,
                            'UPD', l_registros(i).id_persona, l_registros(i).NUM_RUC,
                            l_registros(i).fecha_registro, C_USUARIO_CARGA, SYSDATE, C_TERMINAL_CARGA
                        );
                    EXCEPTION
                        WHEN OTHERS THEN
                            DBMS_OUTPUT.PUT_LINE('Error al registrar detalles de carga: ' || SQLERRM);
                    END;
                    
\(9)\(9)\(9)\(9)\(9)
                    -- Actualizar otras sedes del mismo empleador
                    BEGIN
                        DBMS_OUTPUT.PUT_LINE('Lote ' || l_iteracion || ': Actualizando otras sedes');
                        
                        FORALL i IN 1..l_registros.COUNT --SAVE EXCEPTIONS
                        UPDATE bdisys.REL_SEDE_DIRE_ADIC rsda
                        SET 
                            rsda.ID_HABI = 0,
                            rsda.ID_USUA_MODI = C_USUARIO_CARGA,
                            rsda.FE_USUA_MODI = SYSDATE,
                            rsda.DE_TERM_MODI = C_TERMINAL_CARGA
                        WHERE 
                            rsda.ID_EMPL = l_registros(i).id_persona AND
                            (
                                (rsda.ID_SEDE = l_registros(i).id_sede_nueva AND 
                                 rsda.ID_DIRE <> l_registros(i).id_dir_nueva) OR
                                (rsda.ID_SEDE <> l_registros(i).id_sede_nueva)
                            ) AND
                            rsda.ID_HABI = 1 AND
                            rsda.IN_ACTI = 1 AND
\(9)\(9)\(9)\(9)\(9)\(9)\(9)rsda.IN_ES_PRINC = '1';
\(9)\(9)\(9)\(9)\(9)\(9)\(9)
                        -- Registrar total actualizados
                        l_actualizados_batch := SQL%ROWCOUNT;
                        v_total_actualizados := v_total_actualizados + l_actualizados_batch;
                        
                        DBMS_OUTPUT.PUT_LINE('Lote ' || l_iteracion || ': Actualizados en otras sedes: ' || 
                                           l_actualizados_batch || ' registros');
                    EXCEPTION
                        WHEN OTHERS THEN
                            -- Registrar errores específicos para la actualización
                            DBMS_OUTPUT.PUT_LINE('Error en actualización otras sedes: ' || SQLERRM);                            
                    END;
                    
                    -- Commit después de los 2 procesos complementarios
                    COMMIT;
                    
                    -- Imprimir resumen de este lote
                    DBMS_OUTPUT.PUT_LINE('Resumen Lote ' || l_iteracion || ': ' ||
                                       'Insertados REL_SEDE_DIRE=' || l_insertados_batch ||
                                       ', Insertados REL_SEDE_DIRE_ADIC=' || l_adic_batch ||
                                       ', Actualizados=' || l_actualizados_batch ||
                                       ', Observados=' || l_observados_batch);
                    
                    -- Siguiente lote
                    l_desplazamiento := l_desplazamiento + l_limite;
                    
                    -- Registrar progreso cada 5 lotes o al final
                    IF (MOD(l_iteracion, 5) = 0) OR (l_desplazamiento >= l_total_registros) THEN
                        registrar_evento(
                            v_id_proceso_carga, 
                            v_id_detalle_proceso, 
                            'Progreso: ' || l_desplazamiento || '/' || l_total_registros || 
                            ' registros (' || ROUND((l_desplazamiento/l_total_registros)*100) || 
                            '%). Insertados=' || v_total_insertados || 
                            ', Observados=' || v_total_observados
                        );
                    END IF;
                    
                EXCEPTION
                    WHEN OTHERS THEN
                        -- Manejo general de errores para todo el lote
                        DBMS_OUTPUT.PUT_LINE('Error general en lote ' || l_iteracion || ': ' || SQLERRM);
                        registrar_evento(
                            v_id_proceso_carga, 
                            v_id_detalle_proceso, 
                            'Error en lote ' || l_iteracion || ': ' || SUBSTR(SQLERRM, 1, 300)
                        );
                                              
                        -- Commit para guardar los logs de error
                        COMMIT;
                END;
            END LOOP;
            
            -- Estadísticas finales
            DBMS_OUTPUT.PUT_LINE('--------------------------------------------------');
            DBMS_OUTPUT.PUT_LINE('ESTADÍSTICAS DE PROCESAMIENTO:');
            DBMS_OUTPUT.PUT_LINE('Total registros procesados: ' || l_total_registros);
            DBMS_OUTPUT.PUT_LINE('Registros insertados en REL_SEDE_DIRE: ' || v_total_insertados);
            DBMS_OUTPUT.PUT_LINE('Registros insertados en REL_SEDE_DIRE_ADIC: ' || v_total_insertados_adic);
            DBMS_OUTPUT.PUT_LINE('Registros actualizados: ' || v_total_actualizados);
            DBMS_OUTPUT.PUT_LINE('Registros con observaciones: ' || v_total_observados);
        END;
    END;
    
     ------------------------------------------------------------------------------------------------------------------------------------------------------
    -- Reconstruyendo historico de direcciones (de BDI) : Si existian en REL_SEDE_DIRE y NO existian en REL_SEDE_DIRE_ADIC las insertamos Inabilitadas.\(9)
    ------------------------------------------------------------------------------------------------------------------------------------------------------
    BEGIN
\(9)\(9)DBMS_OUTPUT.PUT_LINE(' Reconstruyendo historico de direcciones');        
        INSERT INTO bdisys.REL_SEDE_DIRE_ADIC 
\(9)\(9)\(9)(ID_EMPL, ID_SEDE, ID_DIRE, NUM_RUC, IN_ES_PRINC, FEC_ACTREG_SUNA, ID_HABI, DES_NUMLIC, IN_ACTI, ID_USUA_CREA, FE_USUA_CREA, DE_TERM_CREA)\(9)\(9)\(9)\(9)   
\(9)\(9)SELECT\(9)--s.REG_SEDE_PART
             s.ID_PERS
\(9)\(9)\(9), s.ID_SEDE
\(9)\(9)\(9), rsd.ID_DIRE
            , s.NUM_RUC
\(9)\(9)\(9),'1'
            , s.FEC_ACTREG_SUNA
\(9)\(9)\(9),'0' ---*
\(9)\(9)\(9), NULL
\(9)\(9)\(9), '1'
            , C_USUARIO_CARGA
\(9)\(9)\(9), SYSDATE
\(9)\(9)\(9), C_TERMINAL_CARGA
            FROM eqvsys.TMP_EMPL_AUX_SEDE_PRI2 s
            INNER JOIN bdisys.REL_SEDE_DIRE rsd ON rsd.ID_SEDE = s.ID_SEDE 
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)--AND rsd.ID_DIRE = d.ID_DIRE 
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)AND rsd.IN_ACTI = 1
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)--AND s.REG_SEDE_PART > 1
\(9)\(9)\(9)LEFT JOIN bdisys.REL_SEDE_DIRE_ADIC rsda ON rsda.ID_SEDE = s.ID_SEDE 
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9) AND rsda.ID_DIRE = rsd.ID_DIRE 
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9) AND rsda.ID_EMPL = s.ID_PERS
\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9)\(9) AND rsda.IN_ACTI = 1
            WHERE rsda.ID_SEDE IS NULL;
            
            -- Obtener el número de filas insertadas
            v_insertedos_historico := SQL%ROWCOUNT;

            -- Mostrar el resultado
            DBMS_OUTPUT.PUT_LINE('--------------------------------------------------------------------------------');
            DBMS_OUTPUT.PUT_LINE('Registros insertados en reconstruccion de historico: ' || v_insertedos_historico);
                                
     EXCEPTION
           WHEN OTHERS THEN
           DBMS_OUTPUT.PUT_LINE('Error EN RECONSTRUCCION DE HIST - INSERCION EN REL_SEDE_DIRE_ADIC : ID_SEDE: ' ||  v_id_sede_n || SQLERRM);
     END; 
     
    -------------------------------------------------------------------------------------------------------------
    -- Control de carga (final)
    --------------------------------------------------------------------------------------------------------------
    -- Registrar finalización
     DBMS_OUTPUT.PUT_LINE('Registrar finalización');
    registrar_evento(
        v_id_proceso_carga, 
        v_id_detalle_proceso, 
        'Finalización de carga de sedes principales. ' || 
        'Insertados: ' || v_total_insertados || 
        'Observados: ' || v_total_observados
    );
    
 -- Registrar inicio de proceso
    registrar_evento(
        v_id_proceso_carga, 
        v_id_detalle_proceso, 
        'Inicio de carga de sedes principales' || 'FINALIZA >>>> ' || TO_CHAR(SYSDATE, 'DD/MM/YYYY HH24:MI:SS')
    );
    
    -- Actualizar estado del proceso
    DBMS_OUTPUT.PUT_LINE('Actualizar estado del proceso');
    UPDATE REPBDISYS.AUX_CTRL_PROC_CARG_DETA@DBL_BDQA19G7_REPBDISYS
    SET 
        IN_ESTA_PROC_DETA = CASE WHEN v_total_observados > 0 THEN '0' ELSE '1' END,
        CA_TOTL_MIGR = l_total_registros,
        un_totl_ingr = v_total_insertados,
        un_totl_obse = v_total_observados,
        fe_fin_carg_deta = SYSDATE,
        ID_USUA_MODI = C_USUARIO_CARGA,
        FE_USUA_MODI = SYSDATE,
        DE_TERM_MODI = C_TERMINAL_CARGA
    WHERE ID_CTRL_PROC_CARG_DETA = v_id_detalle_proceso;
    
    COMMIT;

DBMS_OUTPUT.PUT_LINE('TERMINA --->>>>>>>>   ' || TO_CHAR(SYSDATE, 'DD/MM/YYYY HH24:MI:SS'));

EXCEPTION
    WHEN OTHERS THEN
        -- Manejo de errores críticos
        BEGIN
            registrar_evento(
                v_id_proceso_carga, 
                v_id_detalle_proceso, 
                'Error crítico: ' || SUBSTR(SQLERRM, 1, 300)
            );
            
           
            COMMIT;
        EXCEPTION
            WHEN OTHERS THEN
                DBMS_OUTPUT.PUT_LINE('Error irrecuperable: ' || SQLERRM);
        END;

        DBMS_OUTPUT.PUT_LINE('WHEN OTHERS THEN errores');
        ROLLBACK;
       -- RAISE;       
END;]]><ReadFromFileBeforeSQL type='bool'><![CDATA[0]]></ReadFromFileBeforeSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQL><AfterSQL type='string'><![CDATA[]]><ReadFromFileAfterSQL type='bool'><![CDATA[0]]></ReadFromFileAfterSQL><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQL><BeforeSQLNode type='string'><![CDATA[]]><ReadFromFileBeforeSQLNode type='bool'><![CDATA[0]]></ReadFromFileBeforeSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></BeforeSQLNode><AfterSQLNode type='string'><![CDATA[]]><ReadFromFileAfterSQLNode type='bool'><![CDATA[0]]></ReadFromFileAfterSQLNode><FailOnError type='bool'><![CDATA[1]]></FailOnError></AfterSQLNode></BeforeAfter><ApplicationFailoverControl collapsed='1' type='bool'><![CDATA[0]]></ApplicationFailoverControl><LimitRows collapsed='1' type='bool'><![CDATA[0]]></LimitRows></Usage></Properties >
=+=+=+=
      END DSSUBRECORD
      NextRecordID "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V12S1P1"
      OLEType "CCustomOutput"
      Readonly "0"
      Name "lnk_ora_bdisys_mae_dir"
      Partner "V12S0|V12S0P1"
      Properties "CCustomProperty"
      BEGIN DSSUBRECORD
         Name "lookup\\type"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantName"
         Value "11"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantLibrary"
         Value "ccora11g"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "VariantVersion"
         Value "1.0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectFromLink"
         Value "-1"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectThreshold"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectNumber"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "RejectUsesPercentage"
         Value "false"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "ConnectorName"
         Value "OracleConnector"
      END DSSUBRECORD
      Columns "COutputColumn"
      BEGIN DSSUBRECORD
         Name "IN_PARM"
         SqlType "4"
         Precision "0"
         Scale "0"
         Nullable "0"
         KeyPosition "0"
         DisplaySize "0"
         Group "0"
         SortKey "0"
         SortType "0"
         AllowCRLF "0"
         LevelNo "0"
         Occurs "0"
         PadNulls "0"
         SignOption "0"
         SortingOrder "0"
         ArrayHandling "0"
         SyncIndicator "0"
         PadChar ""
         ExtendedPrecision "0"
         TaggedSubrec "0"
         OccursVarying "0"
         PKeyIsCaseless "0"
         SCDPurpose "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "DiskWriteInc"
         Value "1048576"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "BufFreeRun"
         Value "50"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "MaxMemBufSize"
         Value "3145728"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "QueueUpperSize"
         Value "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SchemaFormat"
      END DSSUBRECORD
      LeftTextPos "312"
      TopTextPos "144"
      LinkMinimised "0"
   END DSRECORD
END DSJOB
BEGIN DSJOB
   Identifier "SEQ_SEDE_PRINCIPAL"
   DateModified "2025-07-03"
   TimeModified "10.19.54"
   BEGIN DSRECORD
      Identifier "ROOT"
      OLEType "CJobDefn"
      Readonly "0"
      Name "SEQ_SEDE_PRINCIPAL"
      NextID "1"
      Container "V0"
      JobVersion "56.0.0"
      JobControlCode =+=+=+=
* Tokens were replaced below as follows:
* IdV0S0%%Result2%%0 <= J001_TRN_EMPL_AUX_SEDE_PRI_0001.$UserStatus
* IdV0S0%%Result1%%1 <= J001_TRN_EMPL_AUX_SEDE_PRI_0001.$JobStatus
* IdV0S0%%Name%%2 <= J001_TRN_EMPL_AUX_SEDE_PRI_0001.$JobName
* IdV0S1%%Result2%%3 <= J002_INS_EMPL_AUX_SEDE_PRI_0001.$UserStatus
* IdV0S1%%Result1%%4 <= J002_INS_EMPL_AUX_SEDE_PRI_0001.$JobStatus
* IdV0S1%%Name%%5 <= J002_INS_EMPL_AUX_SEDE_PRI_0001.$JobName
* IdV0S2%%Result2%%6 <= J003_TRN_EMPL_AUX_SEDE_PRI_0002.$UserStatus
* IdV0S2%%Result1%%7 <= J003_TRN_EMPL_AUX_SEDE_PRI_0002.$JobStatus
* IdV0S2%%Name%%8 <= J003_TRN_EMPL_AUX_SEDE_PRI_0002.$JobName
* IdV0S3%%Result2%%9 <= J004_INS_EMPL_AUX_VIA_0001.$UserStatus
* IdV0S3%%Result1%%10 <= J004_INS_EMPL_AUX_VIA_0001.$JobStatus
* IdV0S3%%Name%%11 <= J004_INS_EMPL_AUX_VIA_0001.$JobName
* IdV0S4%%Result2%%12 <= J005_INS_EMPL_AUX_ZONA_0001.$UserStatus
* IdV0S4%%Result1%%13 <= J005_INS_EMPL_AUX_ZONA_0001.$JobStatus
* IdV0S4%%Name%%14 <= J005_INS_EMPL_AUX_ZONA_0001.$JobName
* IdV0S8%%Result2%%15 <= J007_INS_EMPL_DIR_PRI_0001.$UserStatus
* IdV0S8%%Result1%%16 <= J007_INS_EMPL_DIR_PRI_0001.$JobStatus
* IdV0S8%%Name%%17 <= J007_INS_EMPL_DIR_PRI_0001.$JobName
* IdV0S9%%Result2%%18 <= J008_TRN_EMPL_MAE_DIR_PRI_0002.$UserStatus
* IdV0S9%%Result1%%19 <= J008_TRN_EMPL_MAE_DIR_PRI_0002.$JobStatus
* IdV0S9%%Name%%20 <= J008_TRN_EMPL_MAE_DIR_PRI_0002.$JobName
* IdV0S56%%Result2%%21 <= J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001.$UserStatus
* IdV0S56%%Result1%%22 <= J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001.$JobStatus
* IdV0S56%%Name%%23 <= J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001.$JobName
* IdV0S57%%Result2%%24 <= J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001.$UserStatus
* IdV0S57%%Result1%%25 <= J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001.$JobStatus
* IdV0S57%%Name%%26 <= J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001.$JobName
* IdV0S61%%Result2%%27 <= J006_TRN_EMPL_MAE_DIRE_PRI_0001.$UserStatus
* IdV0S61%%Result1%%28 <= J006_TRN_EMPL_MAE_DIRE_PRI_0001.$JobStatus
* IdV0S61%%Name%%29 <= J006_TRN_EMPL_MAE_DIRE_PRI_0001.$JobName
*
*** [Generated at 2025-07-03 10:19:47 - 11.5.0.0]
   $INCLUDE DSINCLUDE DSJ_XFUNCS.H
   EQU Time$$ Lit "Oconv(Time(), 'MTS:'):': '"
****************************************
* Graphical Sequencer generated code for Job SEQ_SEDE_PRINCIPAL
****************************************
   
   seq$V0S5$count = 0
   seq$V0S5$status = 0
   seq$V0S6$count = 0
   seq$V0S6$status = 0
   seq$V0S10$count = 0
   seq$V0S10$status = 0
   seq$V0S28$count = 0
   seq$V0S28$status = 0
   handle$list = ""
   id$list = ""
   abort$list = ""
   b$Abandoning = @False
   summary$restarting = @False
*** Sequence start point
   summary$ = DSMakeMsg("DSTAGE_JSG_M_0048\\Summary of sequence run", "")
   If summary$restarting Then
      summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0049\\Sequence restarted after failure", ""))
   End Else
      summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0051\\Sequence started", ""))
   End
   GoTo L$V0S0$START
L$RETURN$1:
   GoTo L$WAITFORJOB
**************************************************
L$V0S0$START:
*** Activity "J001_TRN_EMPL_AUX_SEDE_PRI_0001": Initialize job
   h$V0S0 = DSAttachJob("J001_TRN_EMPL_AUX_SEDE_PRI_0001", DSJ.ERRNONE)
   If (Not(h$V0S0)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", "J001_TRN_EMPL_AUX_SEDE_PRI_0001":@FM:DSGetLastErrorMsg())
      msg$id = "@J001_TRN_EMPL_AUX_SEDE_PRI_0001"; GoTo L$ERROR
   End
   If DSGetJobInfo(h$V0S0, DSJ.JOBMULTIINVOKABLE) Then
      jb$V0S0 = "J001_TRN_EMPL_AUX_SEDE_PRI_0001":'.':"J001_TRN_EMPL_AUX_SEDE_PRI_0001"
   End Else
      jb$V0S0 = "J001_TRN_EMPL_AUX_SEDE_PRI_0001"
   End
   dummy$ = DSDetachJob(h$V0S0)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0057\\%1 (JOB %2) started", "J001_TRN_EMPL_AUX_SEDE_PRI_0001":@FM:jb$V0S0))
   h$V0S0 = DSAttachJob(jb$V0S0, DSJ.ERRNONE)
   If (Not(h$V0S0)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", jb$V0S0:@FM:DSGetLastErrorMsg())
      msg$id = "@J001_TRN_EMPL_AUX_SEDE_PRI_0001"; GoTo L$ERROR
   End
   p$V0S0$1 = "(As pre-defined)"
   err$code = DSSetParam(h$V0S0, "PRM_ORA_CONE_MAE_EMPL", p$V0S0$1)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0002\\Error calling DSSetParam(%1), code=%2[E]", "PRM_ORA_CONE_MAE_EMPL":@FM:err$code)
      msg$id = "@J001_TRN_EMPL_AUX_SEDE_PRI_0001"; GoTo L$ERROR
   End
   err$code = DSRunJob(h$V0S0, DSJ.RUNNORMAL)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0003\\Error calling DSRunJob(%1), code=%2[E]", jb$V0S0:@FM:err$code)
      msg$id = "@J001_TRN_EMPL_AUX_SEDE_PRI_0001"; GoTo L$ERROR
   End
   handle$list<-1> = h$V0S0
   id$list<-1> = "V0S0"
   GoTo L$RETURN$1
**************************************************
L$V0S0$FINISHED:
   job$V0S0$status = DSGetJobInfo(h$V0S0, DSJ.JOBSTATUS)
   job$V0S0$userstatus = DSGetJobInfo(h$V0S0, DSJ.USERSTATUS)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0063\\%1 (JOB %2) finished, status=%3[E]", "J001_TRN_EMPL_AUX_SEDE_PRI_0001":@FM:jb$V0S0:@FM:job$V0S0$status))
   IdV0S0%%Result2%%0 = job$V0S0$userstatus
   IdV0S0%%Result1%%1 = job$V0S0$status
   IdV0S0%%Name%%2 = jb$V0S0
   dummy$ = DSDetachJob(h$V0S0)
   If b$Abandoning Then GoTo L$WAITFORJOB
   If (job$V0S0$status <> DSJS.RUNOK And job$V0S0$status <> DSJS.RUNWARN) Then GoTo L$V0S30$START
L$V0S0$RETURN$1:
   If (job$V0S0$status = DSJS.RUNOK) Then GoTo L$V0S1$START
L$V0S0$RETURN$2:
   GoTo L$WAITFORJOB
**************************************************
L$V0S1$START:
*** Activity "J002_INS_EMPL_AUX_SEDE_PRI_0001": Initialize job
   h$V0S1 = DSAttachJob("J002_INS_EMPL_AUX_SEDE_PRI_0001", DSJ.ERRNONE)
   If (Not(h$V0S1)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", "J002_INS_EMPL_AUX_SEDE_PRI_0001":@FM:DSGetLastErrorMsg())
      msg$id = "@J002_INS_EMPL_AUX_SEDE_PRI_0001"; GoTo L$ERROR
   End
   If DSGetJobInfo(h$V0S1, DSJ.JOBMULTIINVOKABLE) Then
      jb$V0S1 = "J002_INS_EMPL_AUX_SEDE_PRI_0001":'.':"J002_INS_EMPL_AUX_SEDE_PRI_0001"
   End Else
      jb$V0S1 = "J002_INS_EMPL_AUX_SEDE_PRI_0001"
   End
   dummy$ = DSDetachJob(h$V0S1)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0057\\%1 (JOB %2) started", "J002_INS_EMPL_AUX_SEDE_PRI_0001":@FM:jb$V0S1))
   h$V0S1 = DSAttachJob(jb$V0S1, DSJ.ERRNONE)
   If (Not(h$V0S1)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", jb$V0S1:@FM:DSGetLastErrorMsg())
      msg$id = "@J002_INS_EMPL_AUX_SEDE_PRI_0001"; GoTo L$ERROR
   End
   p$V0S1$1 = "(As pre-defined)"
   err$code = DSSetParam(h$V0S1, "PRM_ORA_CONE_MAE_EMPL", p$V0S1$1)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0002\\Error calling DSSetParam(%1), code=%2[E]", "PRM_ORA_CONE_MAE_EMPL":@FM:err$code)
      msg$id = "@J002_INS_EMPL_AUX_SEDE_PRI_0001"; GoTo L$ERROR
   End
   err$code = DSRunJob(h$V0S1, DSJ.RUNNORMAL)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0003\\Error calling DSRunJob(%1), code=%2[E]", jb$V0S1:@FM:err$code)
      msg$id = "@J002_INS_EMPL_AUX_SEDE_PRI_0001"; GoTo L$ERROR
   End
   handle$list<-1> = h$V0S1
   id$list<-1> = "V0S1"
   GoTo L$V0S0$RETURN$2
**************************************************
L$V0S1$FINISHED:
   job$V0S1$status = DSGetJobInfo(h$V0S1, DSJ.JOBSTATUS)
   job$V0S1$userstatus = DSGetJobInfo(h$V0S1, DSJ.USERSTATUS)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0063\\%1 (JOB %2) finished, status=%3[E]", "J002_INS_EMPL_AUX_SEDE_PRI_0001":@FM:jb$V0S1:@FM:job$V0S1$status))
   IdV0S1%%Result2%%3 = job$V0S1$userstatus
   IdV0S1%%Result1%%4 = job$V0S1$status
   IdV0S1%%Name%%5 = jb$V0S1
   dummy$ = DSDetachJob(h$V0S1)
   If b$Abandoning Then GoTo L$WAITFORJOB
   If (job$V0S1$status <> DSJS.RUNOK And job$V0S1$status <> DSJS.RUNWARN) Then GoTo L$V0S31$START
L$V0S1$RETURN$1:
   If (job$V0S1$status = DSJS.RUNOK) Then GoSub L$V0S5$START
   GoTo L$WAITFORJOB
**************************************************
L$V0S2$START:
*** Activity "J003_TRN_EMPL_AUX_SEDE_PRI_0002": Initialize job
   h$V0S2 = DSAttachJob("J003_TRN_EMPL_AUX_SEDE_PRI_0002", DSJ.ERRNONE)
   If (Not(h$V0S2)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", "J003_TRN_EMPL_AUX_SEDE_PRI_0002":@FM:DSGetLastErrorMsg())
      msg$id = "@J003_TRN_EMPL_AUX_SEDE_PRI_0002"; GoTo L$ERROR
   End
   If DSGetJobInfo(h$V0S2, DSJ.JOBMULTIINVOKABLE) Then
      jb$V0S2 = "J003_TRN_EMPL_AUX_SEDE_PRI_0002":'.':"J003_TRN_EMPL_AUX_SEDE_PRI_0002"
   End Else
      jb$V0S2 = "J003_TRN_EMPL_AUX_SEDE_PRI_0002"
   End
   dummy$ = DSDetachJob(h$V0S2)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0057\\%1 (JOB %2) started", "J003_TRN_EMPL_AUX_SEDE_PRI_0002":@FM:jb$V0S2))
   h$V0S2 = DSAttachJob(jb$V0S2, DSJ.ERRNONE)
   If (Not(h$V0S2)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", jb$V0S2:@FM:DSGetLastErrorMsg())
      msg$id = "@J003_TRN_EMPL_AUX_SEDE_PRI_0002"; GoTo L$ERROR
   End
   p$V0S2$1 = "(As pre-defined)"
   err$code = DSSetParam(h$V0S2, "PRM_ORA_CONE_MAE_EMPL", p$V0S2$1)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0002\\Error calling DSSetParam(%1), code=%2[E]", "PRM_ORA_CONE_MAE_EMPL":@FM:err$code)
      msg$id = "@J003_TRN_EMPL_AUX_SEDE_PRI_0002"; GoTo L$ERROR
   End
   err$code = DSRunJob(h$V0S2, DSJ.RUNNORMAL)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0003\\Error calling DSRunJob(%1), code=%2[E]", jb$V0S2:@FM:err$code)
      msg$id = "@J003_TRN_EMPL_AUX_SEDE_PRI_0002"; GoTo L$ERROR
   End
   handle$list<-1> = h$V0S2
   id$list<-1> = "V0S2"
   GoTo L$V0S5$RETURN$3
**************************************************
L$V0S2$FINISHED:
   job$V0S2$status = DSGetJobInfo(h$V0S2, DSJ.JOBSTATUS)
   job$V0S2$userstatus = DSGetJobInfo(h$V0S2, DSJ.USERSTATUS)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0063\\%1 (JOB %2) finished, status=%3[E]", "J003_TRN_EMPL_AUX_SEDE_PRI_0002":@FM:jb$V0S2:@FM:job$V0S2$status))
   IdV0S2%%Result2%%6 = job$V0S2$userstatus
   IdV0S2%%Result1%%7 = job$V0S2$status
   IdV0S2%%Name%%8 = jb$V0S2
   dummy$ = DSDetachJob(h$V0S2)
   If b$Abandoning Then GoTo L$WAITFORJOB
   If (job$V0S2$status <> DSJS.RUNOK And job$V0S2$status <> DSJS.RUNWARN) Then GoTo L$V0S32$START
L$V0S2$RETURN$1:
   If (job$V0S2$status = DSJS.RUNOK) Then GoSub L$V0S10$START
   GoTo L$WAITFORJOB
**************************************************
L$V0S3$START:
*** Activity "J004_INS_EMPL_AUX_VIA_0001": Initialize job
   h$V0S3 = DSAttachJob("J004_INS_EMPL_AUX_VIA_0001", DSJ.ERRNONE)
   If (Not(h$V0S3)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", "J004_INS_EMPL_AUX_VIA_0001":@FM:DSGetLastErrorMsg())
      msg$id = "@J004_INS_EMPL_AUX_VIA_0001"; GoTo L$ERROR
   End
   If DSGetJobInfo(h$V0S3, DSJ.JOBMULTIINVOKABLE) Then
      jb$V0S3 = "J004_INS_EMPL_AUX_VIA_0001":'.':"J004_INS_EMPL_AUX_VIA_0001"
   End Else
      jb$V0S3 = "J004_INS_EMPL_AUX_VIA_0001"
   End
   dummy$ = DSDetachJob(h$V0S3)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0057\\%1 (JOB %2) started", "J004_INS_EMPL_AUX_VIA_0001":@FM:jb$V0S3))
   h$V0S3 = DSAttachJob(jb$V0S3, DSJ.ERRNONE)
   If (Not(h$V0S3)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", jb$V0S3:@FM:DSGetLastErrorMsg())
      msg$id = "@J004_INS_EMPL_AUX_VIA_0001"; GoTo L$ERROR
   End
   p$V0S3$1 = "(As pre-defined)"
   err$code = DSSetParam(h$V0S3, "PRM_ORA_CONE_MAE_EMPL", p$V0S3$1)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0002\\Error calling DSSetParam(%1), code=%2[E]", "PRM_ORA_CONE_MAE_EMPL":@FM:err$code)
      msg$id = "@J004_INS_EMPL_AUX_VIA_0001"; GoTo L$ERROR
   End
   err$code = DSRunJob(h$V0S3, DSJ.RUNNORMAL)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0003\\Error calling DSRunJob(%1), code=%2[E]", jb$V0S3:@FM:err$code)
      msg$id = "@J004_INS_EMPL_AUX_VIA_0001"; GoTo L$ERROR
   End
   handle$list<-1> = h$V0S3
   id$list<-1> = "V0S3"
   GoTo L$V0S5$RETURN$2
**************************************************
L$V0S3$FINISHED:
   job$V0S3$status = DSGetJobInfo(h$V0S3, DSJ.JOBSTATUS)
   job$V0S3$userstatus = DSGetJobInfo(h$V0S3, DSJ.USERSTATUS)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0063\\%1 (JOB %2) finished, status=%3[E]", "J004_INS_EMPL_AUX_VIA_0001":@FM:jb$V0S3:@FM:job$V0S3$status))
   IdV0S3%%Result2%%9 = job$V0S3$userstatus
   IdV0S3%%Result1%%10 = job$V0S3$status
   IdV0S3%%Name%%11 = jb$V0S3
   dummy$ = DSDetachJob(h$V0S3)
   If b$Abandoning Then GoTo L$WAITFORJOB
   GoSub L$V0S6$START
   GoTo L$WAITFORJOB
**************************************************
L$V0S4$START:
*** Activity "J005_INS_EMPL_AUX_ZONA_0001": Initialize job
   h$V0S4 = DSAttachJob("J005_INS_EMPL_AUX_ZONA_0001", DSJ.ERRNONE)
   If (Not(h$V0S4)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", "J005_INS_EMPL_AUX_ZONA_0001":@FM:DSGetLastErrorMsg())
      msg$id = "@J005_INS_EMPL_AUX_ZONA_0001"; GoTo L$ERROR
   End
   If DSGetJobInfo(h$V0S4, DSJ.JOBMULTIINVOKABLE) Then
      jb$V0S4 = "J005_INS_EMPL_AUX_ZONA_0001":'.':"J005_INS_EMPL_AUX_ZONA_0001"
   End Else
      jb$V0S4 = "J005_INS_EMPL_AUX_ZONA_0001"
   End
   dummy$ = DSDetachJob(h$V0S4)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0057\\%1 (JOB %2) started", "J005_INS_EMPL_AUX_ZONA_0001":@FM:jb$V0S4))
   h$V0S4 = DSAttachJob(jb$V0S4, DSJ.ERRNONE)
   If (Not(h$V0S4)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", jb$V0S4:@FM:DSGetLastErrorMsg())
      msg$id = "@J005_INS_EMPL_AUX_ZONA_0001"; GoTo L$ERROR
   End
   p$V0S4$1 = "(As pre-defined)"
   err$code = DSSetParam(h$V0S4, "PRM_ORA_CONE_MAE_EMPL", p$V0S4$1)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0002\\Error calling DSSetParam(%1), code=%2[E]", "PRM_ORA_CONE_MAE_EMPL":@FM:err$code)
      msg$id = "@J005_INS_EMPL_AUX_ZONA_0001"; GoTo L$ERROR
   End
   err$code = DSRunJob(h$V0S4, DSJ.RUNNORMAL)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0003\\Error calling DSRunJob(%1), code=%2[E]", jb$V0S4:@FM:err$code)
      msg$id = "@J005_INS_EMPL_AUX_ZONA_0001"; GoTo L$ERROR
   End
   handle$list<-1> = h$V0S4
   id$list<-1> = "V0S4"
   GoTo L$V0S5$RETURN$1
**************************************************
L$V0S4$FINISHED:
   job$V0S4$status = DSGetJobInfo(h$V0S4, DSJ.JOBSTATUS)
   job$V0S4$userstatus = DSGetJobInfo(h$V0S4, DSJ.USERSTATUS)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0063\\%1 (JOB %2) finished, status=%3[E]", "J005_INS_EMPL_AUX_ZONA_0001":@FM:jb$V0S4:@FM:job$V0S4$status))
   IdV0S4%%Result2%%12 = job$V0S4$userstatus
   IdV0S4%%Result1%%13 = job$V0S4$status
   IdV0S4%%Name%%14 = jb$V0S4
   dummy$ = DSDetachJob(h$V0S4)
   If b$Abandoning Then GoTo L$WAITFORJOB
   GoSub L$V0S6$START
   GoTo L$WAITFORJOB
**************************************************
L$V0S5$START:
*** Sequencer "Sequencer_5": wait until inputs ready
   seq$V0S5$status = 1
   seq$V0S5$count += 1
   If seq$V0S5$count < 1 Then Return
   seq$V0S5$status = 2
   GoTo L$V0S4$START
L$V0S5$RETURN$1:
   GoTo L$V0S3$START
L$V0S5$RETURN$2:
   GoTo L$V0S2$START
L$V0S5$RETURN$3:
   Return
**************************************************
L$V0S6$START:
*** Sequencer "Sequencer_6": wait until inputs ready
   seq$V0S6$status = 1
   seq$V0S6$count += 1
   If seq$V0S6$count < 2 Then Return
   seq$V0S6$status = 2
   GoTo L$V0S61$START
L$V0S6$RETURN$1:
   Return
**************************************************
L$V0S8$START:
*** Activity "J007_INS_EMPL_DIR_PRI_0001": Initialize job
   h$V0S8 = DSAttachJob("J007_INS_EMPL_DIR_PRI_0001", DSJ.ERRNONE)
   If (Not(h$V0S8)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", "J007_INS_EMPL_DIR_PRI_0001":@FM:DSGetLastErrorMsg())
      msg$id = "@J007_INS_EMPL_DIR_PRI_0001"; GoTo L$ERROR
   End
   If DSGetJobInfo(h$V0S8, DSJ.JOBMULTIINVOKABLE) Then
      jb$V0S8 = "J007_INS_EMPL_DIR_PRI_0001":'.':"J007_INS_EMPL_DIR_PRI_0001"
   End Else
      jb$V0S8 = "J007_INS_EMPL_DIR_PRI_0001"
   End
   dummy$ = DSDetachJob(h$V0S8)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0057\\%1 (JOB %2) started", "J007_INS_EMPL_DIR_PRI_0001":@FM:jb$V0S8))
   h$V0S8 = DSAttachJob(jb$V0S8, DSJ.ERRNONE)
   If (Not(h$V0S8)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", jb$V0S8:@FM:DSGetLastErrorMsg())
      msg$id = "@J007_INS_EMPL_DIR_PRI_0001"; GoTo L$ERROR
   End
   p$V0S8$1 = "(As pre-defined)"
   err$code = DSSetParam(h$V0S8, "PRM_ORA_CONE_MAE_EMPL", p$V0S8$1)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0002\\Error calling DSSetParam(%1), code=%2[E]", "PRM_ORA_CONE_MAE_EMPL":@FM:err$code)
      msg$id = "@J007_INS_EMPL_DIR_PRI_0001"; GoTo L$ERROR
   End
   err$code = DSRunJob(h$V0S8, DSJ.RUNNORMAL)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0003\\Error calling DSRunJob(%1), code=%2[E]", jb$V0S8:@FM:err$code)
      msg$id = "@J007_INS_EMPL_DIR_PRI_0001"; GoTo L$ERROR
   End
   handle$list<-1> = h$V0S8
   id$list<-1> = "V0S8"
   GoTo L$V0S61$RETURN$2
**************************************************
L$V0S8$FINISHED:
   job$V0S8$status = DSGetJobInfo(h$V0S8, DSJ.JOBSTATUS)
   job$V0S8$userstatus = DSGetJobInfo(h$V0S8, DSJ.USERSTATUS)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0063\\%1 (JOB %2) finished, status=%3[E]", "J007_INS_EMPL_DIR_PRI_0001":@FM:jb$V0S8:@FM:job$V0S8$status))
   IdV0S8%%Result2%%15 = job$V0S8$userstatus
   IdV0S8%%Result1%%16 = job$V0S8$status
   IdV0S8%%Name%%17 = jb$V0S8
   dummy$ = DSDetachJob(h$V0S8)
   If b$Abandoning Then GoTo L$WAITFORJOB
   If (job$V0S8$status <> DSJS.RUNOK And job$V0S8$status <> DSJS.RUNWARN) Then GoTo L$V0S34$START
L$V0S8$RETURN$1:
   If (job$V0S8$status = DSJS.RUNOK) Then GoTo L$V0S9$START
L$V0S8$RETURN$2:
   GoTo L$WAITFORJOB
**************************************************
L$V0S9$START:
*** Activity "J008_TRN_EMPL_MAE_DIR_PRI_0002": Initialize job
   h$V0S9 = DSAttachJob("J008_TRN_EMPL_MAE_DIR_PRI_0002", DSJ.ERRNONE)
   If (Not(h$V0S9)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", "J008_TRN_EMPL_MAE_DIR_PRI_0002":@FM:DSGetLastErrorMsg())
      msg$id = "@J008_TRN_EMPL_MAE_DIR_PRI_0002"; GoTo L$ERROR
   End
   If DSGetJobInfo(h$V0S9, DSJ.JOBMULTIINVOKABLE) Then
      jb$V0S9 = "J008_TRN_EMPL_MAE_DIR_PRI_0002":'.':"J008_TRN_EMPL_MAE_DIR_PRI_0002"
   End Else
      jb$V0S9 = "J008_TRN_EMPL_MAE_DIR_PRI_0002"
   End
   dummy$ = DSDetachJob(h$V0S9)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0057\\%1 (JOB %2) started", "J008_TRN_EMPL_MAE_DIR_PRI_0002":@FM:jb$V0S9))
   h$V0S9 = DSAttachJob(jb$V0S9, DSJ.ERRNONE)
   If (Not(h$V0S9)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", jb$V0S9:@FM:DSGetLastErrorMsg())
      msg$id = "@J008_TRN_EMPL_MAE_DIR_PRI_0002"; GoTo L$ERROR
   End
   p$V0S9$1 = "(As pre-defined)"
   err$code = DSSetParam(h$V0S9, "PRM_ORA_CONE_MAE_EMPL", p$V0S9$1)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0002\\Error calling DSSetParam(%1), code=%2[E]", "PRM_ORA_CONE_MAE_EMPL":@FM:err$code)
      msg$id = "@J008_TRN_EMPL_MAE_DIR_PRI_0002"; GoTo L$ERROR
   End
   err$code = DSRunJob(h$V0S9, DSJ.RUNNORMAL)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0003\\Error calling DSRunJob(%1), code=%2[E]", jb$V0S9:@FM:err$code)
      msg$id = "@J008_TRN_EMPL_MAE_DIR_PRI_0002"; GoTo L$ERROR
   End
   handle$list<-1> = h$V0S9
   id$list<-1> = "V0S9"
   GoTo L$V0S8$RETURN$2
**************************************************
L$V0S9$FINISHED:
   job$V0S9$status = DSGetJobInfo(h$V0S9, DSJ.JOBSTATUS)
   job$V0S9$userstatus = DSGetJobInfo(h$V0S9, DSJ.USERSTATUS)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0063\\%1 (JOB %2) finished, status=%3[E]", "J008_TRN_EMPL_MAE_DIR_PRI_0002":@FM:jb$V0S9:@FM:job$V0S9$status))
   IdV0S9%%Result2%%18 = job$V0S9$userstatus
   IdV0S9%%Result1%%19 = job$V0S9$status
   IdV0S9%%Name%%20 = jb$V0S9
   dummy$ = DSDetachJob(h$V0S9)
   If b$Abandoning Then GoTo L$WAITFORJOB
   If (job$V0S9$status <> DSJS.RUNOK And job$V0S9$status <> DSJS.RUNWARN) Then GoTo L$V0S35$START
L$V0S9$RETURN$1:
   If (job$V0S9$status = DSJS.RUNOK) Then GoSub L$V0S10$START
   GoTo L$WAITFORJOB
**************************************************
L$V0S10$START:
*** Sequencer "Sequencer_10": wait until inputs ready
   seq$V0S10$status = 1
   seq$V0S10$count += 1
   If seq$V0S10$count < 2 Then Return
   seq$V0S10$status = 2
   GoTo L$V0S56$START
L$V0S10$RETURN$1:
   Return
**************************************************
L$V0S28$START:
*** Sequencer "Sequencer_28": wait until inputs ready
   seq$V0S28$status = 1
   seq$V0S28$count += 1
   If seq$V0S28$count < 1 Then Return
   seq$V0S28$status = 2
   Return
**************************************************
L$V0S30$START:
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0065\\%1 Executed", "Terminator1"))
* Send stop request to any outstanding child jobs
   For index$ = 1 To DCount(handle$list, @FM)
      handle$ = handle$list<index$>
      If handle$ <> "" Then
         job$name = DSGetJobInfo(handle$, DSJ.JOBNAME)
         job$invid = DSGetJobInfo(handle$, DSJ.JOBINVOCATIONID)
         if job$invid <> "" Then job$name = job$name:".":job$invid
         Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0019\\Sending STOP request to job: %1", job$name), "@Terminator1")
         dummy$ = DSStopJob(handle$)
      End
   Next index$
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0069\\Sequence terminated", ""))
   x$masked$summary = summary$
   Call DSMaskExecArgs(x$masked$summary, '')
   Call DSLogInfo(x$masked$summary, "@Coordinator")
   Call DSLogFatal(DSMakeMsg("DSTAGE_JSG_M_0020\\Sequence abort requested", ""), "@Terminator1")
**************************************************
L$V0S31$START:
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0065\\%1 Executed", "Terminator2"))
* Send stop request to any outstanding child jobs
   For index$ = 1 To DCount(handle$list, @FM)
      handle$ = handle$list<index$>
      If handle$ <> "" Then
         job$name = DSGetJobInfo(handle$, DSJ.JOBNAME)
         job$invid = DSGetJobInfo(handle$, DSJ.JOBINVOCATIONID)
         if job$invid <> "" Then job$name = job$name:".":job$invid
         Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0019\\Sending STOP request to job: %1", job$name), "@Terminator2")
         dummy$ = DSStopJob(handle$)
      End
   Next index$
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0069\\Sequence terminated", ""))
   x$masked$summary = summary$
   Call DSMaskExecArgs(x$masked$summary, '')
   Call DSLogInfo(x$masked$summary, "@Coordinator")
   Call DSLogFatal(DSMakeMsg("DSTAGE_JSG_M_0020\\Sequence abort requested", ""), "@Terminator2")
**************************************************
L$V0S32$START:
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0065\\%1 Executed", "Terminator3"))
* Send stop request to any outstanding child jobs
   For index$ = 1 To DCount(handle$list, @FM)
      handle$ = handle$list<index$>
      If handle$ <> "" Then
         job$name = DSGetJobInfo(handle$, DSJ.JOBNAME)
         job$invid = DSGetJobInfo(handle$, DSJ.JOBINVOCATIONID)
         if job$invid <> "" Then job$name = job$name:".":job$invid
         Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0019\\Sending STOP request to job: %1", job$name), "@Terminator3")
         dummy$ = DSStopJob(handle$)
      End
   Next index$
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0069\\Sequence terminated", ""))
   x$masked$summary = summary$
   Call DSMaskExecArgs(x$masked$summary, '')
   Call DSLogInfo(x$masked$summary, "@Coordinator")
   Call DSLogFatal(DSMakeMsg("DSTAGE_JSG_M_0020\\Sequence abort requested", ""), "@Terminator3")
**************************************************
L$V0S33$START:
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0065\\%1 Executed", "Terminator4"))
* Send stop request to any outstanding child jobs
   For index$ = 1 To DCount(handle$list, @FM)
      handle$ = handle$list<index$>
      If handle$ <> "" Then
         job$name = DSGetJobInfo(handle$, DSJ.JOBNAME)
         job$invid = DSGetJobInfo(handle$, DSJ.JOBINVOCATIONID)
         if job$invid <> "" Then job$name = job$name:".":job$invid
         Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0019\\Sending STOP request to job: %1", job$name), "@Terminator4")
         dummy$ = DSStopJob(handle$)
      End
   Next index$
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0069\\Sequence terminated", ""))
   x$masked$summary = summary$
   Call DSMaskExecArgs(x$masked$summary, '')
   Call DSLogInfo(x$masked$summary, "@Coordinator")
   Call DSLogFatal(DSMakeMsg("DSTAGE_JSG_M_0020\\Sequence abort requested", ""), "@Terminator4")
**************************************************
L$V0S34$START:
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0065\\%1 Executed", "Terminator5"))
* Send stop request to any outstanding child jobs
   For index$ = 1 To DCount(handle$list, @FM)
      handle$ = handle$list<index$>
      If handle$ <> "" Then
         job$name = DSGetJobInfo(handle$, DSJ.JOBNAME)
         job$invid = DSGetJobInfo(handle$, DSJ.JOBINVOCATIONID)
         if job$invid <> "" Then job$name = job$name:".":job$invid
         Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0019\\Sending STOP request to job: %1", job$name), "@Terminator5")
         dummy$ = DSStopJob(handle$)
      End
   Next index$
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0069\\Sequence terminated", ""))
   x$masked$summary = summary$
   Call DSMaskExecArgs(x$masked$summary, '')
   Call DSLogInfo(x$masked$summary, "@Coordinator")
   Call DSLogFatal(DSMakeMsg("DSTAGE_JSG_M_0020\\Sequence abort requested", ""), "@Terminator5")
**************************************************
L$V0S35$START:
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0065\\%1 Executed", "Terminator6"))
* Send stop request to any outstanding child jobs
   For index$ = 1 To DCount(handle$list, @FM)
      handle$ = handle$list<index$>
      If handle$ <> "" Then
         job$name = DSGetJobInfo(handle$, DSJ.JOBNAME)
         job$invid = DSGetJobInfo(handle$, DSJ.JOBINVOCATIONID)
         if job$invid <> "" Then job$name = job$name:".":job$invid
         Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0019\\Sending STOP request to job: %1", job$name), "@Terminator6")
         dummy$ = DSStopJob(handle$)
      End
   Next index$
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0069\\Sequence terminated", ""))
   x$masked$summary = summary$
   Call DSMaskExecArgs(x$masked$summary, '')
   Call DSLogInfo(x$masked$summary, "@Coordinator")
   Call DSLogFatal(DSMakeMsg("DSTAGE_JSG_M_0020\\Sequence abort requested", ""), "@Terminator6")
**************************************************
L$V0S36$START:
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0065\\%1 Executed", "Terminator7"))
* Send stop request to any outstanding child jobs
   For index$ = 1 To DCount(handle$list, @FM)
      handle$ = handle$list<index$>
      If handle$ <> "" Then
         job$name = DSGetJobInfo(handle$, DSJ.JOBNAME)
         job$invid = DSGetJobInfo(handle$, DSJ.JOBINVOCATIONID)
         if job$invid <> "" Then job$name = job$name:".":job$invid
         Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0019\\Sending STOP request to job: %1", job$name), "@Terminator7")
         dummy$ = DSStopJob(handle$)
      End
   Next index$
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0069\\Sequence terminated", ""))
   x$masked$summary = summary$
   Call DSMaskExecArgs(x$masked$summary, '')
   Call DSLogInfo(x$masked$summary, "@Coordinator")
   Call DSLogFatal(DSMakeMsg("DSTAGE_JSG_M_0020\\Sequence abort requested", ""), "@Terminator7")
**************************************************
L$V0S37$START:
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0065\\%1 Executed", "Terminator8"))
* Send stop request to any outstanding child jobs
   For index$ = 1 To DCount(handle$list, @FM)
      handle$ = handle$list<index$>
      If handle$ <> "" Then
         job$name = DSGetJobInfo(handle$, DSJ.JOBNAME)
         job$invid = DSGetJobInfo(handle$, DSJ.JOBINVOCATIONID)
         if job$invid <> "" Then job$name = job$name:".":job$invid
         Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0019\\Sending STOP request to job: %1", job$name), "@Terminator8")
         dummy$ = DSStopJob(handle$)
      End
   Next index$
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0069\\Sequence terminated", ""))
   x$masked$summary = summary$
   Call DSMaskExecArgs(x$masked$summary, '')
   Call DSLogInfo(x$masked$summary, "@Coordinator")
   Call DSLogFatal(DSMakeMsg("DSTAGE_JSG_M_0020\\Sequence abort requested", ""), "@Terminator8")
**************************************************
L$V0S56$START:
*** Activity "J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001": Initialize job
   h$V0S56 = DSAttachJob("J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001", DSJ.ERRNONE)
   If (Not(h$V0S56)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", "J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001":@FM:DSGetLastErrorMsg())
      msg$id = "@J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001"; GoTo L$ERROR
   End
   If DSGetJobInfo(h$V0S56, DSJ.JOBMULTIINVOKABLE) Then
      jb$V0S56 = "J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001":'.':"J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001"
   End Else
      jb$V0S56 = "J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001"
   End
   dummy$ = DSDetachJob(h$V0S56)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0057\\%1 (JOB %2) started", "J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001":@FM:jb$V0S56))
   h$V0S56 = DSAttachJob(jb$V0S56, DSJ.ERRNONE)
   If (Not(h$V0S56)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", jb$V0S56:@FM:DSGetLastErrorMsg())
      msg$id = "@J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001"; GoTo L$ERROR
   End
   p$V0S56$1 = "(As pre-defined)"
   err$code = DSSetParam(h$V0S56, "PRM_ORA_CONE_MAE_EMPL", p$V0S56$1)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0002\\Error calling DSSetParam(%1), code=%2[E]", "PRM_ORA_CONE_MAE_EMPL":@FM:err$code)
      msg$id = "@J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001"; GoTo L$ERROR
   End
   err$code = DSRunJob(h$V0S56, DSJ.RUNNORMAL)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0003\\Error calling DSRunJob(%1), code=%2[E]", jb$V0S56:@FM:err$code)
      msg$id = "@J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001"; GoTo L$ERROR
   End
   handle$list<-1> = h$V0S56
   id$list<-1> = "V0S56"
   GoTo L$V0S10$RETURN$1
**************************************************
L$V0S56$FINISHED:
   job$V0S56$status = DSGetJobInfo(h$V0S56, DSJ.JOBSTATUS)
   job$V0S56$userstatus = DSGetJobInfo(h$V0S56, DSJ.USERSTATUS)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0063\\%1 (JOB %2) finished, status=%3[E]", "J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001":@FM:jb$V0S56:@FM:job$V0S56$status))
   IdV0S56%%Result2%%21 = job$V0S56$userstatus
   IdV0S56%%Result1%%22 = job$V0S56$status
   IdV0S56%%Name%%23 = jb$V0S56
   dummy$ = DSDetachJob(h$V0S56)
   If b$Abandoning Then GoTo L$WAITFORJOB
   If (job$V0S56$status <> DSJS.RUNOK And job$V0S56$status <> DSJS.RUNWARN) Then GoTo L$V0S36$START
L$V0S56$RETURN$1:
   If (job$V0S56$status = DSJS.RUNOK) Then GoTo L$V0S57$START
L$V0S56$RETURN$2:
   GoTo L$WAITFORJOB
**************************************************
L$V0S57$START:
*** Activity "J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001": Initialize job
   h$V0S57 = DSAttachJob("J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001", DSJ.ERRNONE)
   If (Not(h$V0S57)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", "J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001":@FM:DSGetLastErrorMsg())
      msg$id = "@J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001"; GoTo L$ERROR
   End
   If DSGetJobInfo(h$V0S57, DSJ.JOBMULTIINVOKABLE) Then
      jb$V0S57 = "J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001":'.':"J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001"
   End Else
      jb$V0S57 = "J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001"
   End
   dummy$ = DSDetachJob(h$V0S57)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0057\\%1 (JOB %2) started", "J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001":@FM:jb$V0S57))
   h$V0S57 = DSAttachJob(jb$V0S57, DSJ.ERRNONE)
   If (Not(h$V0S57)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", jb$V0S57:@FM:DSGetLastErrorMsg())
      msg$id = "@J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001"; GoTo L$ERROR
   End
   p$V0S57$1 = "(As pre-defined)"
   err$code = DSSetParam(h$V0S57, "PRM_ORA_CONE_MAE_EMPL", p$V0S57$1)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0002\\Error calling DSSetParam(%1), code=%2[E]", "PRM_ORA_CONE_MAE_EMPL":@FM:err$code)
      msg$id = "@J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001"; GoTo L$ERROR
   End
   err$code = DSRunJob(h$V0S57, DSJ.RUNNORMAL)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0003\\Error calling DSRunJob(%1), code=%2[E]", jb$V0S57:@FM:err$code)
      msg$id = "@J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001"; GoTo L$ERROR
   End
   handle$list<-1> = h$V0S57
   id$list<-1> = "V0S57"
   GoTo L$V0S56$RETURN$2
**************************************************
L$V0S57$FINISHED:
   job$V0S57$status = DSGetJobInfo(h$V0S57, DSJ.JOBSTATUS)
   job$V0S57$userstatus = DSGetJobInfo(h$V0S57, DSJ.USERSTATUS)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0063\\%1 (JOB %2) finished, status=%3[E]", "J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001":@FM:jb$V0S57:@FM:job$V0S57$status))
   IdV0S57%%Result2%%24 = job$V0S57$userstatus
   IdV0S57%%Result1%%25 = job$V0S57$status
   IdV0S57%%Name%%26 = jb$V0S57
   dummy$ = DSDetachJob(h$V0S57)
   If b$Abandoning Then GoTo L$WAITFORJOB
   If (job$V0S57$status <> DSJS.RUNOK And job$V0S57$status <> DSJS.RUNWARN) Then GoTo L$V0S37$START
L$V0S57$RETURN$1:
   If (job$V0S57$status = DSJS.RUNOK) Then GoSub L$V0S28$START
   GoTo L$WAITFORJOB
**************************************************
L$V0S61$START:
*** Activity "J006_TRN_EMPL_MAE_DIRE_PRI_0001": Initialize job
   h$V0S61 = DSAttachJob("J006_TRN_EMPL_MAE_DIRE_PRI_0001", DSJ.ERRNONE)
   If (Not(h$V0S61)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", "J006_TRN_EMPL_MAE_DIRE_PRI_0001":@FM:DSGetLastErrorMsg())
      msg$id = "@J006_TRN_EMPL_MAE_DIRE_PRI_0001"; GoTo L$ERROR
   End
   If DSGetJobInfo(h$V0S61, DSJ.JOBMULTIINVOKABLE) Then
      jb$V0S61 = "J006_TRN_EMPL_MAE_DIRE_PRI_0001":'.':"J006_TRN_EMPL_MAE_DIRE_PRI_0001"
   End Else
      jb$V0S61 = "J006_TRN_EMPL_MAE_DIRE_PRI_0001"
   End
   dummy$ = DSDetachJob(h$V0S61)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0057\\%1 (JOB %2) started", "J006_TRN_EMPL_MAE_DIRE_PRI_0001":@FM:jb$V0S61))
   h$V0S61 = DSAttachJob(jb$V0S61, DSJ.ERRNONE)
   If (Not(h$V0S61)) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0001\\Error calling DSAttachJob(%1)<L>%2", jb$V0S61:@FM:DSGetLastErrorMsg())
      msg$id = "@J006_TRN_EMPL_MAE_DIRE_PRI_0001"; GoTo L$ERROR
   End
   p$V0S61$1 = "(As pre-defined)"
   err$code = DSSetParam(h$V0S61, "PRM_ORA_CONE_MAE_EMPL", p$V0S61$1)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0002\\Error calling DSSetParam(%1), code=%2[E]", "PRM_ORA_CONE_MAE_EMPL":@FM:err$code)
      msg$id = "@J006_TRN_EMPL_MAE_DIRE_PRI_0001"; GoTo L$ERROR
   End
   err$code = DSRunJob(h$V0S61, DSJ.RUNNORMAL)
   If (err$code <> DSJE.NOERROR) Then
      msg$ = DSMakeMsg("DSTAGE_JSG_M_0003\\Error calling DSRunJob(%1), code=%2[E]", jb$V0S61:@FM:err$code)
      msg$id = "@J006_TRN_EMPL_MAE_DIRE_PRI_0001"; GoTo L$ERROR
   End
   handle$list<-1> = h$V0S61
   id$list<-1> = "V0S61"
   GoTo L$V0S6$RETURN$1
**************************************************
L$V0S61$FINISHED:
   job$V0S61$status = DSGetJobInfo(h$V0S61, DSJ.JOBSTATUS)
   job$V0S61$userstatus = DSGetJobInfo(h$V0S61, DSJ.USERSTATUS)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0063\\%1 (JOB %2) finished, status=%3[E]", "J006_TRN_EMPL_MAE_DIRE_PRI_0001":@FM:jb$V0S61:@FM:job$V0S61$status))
   IdV0S61%%Result2%%27 = job$V0S61$userstatus
   IdV0S61%%Result1%%28 = job$V0S61$status
   IdV0S61%%Name%%29 = jb$V0S61
   dummy$ = DSDetachJob(h$V0S61)
   If b$Abandoning Then GoTo L$WAITFORJOB
   If (job$V0S61$status <> DSJS.RUNOK And job$V0S61$status <> DSJS.RUNWARN) Then GoTo L$V0S33$START
L$V0S61$RETURN$1:
   If (job$V0S61$status = DSJS.RUNOK) Then GoTo L$V0S8$START
L$V0S61$RETURN$2:
   GoTo L$WAITFORJOB
**************************************************
L$WAITFORJOB:
   If handle$list = "" Then GoTo L$FINISH
   handle$ = DSWaitForJob(handle$list)
   If handle$ = 0 Then handle$ = handle$list<1>
   Locate handle$ In handle$list Setting index$ Then
      id$ = id$list<index$>
      Del id$list<index$>; Del handle$list<index$>
      b$Abandoning = abort$list<index$>; Del abort$list<index$>
      Begin Case
      Case id$ = "V0S0"
         GoTo L$V0S0$FINISHED
      Case id$ = "V0S1"
         GoTo L$V0S1$FINISHED
      Case id$ = "V0S2"
         GoTo L$V0S2$FINISHED
      Case id$ = "V0S3"
         GoTo L$V0S3$FINISHED
      Case id$ = "V0S4"
         GoTo L$V0S4$FINISHED
      Case id$ = "V0S8"
         GoTo L$V0S8$FINISHED
      Case id$ = "V0S9"
         GoTo L$V0S9$FINISHED
      Case id$ = "V0S56"
         GoTo L$V0S56$FINISHED
      Case id$ = "V0S57"
         GoTo L$V0S57$FINISHED
      Case id$ = "V0S61"
         GoTo L$V0S61$FINISHED
      End Case
   End
* Error if fall though
   handle$list = ""
   msg$ = DSMakeMsg("DSTAGE_JSG_M_0008\\Error calling DSWaitForJob(), code=%1[E]", handle$)
   msg$id = "@Coordinator"; GoTo L$ERROR
**************************************************
L$ERROR:
   Call DSLogWarn(DSMakeMsg("DSTAGE_JSG_M_0009\\Controller problem: %1", msg$), msg$id)
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0052\\Exception raised: %1", msg$id:", ":msg$))
   abort$list = Ifs(handle$list, Str(1:@FM, DCount(handle$list, @FM)), "")
   b$Abandoning = @True
   GoTo L$WAITFORJOB
L$ABORT:
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0056\\Sequence failed", ""))
   x$masked$summary = summary$
   Call DSMaskExecArgs(x$masked$summary, '')
   Call DSLogInfo(x$masked$summary, "@Coordinator")
   Call DSLogFatal(DSMakeMsg("DSTAGE_JSG_M_0013\\Sequence job will abort due to previous unrecoverable errors", ""), "@Coordinator")
**************************************************
L$FINISH:
   If b$Abandoning Then GoTo L$ABORT
   If (seq$V0S5$status = 1) Then
      Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0072\\Note: Sequencer '%1' was entered, but never exited", "Sequencer_5"), "@Coordinator")
   End
   If (seq$V0S6$status = 1) Then
      Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0072\\Note: Sequencer '%1' was entered, but never exited", "Sequencer_6"), "@Coordinator")
   End
   If (seq$V0S10$status = 1) Then
      Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0072\\Note: Sequencer '%1' was entered, but never exited", "Sequencer_10"), "@Coordinator")
   End
   If (seq$V0S28$status = 1) Then
      Call DSLogInfo(DSMakeMsg("DSTAGE_JSG_M_0072\\Note: Sequencer '%1' was entered, but never exited", "Sequencer_28"), "@Coordinator")
   End
   summary$<1,-1> = Time$$:Convert(@VM, " ", DSMakeMsg("DSTAGE_JSG_M_0054\\Sequence finished OK", ""))
   x$masked$summary = summary$
   Call DSMaskExecArgs(x$masked$summary, '')
   Call DSLogInfo(x$masked$summary, "@Coordinator")
   L$EXIT: Return To L$EXIT
 

=+=+=+=
      ControlAfterSubr "0"
      Parameters "CParameters"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Prompt "PRM_ORA_CONE_MAE_EMPL parameters"
         Default "(As pre-defined)"
         HelpTxt "Conexiones para migración Maestro Empleador"
         ParamType "13"
         ParamLength "0"
         ParamScale "0"
      END DSSUBRECORD
      MetaBag "CMetaProperty"
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "AdvancedRuntimeOptions"
         Value "#DSProjectARTOptions#"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Owner "APT"
         Name "SequenceUseGridProperties"
         Value "0"
      END DSSUBRECORD
      NULLIndicatorPosition "0"
      Dependencies "CJobDepend"
      BEGIN DSSUBRECORD
         Name "J001_TRN_EMPL_AUX_SEDE_PRI_0001"
         Type "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "J002_INS_EMPL_AUX_SEDE_PRI_0001"
         Type "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "J003_TRN_EMPL_AUX_SEDE_PRI_0002"
         Type "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "J004_INS_EMPL_AUX_VIA_0001"
         Type "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "J005_INS_EMPL_AUX_ZONA_0001"
         Type "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "J007_INS_EMPL_DIR_PRI_0001"
         Type "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "J008_TRN_EMPL_MAE_DIR_PRI_0002"
         Type "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001"
         Type "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001"
         Type "0"
      END DSSUBRECORD
      BEGIN DSSUBRECORD
         Name "J006_TRN_EMPL_MAE_DIRE_PRI_0001"
         Type "0"
      END DSSUBRECORD
      IsTemplate "0"
      NLSLocale ",,,,"
      JobType "2"
      Category "\\Jobs\\FUENTES_EXTERNAS\\MIGRACION_NETI_EMPL\\AUXILIAR\\AUX_SEDE_PRINCIPAL"
      CenturyBreakYear "30"
      NextAliasID "2"
      ParameterFileDDName "DD00001"
      ReservedWordCheck "1"
      TransactionSize "0"
      ValidationStatus "0"
      Uploadable "0"
      PgmCustomizationFlag "0"
      JobReportFlag "0"
      AllowMultipleInvocations "0"
      Act2ActOverideDefaults "0"
      Act2ActEnableRowBuffer "0"
      Act2ActUseIPC "0"
      Act2ActBufferSize "0"
      Act2ActIPCTimeout "0"
      ExpressionSemanticCheckFlag "0"
      TraceOption "0"
      EnableCacheSharing "0"
      RuntimeColumnPropagation "0"
      RelStagesInJobStatus "-1"
      WebServiceEnabled "0"
      MFProcessMetaData "0"
      MFProcessMetaDataXMLFileExchangeMethod "0"
      IMSProgType "0"
      CopyLibPrefix "ARDT"
      RecordPerformanceResults "0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0"
      OLEType "CContainerView"
      Readonly "0"
      Name "Job"
      NextID "1"
      IsTopLevel "0"
      StageList "V0S0|V0S1|V0S2|V0S3|V0S4|V0S5|V0S6|V0S8|V0S9|V0S10|V0S28|V0S30|V0S31|V0S32|V0S33|V0S34|V0S35|V0S36|V0S37|V0S56|V0S57|V0S61"
      StageXPos "96|336|696|696|696|528|888|1320|1584|1776|2568|96|336|696|1080|1320|1584|1968|2280|1968|2280|1080"
      StageYPos "312|312|168|312|432|144|360|360|360|168|288|456|456|48|528|528|528|432|432|288|288|360"
      StageTypes "CJSJobActivity|CJSJobActivity|CJSJobActivity|CJSJobActivity|CJSJobActivity|CJSSequencer|CJSSequencer|CJSJobActivity|CJSJobActivity|CJSSequencer|CJSSequencer|CJSTerminatorActivity|CJSTerminatorActivity|CJSTerminatorActivity|CJSTerminatorActivity|CJSTerminatorActivity|CJSTerminatorActivity|CJSTerminatorActivity|CJSTerminatorActivity|CJSJobActivity|CJSJobActivity|CJSJobActivity"
      NextStageID "62"
      SnapToGrid "1"
      GridLines "0"
      ZoomValue "80"
      StageXSize "48|48|48|48|48|50|48|48|48|50|48|48|48|48|48|48|48|48|48|48|48|48"
      StageYSize "48|48|48|48|48|377|48|48|48|299|48|48|48|48|48|48|48|48|48|48|48|48"
      ContainerViewSizing "0000 0000 1096 0532 0000 0001 0000 0004"
      StageNames "J001_TRN_EMPL_AUX_SEDE_PRI_0001|J002_INS_EMPL_AUX_SEDE_PRI_0001|J003_TRN_EMPL_AUX_SEDE_PRI_0002|J004_INS_EMPL_AUX_VIA_0001|J005_INS_EMPL_AUX_ZONA_0001|Sequencer_5|Sequencer_6|J007_INS_EMPL_DIR_PRI_0001|J008_TRN_EMPL_MAE_DIR_PRI_0002|Sequencer_10|Sequencer_28|Terminator1|Terminator2|Terminator3|Terminator4|Terminator5|Terminator6|Terminator7|Terminator8|J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001|J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001|J006_TRN_EMPL_MAE_DIRE_PRI_0001"
      StageTypeIDs "CJobActivity|CJobActivity|CJobActivity|CJobActivity|CJobActivity|CSequencer|CSequencer|CJobActivity|CJobActivity|CSequencer|CSequencer|CTerminatorActivity|CTerminatorActivity|CTerminatorActivity|CTerminatorActivity|CTerminatorActivity|CTerminatorActivity|CTerminatorActivity|CTerminatorActivity|CJobActivity|CJobActivity|CJobActivity"
      LinkNames "dsl1,e1|dsl2,e2|dsl11,e3|dsl6|dsl7|dsl3,dsl4,dsl5|dsl8|dsl10,e5|dsl12,e6|dsl13| | | | | | | | | |dsl14,e7|dsl15,e8|dsl9,e4"
      LinkHasMetaDatas "False,False|False,False|False,False|False|False|False,False,False|False|False,False|False,False|False| | | | | | | | | |False,False|False,False|False,False"
      LinkTypes "1,1|1,1|1,1|1|1|1,1,1|1|1,1|1,1|1| | | | | | | | | |1,1|1,1|1,1"
      LinkNamePositionXs "139,120|467,360|1270,720|807|798|634,580,601|957|1373,1344|1705,1608|1874| | | | | | | | | |2052,1992|2414,2304|1195,1104"
      LinkNamePositionYs "336,408|334,408|197,132|348|434|200,311,456|384|384,468|370,451|316| | | | | | | | | |312,362|312,384|384,468"
      TargetStageIDs "V0S1,V0S30|V0S5,V0S31|V0S10,V0S32|V0S6|V0S6|V0S2,V0S3,V0S4|V0S61|V0S9,V0S34|V0S10,V0S35|V0S56| | | | | | | | | |V0S57,V0S36|V0S28,V0S37|V0S8,V0S33"
      SourceStageEffectiveExecutionModes "0,0|0,0|0,0|0|0|0,0,0|0|0,0|0,0|0| | | | | | | | | |0,0|0,0|0,0"
      SourceStageRuntimeExecutionModes "0,0|0,0|0,0|0|0|0,0,0|0|0,0|0,0|0| | | | | | | | | |0,0|0,0|0,0"
      TargetStageEffectiveExecutionModes "0,0|0,0|0,0|0|0|0,0,0|0|0,0|0,0|0| | | | | | | | | |0,0|0,0|0,0"
      TargetStageRuntimeExecutionModes "0,0|0,0|0,0|0|0|0,0,0|0|0,0|0,0|0| | | | | | | | | |0,0|0,0|0,0"
      LinkIsSingleOperatorLookup "False,False|False,False|False,False|False|False|False,False,False|False|False,False|False,False|False| | | | | | | | | |False,False|False,False|False,False"
      LinkIsSortSequential "False,False|False,False|False,False|False|False|False,False,False|False|False,False|False,False|False| | | | | | | | | |False,False|False,False|False,False"
      LinkSortMode "0,0|0,0|0,0|0|0|0,0,0|0|0,0|0,0|0| | | | | | | | | |0,0|0,0|0,0"
      LinkPartColMode "0,0|0,0|0,0|0|0|0,0,0|0|0,0|0,0|0| | | | | | | | | |0,0|0,0|0,0"
      LinkSourcePinIDs "V0S0P1,V0S0P2|V0S1P2,V0S1P3|V0S2P2,V0S2P3|V0S3P2|V0S4P2|V0S5P2,V0S5P3,V0S5P4|V0S6P3|V0S8P2,V0S8P3|V0S9P2,V0S9P3|V0S10P3| | | | | | | | | |V0S56P2,V0S56P3|V0S57P2,V0S57P3|V0S61P2,V0S61P3"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S0"
      OLEType "CJSJobActivity"
      Readonly "0"
      Name "J001_TRN_EMPL_AUX_SEDE_PRI_0001"
      NextID "3"
      OutputPins "V0S0P1|V0S0P2"
      JobType "0"
      ExecutionType "0"
      Jobname "J001_TRN_EMPL_AUX_SEDE_PRI_0001"
      ParameterValues "CParamValues"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Description "\"(As pre-defined)\""
         ValueType "4"
         DisplayValue "\"(As pre-defined)\""
      END DSSUBRECORD
      CheckPoint "0"
      StageType "CJobActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S0P1"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl1"
      Partner "V0S1|V0S1P1"
      ConditionType "2"
      TriggerExpression "\"Executed OK\""
      LeftTextPos "139"
      TopTextPos "336"
      SourceID "V0S0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S0P2"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "e1"
      Partner "V0S30|V0S30P1"
      ConditionType "3"
      TriggerExpression "\"Execution Failed\""
      LeftTextPos "120"
      TopTextPos "408"
      SourceID "V0S0"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S1"
      OLEType "CJSJobActivity"
      Readonly "0"
      Name "J002_INS_EMPL_AUX_SEDE_PRI_0001"
      NextID "4"
      InputPins "V0S1P1"
      OutputPins "V0S1P2|V0S1P3"
      JobType "0"
      ExecutionType "0"
      Jobname "J002_INS_EMPL_AUX_SEDE_PRI_0001"
      ParameterValues "CParamValues"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Description "\"(As pre-defined)\""
         ValueType "4"
         DisplayValue "\"(As pre-defined)\""
      END DSSUBRECORD
      CheckPoint "0"
      StageType "CJobActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S10"
      OLEType "CJSSequencer"
      Readonly "0"
      Name "Sequencer_10"
      NextID "4"
      InputPins "V0S10P1|V0S10P2"
      OutputPins "V0S10P3"
      SequencerType "0"
      StageType "CSequencer"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S10P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl11"
      Partner "V0S2|V0S2P2"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S10P2"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl12"
      Partner "V0S9|V0S9P2"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S10P3"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl13"
      Partner "V0S56|V0S56P1"
      ConditionType "0"
      LeftTextPos "1874"
      TopTextPos "316"
      SourceID "V0S10"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S1P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl1"
      Partner "V0S0|V0S0P1"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S1P2"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl2"
      Partner "V0S5|V0S5P1"
      ConditionType "2"
      TriggerExpression "\"Executed OK\""
      LeftTextPos "467"
      TopTextPos "334"
      SourceID "V0S1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S1P3"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "e2"
      Partner "V0S31|V0S31P1"
      ConditionType "3"
      TriggerExpression "\"Execution Failed\""
      LeftTextPos "360"
      TopTextPos "408"
      SourceID "V0S1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S2"
      OLEType "CJSJobActivity"
      Readonly "0"
      Name "J003_TRN_EMPL_AUX_SEDE_PRI_0002"
      NextID "4"
      InputPins "V0S2P1"
      OutputPins "V0S2P2|V0S2P3"
      JobType "0"
      ExecutionType "0"
      Jobname "J003_TRN_EMPL_AUX_SEDE_PRI_0002"
      ParameterValues "CParamValues"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Description "\"(As pre-defined)\""
         ValueType "4"
         DisplayValue "\"(As pre-defined)\""
      END DSSUBRECORD
      CheckPoint "0"
      StageType "CJobActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S28"
      OLEType "CJSSequencer"
      Readonly "0"
      Name "Sequencer_28"
      NextID "2"
      InputPins "V0S28P1"
      SequencerType "0"
      StageType "CSequencer"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S28P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl15"
      Partner "V0S57|V0S57P2"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S2P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl3"
      Partner "V0S5|V0S5P2"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S2P2"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl11"
      Partner "V0S10|V0S10P1"
      ConditionType "2"
      TriggerExpression "\"Executed OK\""
      LeftTextPos "1270"
      TopTextPos "197"
      SourceID "V0S2"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S2P3"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "e3"
      Partner "V0S32|V0S32P1"
      ConditionType "3"
      TriggerExpression "\"Execution Failed\""
      LeftTextPos "720"
      TopTextPos "132"
      SourceID "V0S2"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S3"
      OLEType "CJSJobActivity"
      Readonly "0"
      Name "J004_INS_EMPL_AUX_VIA_0001"
      NextID "3"
      InputPins "V0S3P1"
      OutputPins "V0S3P2"
      JobType "0"
      ExecutionType "0"
      Jobname "J004_INS_EMPL_AUX_VIA_0001"
      ParameterValues "CParamValues"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Description "\"(As pre-defined)\""
         ValueType "4"
         DisplayValue "\"(As pre-defined)\""
      END DSSUBRECORD
      CheckPoint "0"
      StageType "CJobActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S30"
      OLEType "CJSTerminatorActivity"
      Readonly "0"
      Name "Terminator1"
      NextID "2"
      InputPins "V0S30P1"
      TerminationType "0"
      StageType "CTerminatorActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S30P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "e1"
      Partner "V0S0|V0S0P2"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S31"
      OLEType "CJSTerminatorActivity"
      Readonly "0"
      Name "Terminator2"
      NextID "2"
      InputPins "V0S31P1"
      TerminationType "0"
      StageType "CTerminatorActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S31P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "e2"
      Partner "V0S1|V0S1P3"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S32"
      OLEType "CJSTerminatorActivity"
      Readonly "0"
      Name "Terminator3"
      NextID "2"
      InputPins "V0S32P1"
      TerminationType "0"
      StageType "CTerminatorActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S32P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "e3"
      Partner "V0S2|V0S2P3"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S33"
      OLEType "CJSTerminatorActivity"
      Readonly "0"
      Name "Terminator4"
      NextID "2"
      InputPins "V0S33P1"
      TerminationType "0"
      StageType "CTerminatorActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S33P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "e4"
      Partner "V0S61|V0S61P3"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S34"
      OLEType "CJSTerminatorActivity"
      Readonly "0"
      Name "Terminator5"
      NextID "2"
      InputPins "V0S34P1"
      TerminationType "0"
      StageType "CTerminatorActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S34P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "e5"
      Partner "V0S8|V0S8P3"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S35"
      OLEType "CJSTerminatorActivity"
      Readonly "0"
      Name "Terminator6"
      NextID "2"
      InputPins "V0S35P1"
      TerminationType "0"
      StageType "CTerminatorActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S35P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "e6"
      Partner "V0S9|V0S9P3"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S36"
      OLEType "CJSTerminatorActivity"
      Readonly "0"
      Name "Terminator7"
      NextID "2"
      InputPins "V0S36P1"
      TerminationType "0"
      StageType "CTerminatorActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S36P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "e7"
      Partner "V0S56|V0S56P3"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S37"
      OLEType "CJSTerminatorActivity"
      Readonly "0"
      Name "Terminator8"
      NextID "2"
      InputPins "V0S37P1"
      TerminationType "0"
      StageType "CTerminatorActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S37P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "e8"
      Partner "V0S57|V0S57P3"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S3P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl4"
      Partner "V0S5|V0S5P3"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S3P2"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl6"
      Partner "V0S6|V0S6P1"
      ConditionType "0"
      LeftTextPos "807"
      TopTextPos "348"
      SourceID "V0S3"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S4"
      OLEType "CJSJobActivity"
      Readonly "0"
      Name "J005_INS_EMPL_AUX_ZONA_0001"
      NextID "3"
      InputPins "V0S4P1"
      OutputPins "V0S4P2"
      JobType "0"
      ExecutionType "0"
      Jobname "J005_INS_EMPL_AUX_ZONA_0001"
      ParameterValues "CParamValues"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Description "\"(As pre-defined)\""
         ValueType "4"
         DisplayValue "\"(As pre-defined)\""
      END DSSUBRECORD
      CheckPoint "0"
      StageType "CJobActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S4P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl5"
      Partner "V0S5|V0S5P4"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S4P2"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl7"
      Partner "V0S6|V0S6P2"
      ConditionType "0"
      LeftTextPos "798"
      TopTextPos "434"
      SourceID "V0S4"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S5"
      OLEType "CJSSequencer"
      Readonly "0"
      Name "Sequencer_5"
      NextID "5"
      InputPins "V0S5P1"
      OutputPins "V0S5P2|V0S5P3|V0S5P4"
      SequencerType "0"
      StageType "CSequencer"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S56"
      OLEType "CJSJobActivity"
      Readonly "0"
      Name "J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001"
      NextID "4"
      InputPins "V0S56P1"
      OutputPins "V0S56P2|V0S56P3"
      JobType "0"
      ExecutionType "0"
      Jobname "J009_TRN_EMPL_REL_SEDE_DIR_PRI_0001"
      ParameterValues "CParamValues"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Description "\"(As pre-defined)\""
         ValueType "4"
         DisplayValue "\"(As pre-defined)\""
      END DSSUBRECORD
      CheckPoint "0"
      StageType "CJobActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S56P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl13"
      Partner "V0S10|V0S10P3"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S56P2"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl14"
      Partner "V0S57|V0S57P1"
      ConditionType "2"
      TriggerExpression "\"Executed OK\""
      LeftTextPos "2052"
      TopTextPos "312"
      SourceID "V0S11"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S56P3"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "e7"
      Partner "V0S36|V0S36P1"
      ConditionType "3"
      TriggerExpression "\"Execution Failed\""
      LeftTextPos "1992"
      TopTextPos "362"
      SourceID "V0S11"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S57"
      OLEType "CJSJobActivity"
      Readonly "0"
      Name "J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001"
      NextID "4"
      InputPins "V0S57P1"
      OutputPins "V0S57P2|V0S57P3"
      JobType "0"
      ExecutionType "0"
      Jobname "J101_INS_EMPL_REL_SEDE_DIRE_PRI_0001"
      ParameterValues "CParamValues"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Description "\"(As pre-defined)\""
         ValueType "4"
         DisplayValue "\"(As pre-defined)\""
      END DSSUBRECORD
      CheckPoint "0"
      StageType "CJobActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S57P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl14"
      Partner "V0S56|V0S56P2"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S57P2"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl15"
      Partner "V0S28|V0S28P1"
      ConditionType "2"
      TriggerExpression "\"Executed OK\""
      LeftTextPos "2414"
      TopTextPos "312"
      SourceID "V0S12"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S57P3"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "e8"
      Partner "V0S37|V0S37P1"
      ConditionType "3"
      TriggerExpression "\"Execution Failed\""
      LeftTextPos "2304"
      TopTextPos "384"
      SourceID "V0S12"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S5P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl2"
      Partner "V0S1|V0S1P2"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S5P2"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl3"
      Partner "V0S2|V0S2P1"
      ConditionType "0"
      LeftTextPos "634"
      TopTextPos "200"
      SourceID "V0S5"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S5P3"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl4"
      Partner "V0S3|V0S3P1"
      ConditionType "0"
      LeftTextPos "580"
      TopTextPos "311"
      SourceID "V0S5"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S5P4"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl5"
      Partner "V0S4|V0S4P1"
      ConditionType "0"
      LeftTextPos "601"
      TopTextPos "456"
      SourceID "V0S5"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S6"
      OLEType "CJSSequencer"
      Readonly "0"
      Name "Sequencer_6"
      NextID "4"
      InputPins "V0S6P1|V0S6P2"
      OutputPins "V0S6P3"
      SequencerType "0"
      StageType "CSequencer"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S61"
      OLEType "CJSJobActivity"
      Readonly "0"
      Name "J006_TRN_EMPL_MAE_DIRE_PRI_0001"
      NextID "4"
      InputPins "V0S61P1"
      OutputPins "V0S61P2|V0S61P3"
      JobType "0"
      ExecutionType "0"
      Jobname "J006_TRN_EMPL_MAE_DIRE_PRI_0001"
      ParameterValues "CParamValues"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Description "\"(As pre-defined)\""
         ValueType "4"
         DisplayValue "\"(As pre-defined)\""
      END DSSUBRECORD
      CheckPoint "0"
      StageType "CJobActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S61P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl8"
      Partner "V0S6|V0S6P3"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S61P2"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl9"
      Partner "V0S8|V0S8P1"
      ConditionType "2"
      TriggerExpression "\"Executed OK\""
      LeftTextPos "1195"
      TopTextPos "384"
      SourceID "V0S7"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S61P3"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "e4"
      Partner "V0S33|V0S33P1"
      ConditionType "3"
      TriggerExpression "\"Execution Failed\""
      LeftTextPos "1104"
      TopTextPos "468"
      SourceID "V0S7"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S6P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl6"
      Partner "V0S3|V0S3P2"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S6P2"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl7"
      Partner "V0S4|V0S4P2"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S6P3"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl8"
      Partner "V0S61|V0S61P1"
      ConditionType "0"
      LeftTextPos "957"
      TopTextPos "384"
      SourceID "V0S6"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S8"
      OLEType "CJSJobActivity"
      Readonly "0"
      Name "J007_INS_EMPL_DIR_PRI_0001"
      NextID "4"
      InputPins "V0S8P1"
      OutputPins "V0S8P2|V0S8P3"
      JobType "0"
      ExecutionType "0"
      Jobname "J007_INS_EMPL_DIR_PRI_0001"
      ParameterValues "CParamValues"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Description "\"(As pre-defined)\""
         ValueType "4"
         DisplayValue "\"(As pre-defined)\""
      END DSSUBRECORD
      CheckPoint "0"
      StageType "CJobActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S8P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl9"
      Partner "V0S61|V0S61P2"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S8P2"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl10"
      Partner "V0S9|V0S9P1"
      ConditionType "2"
      TriggerExpression "\"Executed OK\""
      LeftTextPos "1373"
      TopTextPos "384"
      SourceID "V0S8"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S8P3"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "e5"
      Partner "V0S34|V0S34P1"
      ConditionType "3"
      TriggerExpression "\"Execution Failed\""
      LeftTextPos "1344"
      TopTextPos "468"
      SourceID "V0S8"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S9"
      OLEType "CJSJobActivity"
      Readonly "0"
      Name "J008_TRN_EMPL_MAE_DIR_PRI_0002"
      NextID "4"
      InputPins "V0S9P1"
      OutputPins "V0S9P2|V0S9P3"
      JobType "0"
      ExecutionType "0"
      Jobname "J008_TRN_EMPL_MAE_DIR_PRI_0002"
      ParameterValues "CParamValues"
      BEGIN DSSUBRECORD
         Name "PRM_ORA_CONE_MAE_EMPL"
         Description "\"(As pre-defined)\""
         ValueType "4"
         DisplayValue "\"(As pre-defined)\""
      END DSSUBRECORD
      CheckPoint "0"
      StageType "CJobActivity"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S9P1"
      OLEType "CJSActivityInput"
      Readonly "0"
      Name "dsl10"
      Partner "V0S8|V0S8P2"
      LinkType "1"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S9P2"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "dsl12"
      Partner "V0S10|V0S10P2"
      ConditionType "2"
      TriggerExpression "\"Executed OK\""
      LeftTextPos "1705"
      TopTextPos "370"
      SourceID "V0S9"
   END DSRECORD
   BEGIN DSRECORD
      Identifier "V0S9P3"
      OLEType "CJSActivityOutput"
      Readonly "0"
      Name "e6"
      Partner "V0S35|V0S35P1"
      ConditionType "3"
      TriggerExpression "\"Execution Failed\""
      LeftTextPos "1608"
      TopTextPos "451"
      SourceID "V0S9"
   END DSRECORD
END DSJOB
